{"ast":null,"code":"import _asyncToGenerator from \"/home/arturs/scandiweb/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _class,\n    _temp,\n    _jsxFileName = \"/home/arturs/scandiweb/scandipwa/node_modules/@scandipwa/scandipwa/src/component/MyAccountOrderPopup/MyAccountOrderPopup.container.js\";\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { showNotification } from \"/home/arturs/scandiweb/scandipwa/src/store/Notification/Notification.action\";\nimport { orderType } from \"/home/arturs/scandiweb/scandipwa/src/type/Account\";\nimport { isSignedIn } from \"/home/arturs/scandiweb/scandipwa/src/util/Auth\";\nimport { getIndexedProducts } from \"/home/arturs/scandiweb/scandipwa/src/util/Product\";\nimport MyAccountOrderPopup from \"./MyAccountOrderPopup.component\";\nimport { ORDER_POPUP_ID } from \"./MyAccountOrderPopup.config\";\nexport const OrderDispatcher = import(\n/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n\"/home/arturs/scandiweb/scandipwa/src/store/Order/Order.dispatcher\");\n/** #namespace Component/MyAccountOrderPopup/Container/mapStateToProps */\n\nexport const mapStateToProps = Mosaic.middleware(function (state) {\n  return {\n    order: state.OrderReducer.order,\n    payload: state.PopupReducer.popupPayload[ORDER_POPUP_ID] || {},\n    display_tax_in_shipping_amount: state.ConfigReducer.cartDisplayConfig.display_tax_in_shipping_amount\n  };\n}, \"Component/MyAccountOrderPopup/Container/mapStateToProps\");\n/** #namespace Component/MyAccountOrderPopup/Container/mapDispatchToProps */\n\nexport const mapDispatchToProps = Mosaic.middleware(function (dispatch) {\n  return {\n    showNotification: function (type, message) {\n      return dispatch(showNotification(type, message));\n    },\n    getOrderById: function (orderId) {\n      return OrderDispatcher.then(function ({\n        default: dispatcher\n      }) {\n        return dispatcher.getOrderById(dispatch, orderId);\n      });\n    }\n  };\n}, \"Component/MyAccountOrderPopup/Container/mapDispatchToProps\");\n/** #namespace Component/MyAccountOrderPopup/Container */\n\nvar _checkBEM = require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;\n\nexport const MyAccountOrderPopupContainer = Mosaic.middleware((_temp = _class = class MyAccountOrderPopupContainer_ extends Mosaic.Extensible(PureComponent) {\n  constructor(...args) {\n    var _this;\n\n    super(...args);\n    _this = this;\n    this.state = {\n      order: {},\n      currency_code: '',\n      prevOrderId: 0,\n      isLoading: true\n    };\n\n    this.containerProps = function () {\n      const {\n        order: stateOrder,\n        isLoading,\n        currency_code\n      } = _this.state;\n      const {\n        payload: {\n          order: payloadOrder\n        },\n        display_tax_in_shipping_amount\n      } = _this.props;\n      return {\n        display_tax_in_shipping_amount,\n        isLoading,\n        currency_code,\n        order: { ...payloadOrder,\n          ...stateOrder\n        }\n      };\n    };\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    const {\n      payload: {\n        increment_id: id\n      }\n    } = props;\n    const {\n      prevOrderId\n    } = state;\n\n    if (prevOrderId === id) {\n      return null;\n    }\n\n    return {\n      order: {},\n      isLoading: true,\n      prevOrderId: id\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    const {\n      payload: {\n        increment_id: prevId\n      }\n    } = prevProps;\n    const {\n      payload: {\n        increment_id: id\n      }\n    } = this.props;\n\n    if (id && id !== prevId) {\n      this.requestOrderDetails();\n    }\n  }\n\n  requestOrderDetails() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      const {\n        payload: {\n          order: {\n            base_order_info: {\n              id\n            } = {}\n          } = {}\n        } = {},\n        getOrderById\n      } = _this2.props;\n\n      if (!isSignedIn()) {\n        return;\n      }\n\n      const rawOrder = yield getOrderById(id);\n\n      if (!rawOrder) {\n        return;\n      }\n\n      const {\n        order_products = []\n      } = rawOrder;\n      const indexedProducts = getIndexedProducts(order_products);\n      const order = { ...rawOrder,\n        order_products: indexedProducts\n      };\n      const {\n        base_order_info: {\n          currency_code\n        }\n      } = order;\n\n      _this2.setState({\n        currency_code,\n        order,\n        isLoading: false\n      });\n    })();\n  }\n\n  render() {\n    return /*#__PURE__*/_checkBEM(React, MyAccountOrderPopup, Object.assign({}, this.containerProps(), {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 13\n      }\n    }));\n  }\n\n}, _class.propTypes = {\n  payload: PropTypes.shape({\n    order: orderType,\n    increment_id: PropTypes.string\n  }).isRequired,\n  showNotification: PropTypes.func.isRequired,\n  getOrderById: PropTypes.func.isRequired,\n  display_tax_in_shipping_amount: PropTypes.string.isRequired\n}, _temp), \"Component/MyAccountOrderPopup/Container\");\nexport default connect(mapStateToProps, mapDispatchToProps)(MyAccountOrderPopupContainer);","map":{"version":3,"sources":["/home/arturs/scandiweb/scandipwa/node_modules/@scandipwa/scandipwa/src/component/MyAccountOrderPopup/MyAccountOrderPopup.container.js"],"names":["PropTypes","PureComponent","connect","showNotification","orderType","isSignedIn","getIndexedProducts","MyAccountOrderPopup","ORDER_POPUP_ID","OrderDispatcher","mapStateToProps","state","order","OrderReducer","payload","PopupReducer","popupPayload","display_tax_in_shipping_amount","ConfigReducer","cartDisplayConfig","mapDispatchToProps","dispatch","type","message","getOrderById","orderId","then","default","dispatcher","currency_code","prevOrderId","isLoading","containerProps","stateOrder","payloadOrder","props","getDerivedStateFromProps","increment_id","id","componentDidUpdate","prevProps","prevId","requestOrderDetails","base_order_info","rawOrder","order_products","indexedProducts","setState","render","propTypes","shape","string","isRequired","func","MyAccountOrderPopupContainer"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport { showNotification } from 'Store/Notification/Notification.action';\nimport { orderType } from 'Type/Account';\nimport { isSignedIn } from 'Util/Auth';\nimport { getIndexedProducts } from 'Util/Product';\n\nimport MyAccountOrderPopup from './MyAccountOrderPopup.component';\nimport { ORDER_POPUP_ID } from './MyAccountOrderPopup.config';\n\nexport const OrderDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/Order/Order.dispatcher'\n);\n\n/** @namespace Component/MyAccountOrderPopup/Container/mapStateToProps */\nexport const mapStateToProps = (state) => ({\n    order: state.OrderReducer.order,\n    payload: state.PopupReducer.popupPayload[ORDER_POPUP_ID] || {},\n    display_tax_in_shipping_amount: state.ConfigReducer.cartDisplayConfig.display_tax_in_shipping_amount\n});\n\n/** @namespace Component/MyAccountOrderPopup/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    showNotification: (type, message) => dispatch(showNotification(type, message)),\n    getOrderById: (orderId) => OrderDispatcher.then(\n        ({ default: dispatcher }) => dispatcher.getOrderById(dispatch, orderId)\n    )\n});\n\n/** @namespace Component/MyAccountOrderPopup/Container */\nexport class MyAccountOrderPopupContainer extends PureComponent {\n    static propTypes = {\n        payload: PropTypes.shape({\n            order: orderType,\n            increment_id: PropTypes.string\n        }).isRequired,\n        showNotification: PropTypes.func.isRequired,\n        getOrderById: PropTypes.func.isRequired,\n        display_tax_in_shipping_amount: PropTypes.string.isRequired\n    };\n\n    state = {\n        order: {},\n        currency_code: '',\n        prevOrderId: 0,\n        isLoading: true\n    };\n\n    static getDerivedStateFromProps(props, state) {\n        const { payload: { increment_id: id } } = props;\n        const { prevOrderId } = state;\n\n        if (prevOrderId === id) {\n            return null;\n        }\n\n        return { order: {}, isLoading: true, prevOrderId: id };\n    }\n\n    componentDidUpdate(prevProps) {\n        const { payload: { increment_id: prevId } } = prevProps;\n        const { payload: { increment_id: id } } = this.props;\n\n        if (id && id !== prevId) {\n            this.requestOrderDetails();\n        }\n    }\n\n    containerProps = () => {\n        const { order: stateOrder, isLoading, currency_code } = this.state;\n        const {\n            payload: { order: payloadOrder },\n            display_tax_in_shipping_amount\n        } = this.props;\n\n        return {\n            display_tax_in_shipping_amount,\n            isLoading,\n            currency_code,\n            order: {\n                ...payloadOrder,\n                ...stateOrder\n            }\n        };\n    };\n\n    async requestOrderDetails() {\n        const {\n            payload: {\n                order: {\n                    base_order_info: { id } = {}\n                } = {}\n            } = {},\n            getOrderById\n        } = this.props;\n\n        if (!isSignedIn()) {\n            return;\n        }\n\n        const rawOrder = await getOrderById(id);\n\n        if (!rawOrder) {\n            return;\n        }\n\n        const { order_products = [] } = rawOrder;\n        const indexedProducts = getIndexedProducts(order_products);\n        const order = { ...rawOrder, order_products: indexedProducts };\n        const { base_order_info: { currency_code } } = order;\n        this.setState({ currency_code, order, isLoading: false });\n    }\n\n    render() {\n        return (\n            <MyAccountOrderPopup\n              { ...this.containerProps() }\n            />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MyAccountOrderPopupContainer);\n"]},"metadata":{},"sourceType":"module"}