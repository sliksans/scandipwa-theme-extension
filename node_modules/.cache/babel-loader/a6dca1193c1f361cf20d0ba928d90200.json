{"ast":null,"code":"var _jsxFileName = \"/home/arturs/scandiweb/extension/node_modules/@scandipwa/scandipwa/src/component/NavigationTabs/NavigationTabs.container.js\";\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\nimport { connect } from 'react-redux';\nimport { CART, MY_ACCOUNT } from \"/home/arturs/scandiweb/extension/src/component/Header/Header.config\";\nimport { NavigationAbstractContainer } from \"/home/arturs/scandiweb/extension/src/component/NavigationAbstract/NavigationAbstract.container\";\nimport { ACCOUNT_LOGIN_URL } from \"/home/arturs/scandiweb/extension/src/route/MyAccount/MyAccount.config\";\nimport { changeNavigationState, goToPreviousNavigationState } from \"/home/arturs/scandiweb/extension/src/store/Navigation/Navigation.action\";\nimport { BOTTOM_NAVIGATION_TYPE, TOP_NAVIGATION_TYPE } from \"/home/arturs/scandiweb/extension/src/store/Navigation/Navigation.reducer\";\nimport { hideActiveOverlay, toggleOverlayByKey } from \"/home/arturs/scandiweb/extension/src/store/Overlay/Overlay.action\";\nimport { isSignedIn } from \"/home/arturs/scandiweb/extension/src/util/Auth\";\nimport browserHistory from \"/home/arturs/scandiweb/extension/src/util/History\";\nimport { debounce } from \"/home/arturs/scandiweb/extension/src/util/Request\";\nimport { appendWithStoreCode } from \"/home/arturs/scandiweb/extension/src/util/Url\";\nimport NavigationTabs from \"./NavigationTabs.component\";\nimport { ACCOUNT_TAB, CART_TAB, CHECKOUT_TAB, HOME_TAB, MENU_TAB } from \"./NavigationTabs.config\";\n/** #namespace Component/NavigationTabs/Container/mapStateToProps */\n\nexport const mapStateToProps = Mosaic.middleware(function (state) {\n  return {\n    navigationState: state.NavigationReducer[BOTTOM_NAVIGATION_TYPE].navigationState,\n    headerState: state.NavigationReducer[TOP_NAVIGATION_TYPE].navigationState,\n    device: state.ConfigReducer.device,\n    cartTotals: state.CartReducer.cartTotals,\n    noMatch: state.NoMatchReducer.noMatch\n  };\n}, \"Component/NavigationTabs/Container/mapStateToProps\");\n/** #namespace Component/NavigationTabs/Container/mapDispatchToProps */\n\nexport const mapDispatchToProps = Mosaic.middleware(function (dispatch) {\n  return {\n    showOverlay: function (overlayKey) {\n      return dispatch(toggleOverlayByKey(overlayKey));\n    },\n    hideActiveOverlay: function () {\n      return dispatch(hideActiveOverlay());\n    },\n    setNavigationState: function (stateName) {\n      return dispatch(changeNavigationState(BOTTOM_NAVIGATION_TYPE, stateName));\n    },\n    goToPreviousHeaderState: function () {\n      return dispatch(goToPreviousNavigationState(TOP_NAVIGATION_TYPE));\n    },\n    goToPreviousNavigationState: function () {\n      return dispatch(goToPreviousNavigationState(BOTTOM_NAVIGATION_TYPE));\n    }\n  };\n}, \"Component/NavigationTabs/Container/mapDispatchToProps\");\nexport const DEFAULT_NAVIGATION_TABS_STATE = {\n  name: MENU_TAB\n};\n/** #namespace Component/NavigationTabsContainer/Container */\n\nvar _checkBEM = require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;\n\nexport const NavigationTabsContainer = Mosaic.middleware(class NavigationTabsContainer_ extends Mosaic.Extensible(NavigationAbstractContainer) {\n  constructor(...args) {\n    var _this;\n\n    super(...args);\n    _this = this;\n    this.default_state = DEFAULT_NAVIGATION_TABS_STATE;\n    this.scrollPosition = 0;\n    this.routeMap = {\n      '/account': {\n        name: ACCOUNT_TAB\n      },\n      '/my-account': {\n        name: ACCOUNT_TAB\n      },\n      '/checkout': {\n        name: CHECKOUT_TAB,\n        isHidden: true\n      },\n      '/cart': {\n        name: CART_TAB\n      },\n      '/': {\n        name: HOME_TAB\n      }\n    };\n    this.containerFunctions = {\n      onMenuButtonClick: this.onMenuButtonClick.bind(this),\n      onMyAccountButtonClick: this.onMyAccountButtonClick.bind(this),\n      onMinicartButtonClick: this.onMinicartButtonClick.bind(this),\n      onHomeButtonClick: this.onHomeButtonClick.bind(this)\n    };\n\n    this.handleScroll = function () {\n      const {\n        navigationState: {\n          isVisibleOnScroll\n        }\n      } = _this.props;\n\n      if (!isVisibleOnScroll) {\n        return;\n      }\n\n      const windowY = window.pageYOffset;\n\n      _this.handleNavVisibilityOnScroll(windowY);\n\n      _this.scrollPosition = windowY;\n    };\n  }\n\n  componentDidMount() {\n    this.handleNavVisibility();\n    const SCROLL_DEBOUNCE_DELAY = 10;\n    const {\n      name\n    } = this.getNavigationState();\n    this.lastSeenMenu = name === MENU_TAB ? 0 : -1;\n    window.addEventListener('scroll', debounce(this.handleScroll, SCROLL_DEBOUNCE_DELAY));\n    super.componentDidMount();\n  }\n\n  componentDidUpdate(prevProps) {\n    this.handleNavVisibility();\n    this.handleVisibleOnScrollChange(prevProps);\n  }\n\n  handleNavVisibility() {\n    const {\n      navigationState: {\n        isHidden\n      }\n    } = this.props;\n\n    if (isHidden) {\n      document.documentElement.classList.add('hiddenNavigationTabs');\n      return;\n    }\n\n    document.documentElement.classList.remove('hiddenNavigationTabs');\n  }\n\n  handleVisibleOnScrollChange(prevProps) {\n    const {\n      navigationState: {\n        isVisibleOnScroll\n      }\n    } = this.props;\n    const {\n      navigationState: {\n        isVisibleOnScroll: prevIsVisible\n      }\n    } = prevProps;\n\n    if (isVisibleOnScroll !== prevIsVisible) {\n      this.scrollPosition = window.pageYOffset;\n      document.documentElement.classList.remove('hideOnScroll');\n    }\n  }\n\n  handleNavVisibilityOnScroll(windowY) {\n    const ERROR_TOP_OFFSET = 10;\n    const ERROR_BOTTOM_OFFSET = 20;\n    const TOP_MIN_OFFSET = 100;\n    const doc = document.body;\n    const offset = window.innerHeight + window.pageYOffset;\n    const height = doc.scrollHeight;\n\n    if (windowY < TOP_MIN_OFFSET) {\n      // We are on top\n      document.documentElement.classList.remove('hideOnScroll');\n      return;\n    }\n\n    if (offset >= height - ERROR_BOTTOM_OFFSET) {\n      // We are on the bottom\n      document.documentElement.classList.remove('hideOnScroll');\n      return;\n    } // Scroll is less then min offset\n\n\n    if (Math.abs(windowY - this.scrollPosition) < ERROR_TOP_OFFSET) {\n      return;\n    }\n\n    if (windowY < this.scrollPosition) {\n      // Scrolling UP\n      document.documentElement.classList.remove('hideOnScroll');\n    } else {\n      // Scrolling DOWN\n      document.documentElement.classList.add('hideOnScroll');\n    }\n  }\n\n  onMenuButtonClick() {\n    const {\n      navigationState: {\n        name\n      }\n    } = this.props; // TODO: resolve issue when coming from CMS page\n\n    if (name === MENU_TAB) {\n      // if we already are in menu\n      browserHistory.push(appendWithStoreCode('/menu'));\n    } else if (this.lastSeenMenu <= 0) {\n      // if we have not yet seen menu\n      browserHistory.push(appendWithStoreCode('/menu'));\n    } else {\n      // otherwise go to last remembered category\n      browserHistory.go(-this.lastSeenMenu);\n    }\n\n    this.lastSeenMenu = 0;\n  }\n\n  onMinicartButtonClick() {\n    const {\n      pathname\n    } = location;\n\n    if (pathname !== appendWithStoreCode(`/${CART}`)) {\n      browserHistory.push(appendWithStoreCode(`/${CART}`));\n    }\n  }\n\n  onMyAccountButtonClick() {\n    const {\n      pathname\n    } = location;\n    const url = appendWithStoreCode(isSignedIn() ? `/${MY_ACCOUNT}` : ACCOUNT_LOGIN_URL);\n\n    if (pathname !== url) {\n      browserHistory.push(url);\n    }\n  }\n\n  preserveState(name, newName) {\n    const {\n      noMatch\n    } = this.props;\n\n    if (noMatch) {\n      this.lastSeenMenu = -1;\n      return;\n    }\n\n    if (this.lastSeenMenu === -1) {\n      return;\n    }\n\n    if (newName !== MENU_TAB) {\n      this.lastSeenMenu++;\n    }\n\n    if (newName === MENU_TAB && name === MENU_TAB) {\n      this.lastSeenMenu = 0;\n    }\n  }\n\n  handleMobileRouteChange(history) {\n    const {\n      // hideActiveOverlay,\n      setNavigationState,\n      navigationState: {\n        name\n      }\n    } = this.props;\n    const {\n      pathname\n    } = history; // Find the new state name\n\n    const newNavigationState = this.getNavigationState();\n    const {\n      name: newName\n    } = newNavigationState; // Update the state if new name is set\n\n    if (name !== newName) {\n      setNavigationState(newNavigationState);\n    }\n\n    this.preserveState(name, newName);\n    return {\n      prevPathname: pathname\n    };\n  }\n\n  onHomeButtonClick() {\n    const {\n      hideActiveOverlay\n    } = this.props;\n    const {\n      pathname\n    } = location;\n    browserHistory.push(appendWithStoreCode('/'));\n    hideActiveOverlay();\n\n    if (pathname === appendWithStoreCode('/') || pathname === '/') {\n      window.scrollTo({\n        top: 0,\n        behavior: 'smooth'\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_checkBEM(React, NavigationTabs, Object.assign({}, this.props, this.containerFunctions, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 13\n      }\n    }));\n  }\n\n}, \"Component/NavigationTabsContainer/Container\");\nexport default connect(mapStateToProps, mapDispatchToProps)(NavigationTabsContainer);","map":{"version":3,"sources":["/home/arturs/scandiweb/extension/node_modules/@scandipwa/scandipwa/src/component/NavigationTabs/NavigationTabs.container.js"],"names":["connect","CART","MY_ACCOUNT","NavigationAbstractContainer","ACCOUNT_LOGIN_URL","changeNavigationState","goToPreviousNavigationState","BOTTOM_NAVIGATION_TYPE","TOP_NAVIGATION_TYPE","hideActiveOverlay","toggleOverlayByKey","isSignedIn","browserHistory","debounce","appendWithStoreCode","NavigationTabs","ACCOUNT_TAB","CART_TAB","CHECKOUT_TAB","HOME_TAB","MENU_TAB","mapStateToProps","state","navigationState","NavigationReducer","headerState","device","ConfigReducer","cartTotals","CartReducer","noMatch","NoMatchReducer","mapDispatchToProps","dispatch","showOverlay","overlayKey","setNavigationState","stateName","goToPreviousHeaderState","DEFAULT_NAVIGATION_TABS_STATE","name","default_state","scrollPosition","routeMap","isHidden","containerFunctions","onMenuButtonClick","bind","onMyAccountButtonClick","onMinicartButtonClick","onHomeButtonClick","handleScroll","isVisibleOnScroll","props","windowY","window","pageYOffset","handleNavVisibilityOnScroll","componentDidMount","handleNavVisibility","SCROLL_DEBOUNCE_DELAY","getNavigationState","lastSeenMenu","addEventListener","componentDidUpdate","prevProps","handleVisibleOnScrollChange","document","documentElement","classList","add","remove","prevIsVisible","ERROR_TOP_OFFSET","ERROR_BOTTOM_OFFSET","TOP_MIN_OFFSET","doc","body","offset","innerHeight","height","scrollHeight","Math","abs","push","go","pathname","location","url","preserveState","newName","handleMobileRouteChange","history","newNavigationState","prevPathname","scrollTo","top","behavior","render","NavigationTabsContainer"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport { connect } from 'react-redux';\n\nimport { CART, MY_ACCOUNT } from 'Component/Header/Header.config';\nimport { NavigationAbstractContainer } from 'Component/NavigationAbstract/NavigationAbstract.container';\nimport {\n    ACCOUNT_LOGIN_URL\n} from 'Route/MyAccount/MyAccount.config';\nimport { changeNavigationState, goToPreviousNavigationState } from 'Store/Navigation/Navigation.action';\nimport { BOTTOM_NAVIGATION_TYPE, TOP_NAVIGATION_TYPE } from 'Store/Navigation/Navigation.reducer';\nimport { hideActiveOverlay, toggleOverlayByKey } from 'Store/Overlay/Overlay.action';\nimport { isSignedIn } from 'Util/Auth';\nimport browserHistory from 'Util/History';\nimport { debounce } from 'Util/Request';\nimport { appendWithStoreCode } from 'Util/Url';\n\nimport NavigationTabs from './NavigationTabs.component';\nimport {\n    ACCOUNT_TAB,\n    CART_TAB,\n    CHECKOUT_TAB, HOME_TAB,\n    MENU_TAB\n} from './NavigationTabs.config';\n\n/** @namespace Component/NavigationTabs/Container/mapStateToProps */\nexport const mapStateToProps = (state) => ({\n    navigationState: state.NavigationReducer[BOTTOM_NAVIGATION_TYPE].navigationState,\n    headerState: state.NavigationReducer[TOP_NAVIGATION_TYPE].navigationState,\n    device: state.ConfigReducer.device,\n    cartTotals: state.CartReducer.cartTotals,\n    noMatch: state.NoMatchReducer.noMatch\n});\n\n/** @namespace Component/NavigationTabs/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    showOverlay: (overlayKey) => dispatch(toggleOverlayByKey(overlayKey)),\n    hideActiveOverlay: () => dispatch(hideActiveOverlay()),\n    setNavigationState: (stateName) => dispatch(changeNavigationState(BOTTOM_NAVIGATION_TYPE, stateName)),\n    goToPreviousHeaderState: () => dispatch(goToPreviousNavigationState(TOP_NAVIGATION_TYPE)),\n    goToPreviousNavigationState: () => dispatch(goToPreviousNavigationState(BOTTOM_NAVIGATION_TYPE))\n});\n\nexport const DEFAULT_NAVIGATION_TABS_STATE = { name: MENU_TAB };\n\n/** @namespace Component/NavigationTabsContainer/Container */\nexport class NavigationTabsContainer extends NavigationAbstractContainer {\n    default_state = DEFAULT_NAVIGATION_TABS_STATE;\n\n    scrollPosition = 0;\n\n    routeMap = {\n        '/account': { name: ACCOUNT_TAB },\n        '/my-account': { name: ACCOUNT_TAB },\n        '/checkout': { name: CHECKOUT_TAB, isHidden: true },\n        '/cart': { name: CART_TAB },\n        '/': { name: HOME_TAB }\n    };\n\n    containerFunctions = {\n        onMenuButtonClick: this.onMenuButtonClick.bind(this),\n        onMyAccountButtonClick: this.onMyAccountButtonClick.bind(this),\n        onMinicartButtonClick: this.onMinicartButtonClick.bind(this),\n        onHomeButtonClick: this.onHomeButtonClick.bind(this)\n    };\n\n    componentDidMount() {\n        this.handleNavVisibility();\n\n        const SCROLL_DEBOUNCE_DELAY = 10;\n        const { name } = this.getNavigationState();\n        this.lastSeenMenu = name === MENU_TAB ? 0 : -1;\n        window.addEventListener('scroll', debounce(this.handleScroll, SCROLL_DEBOUNCE_DELAY));\n\n        super.componentDidMount();\n    }\n\n    componentDidUpdate(prevProps) {\n        this.handleNavVisibility();\n        this.handleVisibleOnScrollChange(prevProps);\n    }\n\n    handleNavVisibility() {\n        const { navigationState: { isHidden } } = this.props;\n\n        if (isHidden) {\n            document.documentElement.classList.add('hiddenNavigationTabs');\n            return;\n        }\n\n        document.documentElement.classList.remove('hiddenNavigationTabs');\n    }\n\n    handleVisibleOnScrollChange(prevProps) {\n        const { navigationState: { isVisibleOnScroll } } = this.props;\n        const { navigationState: { isVisibleOnScroll: prevIsVisible } } = prevProps;\n\n        if (isVisibleOnScroll !== prevIsVisible) {\n            this.scrollPosition = window.pageYOffset;\n            document.documentElement.classList.remove('hideOnScroll');\n        }\n    }\n\n    handleNavVisibilityOnScroll(windowY) {\n        const ERROR_TOP_OFFSET = 10;\n        const ERROR_BOTTOM_OFFSET = 20;\n        const TOP_MIN_OFFSET = 100;\n\n        const doc = document.body;\n        const offset = window.innerHeight + window.pageYOffset;\n        const height = doc.scrollHeight;\n\n        if (windowY < TOP_MIN_OFFSET) {\n            // We are on top\n            document.documentElement.classList.remove('hideOnScroll');\n            return;\n        }\n\n        if (offset >= (height - ERROR_BOTTOM_OFFSET)) {\n            // We are on the bottom\n            document.documentElement.classList.remove('hideOnScroll');\n            return;\n        }\n\n        // Scroll is less then min offset\n        if (Math.abs(windowY - this.scrollPosition) < ERROR_TOP_OFFSET) {\n            return;\n        }\n\n        if (windowY < this.scrollPosition) {\n            // Scrolling UP\n            document.documentElement.classList.remove('hideOnScroll');\n        } else {\n            // Scrolling DOWN\n            document.documentElement.classList.add('hideOnScroll');\n        }\n    }\n\n    handleScroll = () => {\n        const { navigationState: { isVisibleOnScroll } } = this.props;\n        if (!isVisibleOnScroll) {\n            return;\n        }\n\n        const windowY = window.pageYOffset;\n        this.handleNavVisibilityOnScroll(windowY);\n        this.scrollPosition = windowY;\n    };\n\n    onMenuButtonClick() {\n        const { navigationState: { name } } = this.props;\n\n        // TODO: resolve issue when coming from CMS page\n\n        if (name === MENU_TAB) { // if we already are in menu\n            browserHistory.push(appendWithStoreCode('/menu'));\n        } else if (this.lastSeenMenu <= 0) { // if we have not yet seen menu\n            browserHistory.push(appendWithStoreCode('/menu'));\n        } else { // otherwise go to last remembered category\n            browserHistory.go(-this.lastSeenMenu);\n        }\n\n        this.lastSeenMenu = 0;\n    }\n\n    onMinicartButtonClick() {\n        const { pathname } = location;\n\n        if (pathname !== appendWithStoreCode(`/${ CART }`)) {\n            browserHistory.push(appendWithStoreCode(`/${ CART }`));\n        }\n    }\n\n    onMyAccountButtonClick() {\n        const { pathname } = location;\n        const url = appendWithStoreCode(isSignedIn() ? `/${ MY_ACCOUNT }` : ACCOUNT_LOGIN_URL);\n\n        if (pathname !== url) {\n            browserHistory.push(url);\n        }\n    }\n\n    preserveState(name, newName) {\n        const { noMatch } = this.props;\n\n        if (noMatch) {\n            this.lastSeenMenu = -1;\n            return;\n        }\n\n        if (this.lastSeenMenu === -1) {\n            return;\n        }\n\n        if (newName !== MENU_TAB) {\n            this.lastSeenMenu++;\n        }\n\n        if (newName === MENU_TAB && name === MENU_TAB) {\n            this.lastSeenMenu = 0;\n        }\n    }\n\n    handleMobileRouteChange(history) {\n        const {\n            // hideActiveOverlay,\n            setNavigationState,\n            navigationState: { name }\n        } = this.props;\n\n        const { pathname } = history;\n\n        // Find the new state name\n        const newNavigationState = this.getNavigationState();\n        const { name: newName } = newNavigationState;\n\n        // Update the state if new name is set\n        if (name !== newName) {\n            setNavigationState(newNavigationState);\n        }\n\n        this.preserveState(name, newName);\n\n        return { prevPathname: pathname };\n    }\n\n    onHomeButtonClick() {\n        const {\n            hideActiveOverlay\n        } = this.props;\n\n        const { pathname } = location;\n\n        browserHistory.push(appendWithStoreCode('/'));\n        hideActiveOverlay();\n\n        if (\n            pathname === appendWithStoreCode('/')\n            || pathname === '/'\n        ) {\n            window.scrollTo({\n                top: 0,\n                behavior: 'smooth'\n            });\n        }\n    }\n\n    render() {\n        return (\n            <NavigationTabs\n              { ...this.props }\n              { ...this.containerFunctions }\n            />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(NavigationTabsContainer);\n"]},"metadata":{},"sourceType":"module"}