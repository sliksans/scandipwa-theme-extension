{"ast":null,"code":"var _class,\n    _temp,\n    _jsxFileName = \"/home/arturs/scandiweb/extension/node_modules/@scandipwa/scandipwa/src/component/Header/Header.container.js\";\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router';\nimport { CUSTOMER_ACCOUNT_OVERLAY_KEY } from \"/home/arturs/scandiweb/extension/src/component/MyAccountOverlay/MyAccountOverlay.config\";\nimport { DEFAULT_STATE_NAME } from \"/home/arturs/scandiweb/extension/src/component/NavigationAbstract/NavigationAbstract.config\";\nimport { NavigationAbstractContainer } from \"/home/arturs/scandiweb/extension/src/component/NavigationAbstract/NavigationAbstract.container\";\nimport { SHARE_WISHLIST_POPUP_ID } from \"/home/arturs/scandiweb/extension/src/component/ShareWishlistPopup/ShareWishlistPopup.config\";\nimport { CHECKOUT_URL } from \"/home/arturs/scandiweb/extension/src/route/Checkout/Checkout.config\";\nimport { changeNavigationState, goToPreviousNavigationState } from \"/home/arturs/scandiweb/extension/src/store/Navigation/Navigation.action\";\nimport { TOP_NAVIGATION_TYPE } from \"/home/arturs/scandiweb/extension/src/store/Navigation/Navigation.reducer\";\nimport { hideActiveOverlay, toggleOverlayByKey } from \"/home/arturs/scandiweb/extension/src/store/Overlay/Overlay.action\";\nimport { showPopup } from \"/home/arturs/scandiweb/extension/src/store/Popup/Popup.action\";\nimport { DeviceType } from \"/home/arturs/scandiweb/extension/src/type/Device\";\nimport { isSignedIn } from \"/home/arturs/scandiweb/extension/src/util/Auth\";\nimport history from \"/home/arturs/scandiweb/extension/src/util/History\";\nimport { appendWithStoreCode, setQueryParams } from \"/home/arturs/scandiweb/extension/src/util/Url\";\nimport Header from \"./Header.component\";\nimport { CART, CART_OVERLAY, CATEGORY, CHECKOUT, CHECKOUT_ACCOUNT, CHECKOUT_SUCCESS, CMS_PAGE, CONTACT_US, CUSTOMER_ACCOUNT, CUSTOMER_ACCOUNT_PAGE, CUSTOMER_SUB_ACCOUNT, MENU, PDP, SEARCH } from \"./Header.config\";\n/** #namespace Component/Header/Container/mapStateToProps */\n\nexport const mapStateToProps = Mosaic.middleware(function (state) {\n  return {\n    navigationState: state.NavigationReducer[TOP_NAVIGATION_TYPE].navigationState,\n    cartTotals: state.CartReducer.cartTotals,\n    header_logo_src: state.ConfigReducer.header_logo_src,\n    isOffline: state.OfflineReducer.isOffline,\n    logo_alt: state.ConfigReducer.logo_alt,\n    logo_height: state.ConfigReducer.logo_height,\n    logo_width: state.ConfigReducer.logo_width,\n    isLoading: state.ConfigReducer.isLoading,\n    device: state.ConfigReducer.device,\n    activeOverlay: state.OverlayReducer.activeOverlay,\n    isWishlistLoading: state.WishlistReducer.isLoading\n  };\n}, \"Component/Header/Container/mapStateToProps\");\n/** #namespace Component/Header/Container/mapDispatchToProps */\n\nexport const mapDispatchToProps = Mosaic.middleware(function (dispatch) {\n  return {\n    showOverlay: function (overlayKey) {\n      return dispatch(toggleOverlayByKey(overlayKey));\n    },\n    hideActiveOverlay: function () {\n      return dispatch(hideActiveOverlay());\n    },\n    setNavigationState: function (stateName) {\n      return dispatch(changeNavigationState(TOP_NAVIGATION_TYPE, stateName));\n    },\n    showPopup: function (payload) {\n      return dispatch(showPopup(SHARE_WISHLIST_POPUP_ID, payload));\n    },\n    goToPreviousNavigationState: function () {\n      return dispatch(goToPreviousNavigationState(TOP_NAVIGATION_TYPE));\n    }\n  };\n}, \"Component/Header/Container/mapDispatchToProps\");\nexport const DEFAULT_HEADER_STATE = {\n  name: DEFAULT_STATE_NAME,\n  isHiddenOnMobile: false\n};\n/** #namespace Component/Header/Container */\n\nvar _checkBEM = require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;\n\nexport const HeaderContainer = Mosaic.middleware((_temp = _class = class HeaderContainer_ extends Mosaic.Extensible(NavigationAbstractContainer) {\n  constructor(...args) {\n    var _this;\n\n    super(...args);\n    _this = this;\n    this.default_state = DEFAULT_HEADER_STATE;\n    this.routeMap = {\n      // eslint-disable-next-line max-len\n      '/account/confirm': {\n        name: CMS_PAGE,\n        title: __('Confirm account'),\n        onBackClick: function () {\n          return history.push(appendWithStoreCode('/'));\n        }\n      },\n      '/category': {\n        name: CATEGORY\n      },\n      '/checkout/success': {\n        name: CHECKOUT_SUCCESS\n      },\n      '/checkout': {\n        name: CHECKOUT,\n        onBackClick: function () {\n          return history.push(appendWithStoreCode('/cart'));\n        }\n      },\n      '/my-account': {\n        name: CUSTOMER_ACCOUNT_PAGE,\n        onBackClick: function () {\n          return history.push(appendWithStoreCode('/'));\n        }\n      },\n      '/product': {\n        name: PDP,\n        onBackClick: function () {\n          return history.goBack();\n        }\n      },\n      '/cart': {\n        name: CART\n      },\n      '/menu': {\n        name: MENU\n      },\n      '/page': {\n        name: CMS_PAGE,\n        onBackClick: function () {\n          return history.goBack();\n        }\n      },\n      '/contact': {\n        name: CONTACT_US,\n        onBackClick: function () {\n          return history.goBack();\n        }\n      },\n      '/': {\n        name: DEFAULT_STATE_NAME,\n        isHiddenOnMobile: true\n      }\n    };\n    this.containerFunctions = {\n      onBackButtonClick: this.onBackButtonClick.bind(this),\n      onCloseButtonClick: this.onCloseButtonClick.bind(this),\n      onSearchBarFocus: this.onSearchBarFocus.bind(this),\n      onClearSearchButtonClick: this.onClearSearchButtonClick.bind(this),\n      onMyAccountButtonClick: this.onMyAccountButtonClick.bind(this),\n      onSearchBarChange: this.onSearchBarChange.bind(this),\n      onClearButtonClick: this.onClearButtonClick.bind(this),\n      onEditButtonClick: this.onEditButtonClick.bind(this),\n      onMinicartButtonClick: this.onMinicartButtonClick.bind(this),\n      onOkButtonClick: this.onOkButtonClick.bind(this),\n      onCancelButtonClick: this.onCancelButtonClick.bind(this),\n      onSearchOutsideClick: this.onSearchOutsideClick.bind(this),\n      onMyAccountOutsideClick: this.onMyAccountOutsideClick.bind(this),\n      onMinicartOutsideClick: this.onMinicartOutsideClick.bind(this),\n      onSignIn: this.onSignIn.bind(this),\n      shareWishlist: this.shareWishlist.bind(this),\n      hideActiveOverlay: this.props.hideActiveOverlay\n    };\n\n    this.containerProps = function () {\n      const {\n        activeOverlay,\n        navigationState,\n        cartTotals,\n        header_logo_src,\n        logo_alt,\n        logo_height,\n        logo_width,\n        isLoading,\n        device,\n        isWishlistLoading\n      } = _this.props;\n      const {\n        isClearEnabled,\n        searchCriteria,\n        showMyAccountLogin\n      } = _this.state;\n      const {\n        location: {\n          pathname\n        }\n      } = history;\n      const isCheckout = pathname.includes(CHECKOUT_URL);\n      return {\n        activeOverlay,\n        navigationState,\n        cartTotals,\n        header_logo_src,\n        logo_alt,\n        logo_height,\n        logo_width,\n        isLoading,\n        isClearEnabled,\n        searchCriteria,\n        isCheckout,\n        showMyAccountLogin,\n        device,\n        isWishlistLoading\n      };\n    };\n\n    this.closeOverlay = function () {\n      const {\n        location: {\n          pathname\n        }\n      } = history;\n\n      if (pathname.includes(CHECKOUT_URL)) {\n        _this.setState({\n          showMyAccountLogin: false\n        });\n      }\n    };\n  }\n\n  __construct(props) {\n    super.__construct(props);\n\n    this.state = {\n      prevPathname: '',\n      searchCriteria: '',\n      isClearEnabled: this.getIsClearEnabled(),\n      showMyAccountLogin: false\n    };\n  }\n\n  componentDidMount() {\n    this.handleHeaderVisibility();\n    super.componentDidMount();\n  }\n\n  componentDidUpdate(prevProps) {\n    this.hideSearchOnStateChange(prevProps);\n    this.handleHeaderVisibility();\n  }\n\n  shareWishlist() {\n    const {\n      showPopup\n    } = this.props;\n    showPopup({\n      title: __('Share Wishlist')\n    });\n  }\n\n  getNavigationState() {\n    const {\n      navigationState\n    } = this.props;\n    const {\n      pathname\n    } = location;\n    const {\n      state: historyState\n    } = window.history || {};\n    const {\n      state = {}\n    } = historyState || {}; // TODO: something here breaks /<STORE CODE> from being opened, and / when, the url-based stores are enabled.\n\n    const activeRoute = Object.keys(this.routeMap).find(function (route) {\n      return (route !== '/' || pathname === appendWithStoreCode('/') || pathname === '/') && pathname.includes(route);\n    });\n\n    if (state.category || state.product || state.page || state.popupOpen) {\n      // keep state if it category is in state\n      return navigationState;\n    }\n\n    return this.routeMap[activeRoute] || this.default_state;\n  }\n\n  hideSearchOnStateChange(prevProps) {\n    const {\n      navigationState: {\n        name: prevName\n      }\n    } = prevProps;\n    const {\n      navigationState: {\n        name\n      }\n    } = this.props;\n\n    if (prevName === SEARCH && prevName !== name) {\n      this.hideSearchOverlay();\n    }\n  }\n\n  hideSearchOverlay() {\n    const {\n      hideActiveOverlay,\n      activeOverlay\n    } = this.props;\n    this.setState({\n      searchCriteria: ''\n    });\n    document.activeElement.blur();\n\n    if (activeOverlay === SEARCH) {\n      hideActiveOverlay();\n    }\n  }\n\n  handleHeaderVisibility() {\n    const {\n      navigationState: {\n        isHiddenOnMobile\n      }\n    } = this.props;\n\n    if (isHiddenOnMobile) {\n      document.documentElement.classList.add('hiddenHeader');\n      return;\n    }\n\n    document.documentElement.classList.remove('hiddenHeader');\n  }\n\n  handleMobileUrlChange(history) {\n    const {\n      prevPathname\n    } = this.state;\n    const {\n      pathname\n    } = history;\n    const isClearEnabled = this.getIsClearEnabled();\n\n    if (prevPathname === pathname) {\n      return {\n        isClearEnabled\n      };\n    }\n\n    return {\n      isClearEnabled,\n      showMyAccountLogin: false\n    };\n  }\n\n  getIsClearEnabled() {\n    const {\n      location: {\n        search\n      }\n    } = history;\n    return new RegExp(['customFilters', 'priceMax', 'priceMin'].join('|')).test(search);\n  }\n\n  onBackButtonClick(e) {\n    const {\n      navigationState: {\n        onBackClick\n      }\n    } = this.props;\n    this.setState({\n      searchCriteria: ''\n    });\n\n    if (onBackClick) {\n      onBackClick(e);\n    }\n  }\n\n  onCloseButtonClick(e) {\n    const {\n      hideActiveOverlay,\n      goToPreviousNavigationState\n    } = this.props;\n    const {\n      navigationState: {\n        onCloseClick\n      }\n    } = this.props;\n    this.setState({\n      searchCriteria: ''\n    });\n\n    if (onCloseClick) {\n      onCloseClick(e);\n    }\n\n    hideActiveOverlay();\n    goToPreviousNavigationState();\n  }\n\n  onSearchOutsideClick() {\n    const {\n      goToPreviousNavigationState,\n      navigationState: {\n        name\n      },\n      device\n    } = this.props;\n\n    if (!device.isMobile && name === SEARCH) {\n      this.hideSearchOverlay();\n      goToPreviousNavigationState();\n    }\n  }\n\n  onSearchBarFocus() {\n    const {\n      setNavigationState,\n      goToPreviousNavigationState,\n      showOverlay,\n      navigationState: {\n        name\n      },\n      device\n    } = this.props;\n\n    if (!device.isMobile && name === SEARCH || device.isMobile && name !== MENU) {\n      return;\n    }\n\n    showOverlay(SEARCH);\n    setNavigationState({\n      name: SEARCH,\n      onBackClick: function () {\n        showOverlay(MENU);\n        goToPreviousNavigationState();\n      }\n    });\n  }\n\n  onSearchBarChange({\n    target: {\n      value: searchCriteria\n    }\n  }) {\n    this.setState({\n      searchCriteria\n    });\n  }\n\n  onClearSearchButtonClick() {\n    this.setState({\n      searchCriteria: ''\n    });\n  }\n\n  onMyAccountButtonClick() {\n    var _this2 = this;\n\n    const {\n      showOverlay,\n      setNavigationState\n    } = this.props;\n\n    if (isSignedIn()) {\n      history.push({\n        pathname: appendWithStoreCode('/my-account/dashboard')\n      });\n      return;\n    }\n\n    this.setState({\n      showMyAccountLogin: true\n    }, function () {\n      showOverlay(CUSTOMER_ACCOUNT_OVERLAY_KEY);\n      setNavigationState({\n        name: CHECKOUT_ACCOUNT,\n        title: 'Sign in',\n        onCloseClick: _this2.closeOverlay\n      });\n    });\n  }\n\n  onMyAccountOutsideClick() {\n    const {\n      goToPreviousNavigationState,\n      hideActiveOverlay,\n      navigationState: {\n        name\n      },\n      device\n    } = this.props;\n\n    if (device.isMobile || ![CUSTOMER_ACCOUNT, CUSTOMER_SUB_ACCOUNT, CHECKOUT_ACCOUNT].includes(name)) {\n      return;\n    }\n\n    if (name === CUSTOMER_SUB_ACCOUNT) {\n      goToPreviousNavigationState();\n    }\n\n    this.goToDefaultHeaderState();\n    hideActiveOverlay();\n  }\n\n  onSignIn() {\n    const {\n      location: {\n        pathname\n      }\n    } = history;\n\n    if (pathname.includes(CHECKOUT_URL)) {\n      this.setState({\n        showMyAccountLogin: false\n      });\n    }\n  }\n\n  onClearButtonClick() {\n    const {\n      hideActiveOverlay,\n      goToPreviousNavigationState\n    } = this.props;\n    setQueryParams({\n      customFilters: '',\n      priceMax: '',\n      priceMin: ''\n    }, history.location, history);\n    this.setState({\n      isClearEnabled: false\n    });\n    hideActiveOverlay();\n    goToPreviousNavigationState();\n  }\n\n  onMinicartButtonClick() {\n    const {\n      showOverlay,\n      navigationState: {\n        name\n      },\n      device\n    } = this.props;\n\n    if (name === CART_OVERLAY) {\n      return;\n    }\n\n    if (!device.isMobile) {\n      this.setState({\n        shouldRenderCartOverlay: true\n      });\n      showOverlay(CART_OVERLAY);\n      return;\n    }\n\n    history.push(appendWithStoreCode(`/${CART}`));\n  }\n\n  onMinicartOutsideClick() {\n    const {\n      goToPreviousNavigationState,\n      hideActiveOverlay,\n      navigationState: {\n        name\n      },\n      device\n    } = this.props;\n\n    if (device.isMobile || name !== CART_OVERLAY) {\n      return;\n    }\n\n    goToPreviousNavigationState();\n    hideActiveOverlay();\n  }\n\n  onEditButtonClick(e) {\n    const {\n      navigationState: {\n        onEditClick\n      }\n    } = this.props;\n\n    if (onEditClick) {\n      onEditClick(e);\n    }\n  }\n\n  onOkButtonClick(e) {\n    const {\n      navigationState: {\n        onOkClick,\n        shouldNotGoToPrevState = false\n      },\n      goToPreviousNavigationState\n    } = this.props;\n\n    if (onOkClick) {\n      onOkClick(e);\n    }\n\n    if (!shouldNotGoToPrevState) {\n      goToPreviousNavigationState();\n    }\n  }\n\n  onCancelButtonClick() {\n    const {\n      navigationState: {\n        onCancelClick\n      },\n      goToPreviousNavigationState\n    } = this.props;\n\n    if (onCancelClick) {\n      onCancelClick();\n    }\n\n    goToPreviousNavigationState();\n  }\n\n  render() {\n    return /*#__PURE__*/_checkBEM(React, Header, Object.assign({}, this.state, this.containerProps(), this.containerFunctions, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 501,\n        columnNumber: 13\n      }\n    }));\n  }\n\n}, _class.propTypes = {\n  showOverlay: PropTypes.func.isRequired,\n  isWishlistLoading: PropTypes.bool.isRequired,\n  showPopup: PropTypes.func.isRequired,\n  goToPreviousNavigationState: PropTypes.func.isRequired,\n  hideActiveOverlay: PropTypes.func.isRequired,\n  header_logo_src: PropTypes.string,\n  device: DeviceType.isRequired\n}, _class.defaultProps = {\n  header_logo_src: ''\n}, _temp), \"Component/Header/Container\");\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(HeaderContainer));","map":{"version":3,"sources":["/home/arturs/scandiweb/extension/node_modules/@scandipwa/scandipwa/src/component/Header/Header.container.js"],"names":["PropTypes","connect","withRouter","CUSTOMER_ACCOUNT_OVERLAY_KEY","DEFAULT_STATE_NAME","NavigationAbstractContainer","SHARE_WISHLIST_POPUP_ID","CHECKOUT_URL","changeNavigationState","goToPreviousNavigationState","TOP_NAVIGATION_TYPE","hideActiveOverlay","toggleOverlayByKey","showPopup","DeviceType","isSignedIn","history","appendWithStoreCode","setQueryParams","Header","CART","CART_OVERLAY","CATEGORY","CHECKOUT","CHECKOUT_ACCOUNT","CHECKOUT_SUCCESS","CMS_PAGE","CONTACT_US","CUSTOMER_ACCOUNT","CUSTOMER_ACCOUNT_PAGE","CUSTOMER_SUB_ACCOUNT","MENU","PDP","SEARCH","mapStateToProps","state","navigationState","NavigationReducer","cartTotals","CartReducer","header_logo_src","ConfigReducer","isOffline","OfflineReducer","logo_alt","logo_height","logo_width","isLoading","device","activeOverlay","OverlayReducer","isWishlistLoading","WishlistReducer","mapDispatchToProps","dispatch","showOverlay","overlayKey","setNavigationState","stateName","payload","DEFAULT_HEADER_STATE","name","isHiddenOnMobile","default_state","routeMap","title","__","onBackClick","push","goBack","containerFunctions","onBackButtonClick","bind","onCloseButtonClick","onSearchBarFocus","onClearSearchButtonClick","onMyAccountButtonClick","onSearchBarChange","onClearButtonClick","onEditButtonClick","onMinicartButtonClick","onOkButtonClick","onCancelButtonClick","onSearchOutsideClick","onMyAccountOutsideClick","onMinicartOutsideClick","onSignIn","shareWishlist","props","containerProps","isClearEnabled","searchCriteria","showMyAccountLogin","location","pathname","isCheckout","includes","closeOverlay","setState","__construct","prevPathname","getIsClearEnabled","componentDidMount","handleHeaderVisibility","componentDidUpdate","prevProps","hideSearchOnStateChange","getNavigationState","historyState","window","activeRoute","Object","keys","find","route","category","product","page","popupOpen","prevName","hideSearchOverlay","document","activeElement","blur","documentElement","classList","add","remove","handleMobileUrlChange","search","RegExp","join","test","e","onCloseClick","isMobile","target","value","goToDefaultHeaderState","customFilters","priceMax","priceMin","shouldRenderCartOverlay","onEditClick","onOkClick","shouldNotGoToPrevState","onCancelClick","render","propTypes","func","isRequired","bool","string","defaultProps","HeaderContainer"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router';\n\nimport { CUSTOMER_ACCOUNT_OVERLAY_KEY } from 'Component/MyAccountOverlay/MyAccountOverlay.config';\nimport { DEFAULT_STATE_NAME } from 'Component/NavigationAbstract/NavigationAbstract.config';\nimport { NavigationAbstractContainer } from 'Component/NavigationAbstract/NavigationAbstract.container';\nimport { SHARE_WISHLIST_POPUP_ID } from 'Component/ShareWishlistPopup/ShareWishlistPopup.config';\nimport { CHECKOUT_URL } from 'Route/Checkout/Checkout.config';\nimport { changeNavigationState, goToPreviousNavigationState } from 'Store/Navigation/Navigation.action';\nimport { TOP_NAVIGATION_TYPE } from 'Store/Navigation/Navigation.reducer';\nimport { hideActiveOverlay, toggleOverlayByKey } from 'Store/Overlay/Overlay.action';\nimport { showPopup } from 'Store/Popup/Popup.action';\nimport { DeviceType } from 'Type/Device';\nimport { isSignedIn } from 'Util/Auth';\nimport history from 'Util/History';\nimport { appendWithStoreCode, setQueryParams } from 'Util/Url';\n\nimport Header from './Header.component';\nimport {\n    CART,\n    CART_OVERLAY, CATEGORY,\n    CHECKOUT, CHECKOUT_ACCOUNT, CHECKOUT_SUCCESS,\n    CMS_PAGE, CONTACT_US, CUSTOMER_ACCOUNT,\n    CUSTOMER_ACCOUNT_PAGE, CUSTOMER_SUB_ACCOUNT,\n    MENU, PDP,\n    SEARCH\n} from './Header.config';\n\n/** @namespace Component/Header/Container/mapStateToProps */\nexport const mapStateToProps = (state) => ({\n    navigationState: state.NavigationReducer[TOP_NAVIGATION_TYPE].navigationState,\n    cartTotals: state.CartReducer.cartTotals,\n    header_logo_src: state.ConfigReducer.header_logo_src,\n    isOffline: state.OfflineReducer.isOffline,\n    logo_alt: state.ConfigReducer.logo_alt,\n    logo_height: state.ConfigReducer.logo_height,\n    logo_width: state.ConfigReducer.logo_width,\n    isLoading: state.ConfigReducer.isLoading,\n    device: state.ConfigReducer.device,\n    activeOverlay: state.OverlayReducer.activeOverlay,\n    isWishlistLoading: state.WishlistReducer.isLoading\n});\n\n/** @namespace Component/Header/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    showOverlay: (overlayKey) => dispatch(toggleOverlayByKey(overlayKey)),\n    hideActiveOverlay: () => dispatch(hideActiveOverlay()),\n    setNavigationState: (stateName) => dispatch(changeNavigationState(TOP_NAVIGATION_TYPE, stateName)),\n    showPopup: (payload) => dispatch(showPopup(SHARE_WISHLIST_POPUP_ID, payload)),\n    goToPreviousNavigationState: () => dispatch(goToPreviousNavigationState(TOP_NAVIGATION_TYPE))\n});\n\nexport const DEFAULT_HEADER_STATE = {\n    name: DEFAULT_STATE_NAME,\n    isHiddenOnMobile: false\n};\n\n/** @namespace Component/Header/Container */\nexport class HeaderContainer extends NavigationAbstractContainer {\n    static propTypes = {\n        showOverlay: PropTypes.func.isRequired,\n        isWishlistLoading: PropTypes.bool.isRequired,\n        showPopup: PropTypes.func.isRequired,\n        goToPreviousNavigationState: PropTypes.func.isRequired,\n        hideActiveOverlay: PropTypes.func.isRequired,\n        header_logo_src: PropTypes.string,\n        device: DeviceType.isRequired\n    };\n\n    static defaultProps = {\n        header_logo_src: ''\n    };\n\n    default_state = DEFAULT_HEADER_STATE;\n\n    routeMap = {\n        // eslint-disable-next-line max-len\n        '/account/confirm': { name: CMS_PAGE, title: __('Confirm account'), onBackClick: () => history.push(appendWithStoreCode('/')) },\n        '/category': { name: CATEGORY },\n        '/checkout/success': { name: CHECKOUT_SUCCESS },\n        '/checkout': { name: CHECKOUT, onBackClick: () => history.push(appendWithStoreCode('/cart')) },\n        '/my-account': { name: CUSTOMER_ACCOUNT_PAGE, onBackClick: () => history.push(appendWithStoreCode('/')) },\n        '/product': { name: PDP, onBackClick: () => history.goBack() },\n        '/cart': { name: CART },\n        '/menu': { name: MENU },\n        '/page': { name: CMS_PAGE, onBackClick: () => history.goBack() },\n        '/contact': { name: CONTACT_US, onBackClick: () => history.goBack() },\n        '/': { name: DEFAULT_STATE_NAME, isHiddenOnMobile: true }\n    };\n\n    containerFunctions = {\n        onBackButtonClick: this.onBackButtonClick.bind(this),\n        onCloseButtonClick: this.onCloseButtonClick.bind(this),\n        onSearchBarFocus: this.onSearchBarFocus.bind(this),\n        onClearSearchButtonClick: this.onClearSearchButtonClick.bind(this),\n        onMyAccountButtonClick: this.onMyAccountButtonClick.bind(this),\n        onSearchBarChange: this.onSearchBarChange.bind(this),\n        onClearButtonClick: this.onClearButtonClick.bind(this),\n        onEditButtonClick: this.onEditButtonClick.bind(this),\n        onMinicartButtonClick: this.onMinicartButtonClick.bind(this),\n        onOkButtonClick: this.onOkButtonClick.bind(this),\n        onCancelButtonClick: this.onCancelButtonClick.bind(this),\n        onSearchOutsideClick: this.onSearchOutsideClick.bind(this),\n        onMyAccountOutsideClick: this.onMyAccountOutsideClick.bind(this),\n        onMinicartOutsideClick: this.onMinicartOutsideClick.bind(this),\n        onSignIn: this.onSignIn.bind(this),\n        shareWishlist: this.shareWishlist.bind(this),\n        hideActiveOverlay: this.props.hideActiveOverlay\n    };\n\n    containerProps = () => {\n        const {\n            activeOverlay,\n            navigationState,\n            cartTotals,\n            header_logo_src,\n            logo_alt,\n            logo_height,\n            logo_width,\n            isLoading,\n            device,\n            isWishlistLoading\n        } = this.props;\n\n        const {\n            isClearEnabled,\n            searchCriteria,\n            showMyAccountLogin\n        } = this.state;\n\n        const {\n            location: {\n                pathname\n            }\n        } = history;\n\n        const isCheckout = pathname.includes(CHECKOUT_URL);\n\n        return {\n            activeOverlay,\n            navigationState,\n            cartTotals,\n            header_logo_src,\n            logo_alt,\n            logo_height,\n            logo_width,\n            isLoading,\n            isClearEnabled,\n            searchCriteria,\n            isCheckout,\n            showMyAccountLogin,\n            device,\n            isWishlistLoading\n        };\n    };\n\n    __construct(props) {\n        super.__construct(props);\n\n        this.state = {\n            prevPathname: '',\n            searchCriteria: '',\n            isClearEnabled: this.getIsClearEnabled(),\n            showMyAccountLogin: false\n        };\n    }\n\n    componentDidMount() {\n        this.handleHeaderVisibility();\n        super.componentDidMount();\n    }\n\n    componentDidUpdate(prevProps) {\n        this.hideSearchOnStateChange(prevProps);\n        this.handleHeaderVisibility();\n    }\n\n    shareWishlist() {\n        const { showPopup } = this.props;\n        showPopup({ title: __('Share Wishlist') });\n    }\n\n    getNavigationState() {\n        const { navigationState } = this.props;\n\n        const { pathname } = location;\n        const { state: historyState } = window.history || {};\n        const { state = {} } = historyState || {};\n\n        // TODO: something here breaks /<STORE CODE> from being opened, and / when, the url-based stores are enabled.\n\n        const activeRoute = Object.keys(this.routeMap)\n            .find((route) => (\n                route !== '/'\n                || pathname === appendWithStoreCode('/')\n                || pathname === '/'\n            ) && pathname.includes(route));\n\n        if (state.category || state.product || state.page || state.popupOpen) { // keep state if it category is in state\n            return navigationState;\n        }\n\n        return this.routeMap[activeRoute] || this.default_state;\n    }\n\n    hideSearchOnStateChange(prevProps) {\n        const { navigationState: { name: prevName } } = prevProps;\n        const { navigationState: { name } } = this.props;\n\n        if (prevName === SEARCH && prevName !== name) {\n            this.hideSearchOverlay();\n        }\n    }\n\n    hideSearchOverlay() {\n        const { hideActiveOverlay, activeOverlay } = this.props;\n\n        this.setState({ searchCriteria: '' });\n\n        document.activeElement.blur();\n\n        if (activeOverlay === SEARCH) {\n            hideActiveOverlay();\n        }\n    }\n\n    handleHeaderVisibility() {\n        const { navigationState: { isHiddenOnMobile } } = this.props;\n\n        if (isHiddenOnMobile) {\n            document.documentElement.classList.add('hiddenHeader');\n            return;\n        }\n\n        document.documentElement.classList.remove('hiddenHeader');\n    }\n\n    handleMobileUrlChange(history) {\n        const { prevPathname } = this.state;\n        const { pathname } = history;\n        const isClearEnabled = this.getIsClearEnabled();\n\n        if (prevPathname === pathname) {\n            return { isClearEnabled };\n        }\n\n        return {\n            isClearEnabled,\n            showMyAccountLogin: false\n        };\n    }\n\n    getIsClearEnabled() {\n        const { location: { search } } = history;\n\n        return new RegExp([\n            'customFilters',\n            'priceMax',\n            'priceMin'\n        ].join('|')).test(search);\n    }\n\n    onBackButtonClick(e) {\n        const { navigationState: { onBackClick } } = this.props;\n\n        this.setState({ searchCriteria: '' });\n\n        if (onBackClick) {\n            onBackClick(e);\n        }\n    }\n\n    onCloseButtonClick(e) {\n        const { hideActiveOverlay, goToPreviousNavigationState } = this.props;\n        const { navigationState: { onCloseClick } } = this.props;\n\n        this.setState({ searchCriteria: '' });\n\n        if (onCloseClick) {\n            onCloseClick(e);\n        }\n\n        hideActiveOverlay();\n        goToPreviousNavigationState();\n    }\n\n    onSearchOutsideClick() {\n        const {\n            goToPreviousNavigationState,\n            navigationState: { name },\n            device\n        } = this.props;\n\n        if (!device.isMobile && name === SEARCH) {\n            this.hideSearchOverlay();\n            goToPreviousNavigationState();\n        }\n    }\n\n    onSearchBarFocus() {\n        const {\n            setNavigationState,\n            goToPreviousNavigationState,\n            showOverlay,\n            navigationState: { name },\n            device\n        } = this.props;\n\n        if (\n            (!device.isMobile && name === SEARCH)\n            || (device.isMobile && name !== MENU)\n        ) {\n            return;\n        }\n\n        showOverlay(SEARCH);\n\n        setNavigationState({\n            name: SEARCH,\n            onBackClick: () => {\n                showOverlay(MENU);\n                goToPreviousNavigationState();\n            }\n        });\n    }\n\n    onSearchBarChange({ target: { value: searchCriteria } }) {\n        this.setState({ searchCriteria });\n    }\n\n    onClearSearchButtonClick() {\n        this.setState({ searchCriteria: '' });\n    }\n\n    onMyAccountButtonClick() {\n        const {\n            showOverlay,\n            setNavigationState\n        } = this.props;\n\n        if (isSignedIn()) {\n            history.push({ pathname: appendWithStoreCode('/my-account/dashboard') });\n            return;\n        }\n\n        this.setState({ showMyAccountLogin: true }, () => {\n            showOverlay(CUSTOMER_ACCOUNT_OVERLAY_KEY);\n            setNavigationState({\n                name: CHECKOUT_ACCOUNT,\n                title: 'Sign in',\n                onCloseClick: this.closeOverlay\n            });\n        });\n    }\n\n    onMyAccountOutsideClick() {\n        const {\n            goToPreviousNavigationState,\n            hideActiveOverlay,\n            navigationState: { name },\n            device\n        } = this.props;\n\n        if (device.isMobile || ![CUSTOMER_ACCOUNT, CUSTOMER_SUB_ACCOUNT, CHECKOUT_ACCOUNT].includes(name)) {\n            return;\n        }\n\n        if (name === CUSTOMER_SUB_ACCOUNT) {\n            goToPreviousNavigationState();\n        }\n\n        this.goToDefaultHeaderState();\n        hideActiveOverlay();\n    }\n\n    closeOverlay = () => {\n        const { location: { pathname } } = history;\n\n        if (pathname.includes(CHECKOUT_URL)) {\n            this.setState({ showMyAccountLogin: false });\n        }\n    };\n\n    onSignIn() {\n        const { location: { pathname } } = history;\n\n        if (pathname.includes(CHECKOUT_URL)) {\n            this.setState({ showMyAccountLogin: false });\n        }\n    }\n\n    onClearButtonClick() {\n        const {\n            hideActiveOverlay,\n            goToPreviousNavigationState\n        } = this.props;\n\n        setQueryParams(\n            {\n                customFilters: '',\n                priceMax: '',\n                priceMin: ''\n            },\n            history.location,\n            history\n        );\n\n        this.setState({ isClearEnabled: false });\n\n        hideActiveOverlay();\n        goToPreviousNavigationState();\n    }\n\n    onMinicartButtonClick() {\n        const {\n            showOverlay,\n            navigationState: { name },\n            device\n        } = this.props;\n\n        if (name === CART_OVERLAY) {\n            return;\n        }\n\n        if (!device.isMobile) {\n            this.setState({ shouldRenderCartOverlay: true });\n\n            showOverlay(CART_OVERLAY);\n            return;\n        }\n\n        history.push(appendWithStoreCode(`/${ CART }`));\n    }\n\n    onMinicartOutsideClick() {\n        const {\n            goToPreviousNavigationState,\n            hideActiveOverlay,\n            navigationState: { name },\n            device\n        } = this.props;\n\n        if (device.isMobile || name !== CART_OVERLAY) {\n            return;\n        }\n\n        goToPreviousNavigationState();\n        hideActiveOverlay();\n    }\n\n    onEditButtonClick(e) {\n        const { navigationState: { onEditClick } } = this.props;\n\n        if (onEditClick) {\n            onEditClick(e);\n        }\n    }\n\n    onOkButtonClick(e) {\n        const {\n            navigationState: { onOkClick, shouldNotGoToPrevState = false },\n            goToPreviousNavigationState\n        } = this.props;\n\n        if (onOkClick) {\n            onOkClick(e);\n        }\n\n        if (!shouldNotGoToPrevState) {\n            goToPreviousNavigationState();\n        }\n    }\n\n    onCancelButtonClick() {\n        const {\n            navigationState: { onCancelClick },\n            goToPreviousNavigationState\n        } = this.props;\n\n        if (onCancelClick) {\n            onCancelClick();\n        }\n\n        goToPreviousNavigationState();\n    }\n\n    render() {\n        return (\n            <Header\n              { ...this.state }\n              { ...this.containerProps() }\n              { ...this.containerFunctions }\n            />\n        );\n    }\n}\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(HeaderContainer));\n"]},"metadata":{},"sourceType":"module"}