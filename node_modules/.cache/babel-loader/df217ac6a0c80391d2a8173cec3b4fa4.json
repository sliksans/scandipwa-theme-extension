{"ast":null,"code":"var _class,\n    _temp,\n    _jsxFileName = \"/home/arturs/scandiweb/extension/node_modules/@scandipwa/scandipwa/src/component/CategoryConfigurableAttributes/CategoryConfigurableAttributes.component.js\";\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\nimport PropTypes from 'prop-types';\nimport ExpandableContent from \"/home/arturs/scandiweb/extension/src/component/ExpandableContent\";\nimport ExpandableContentShowMore from \"/home/arturs/scandiweb/extension/src/component/ExpandableContentShowMore\";\nimport ProductAttributeValue from \"/home/arturs/scandiweb/extension/src/component/ProductAttributeValue/ProductAttributeValue.component\"; // eslint-disable-next-line max-len\n\nimport ProductConfigurableAttributes from \"/home/arturs/scandiweb/extension/src/component/ProductConfigurableAttributes/ProductConfigurableAttributes.component\";\nimport { CategoryFragment } from \"/home/arturs/scandiweb/extension/src/type/Category\";\nimport { formatPrice } from \"/home/arturs/scandiweb/extension/src/util/Price\";\nimport { sortBySortOrder } from \"/home/arturs/scandiweb/extension/src/util/Product\";\n/** #namespace Component/CategoryConfigurableAttributes/Component */\n\nvar _checkBEM = require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;\n\nexport const CategoryConfigurableAttributes = Mosaic.middleware((_temp = _class = class CategoryConfigurableAttributes_ extends Mosaic.Extensible(ProductConfigurableAttributes) {\n  constructor(...args) {\n    var _this;\n\n    super(...args);\n    _this = this;\n\n    this.renderConfigurableOption = function (option) {\n      const {\n        attribute_code\n      } = option;\n\n      switch (attribute_code) {\n        case 'price':\n          return _this.renderPriceSwatch(option);\n\n        case 'category_id':\n          return _this.renderSubCategories(option);\n\n        default:\n          return _this.renderDropdownOrSwatch(option);\n      }\n    };\n  }\n\n  renderSubCategories(option) {\n    const {\n      getSubCategories\n    } = this.props;\n    const optionWithSubcategories = getSubCategories(option);\n    const {\n      attribute_values = []\n    } = optionWithSubcategories;\n\n    if (!attribute_values.length) {\n      return null;\n    }\n\n    return this.renderDropdownOrSwatch(optionWithSubcategories);\n  }\n\n  getPriceLabel(option) {\n    const {\n      currency_code\n    } = this.props;\n    const {\n      label\n    } = option;\n    const [from, to] = label.split('~');\n    const priceFrom = formatPrice(from, currency_code);\n    const priceTo = formatPrice(to, currency_code);\n\n    if (from === '*') {\n      return __('Up to %s', priceTo);\n    }\n\n    if (to === '*') {\n      return __('From %s', priceFrom);\n    }\n\n    return __('From %s, to %s', priceFrom, priceTo);\n  }\n\n  renderPriceSwatch(option) {\n    var _this2 = this;\n\n    const {\n      attribute_options,\n      ...priceOption\n    } = option;\n\n    if (attribute_options) {\n      // do not render price filter if it includes \"*_*\" aggregation\n      if (attribute_options['*_*']) {\n        return null;\n      }\n\n      priceOption.attribute_options = Object.entries(attribute_options).reduce(function (acc, [key, option]) {\n        acc[key] = { ...option,\n          label: _this2.getPriceLabel(option)\n        };\n        return acc;\n      }, {});\n    }\n\n    return this.renderDropdownOrSwatch(priceOption);\n  }\n\n  renderDropdownOrSwatch(option) {\n    const {\n      isContentExpanded,\n      getSubHeading\n    } = this.props;\n    const {\n      attribute_label,\n      attribute_code,\n      attribute_options\n    } = option;\n    const [{\n      swatch_data\n    }] = attribute_options ? Object.values(attribute_options) : [{}];\n    const isSwatch = !!swatch_data;\n    return /*#__PURE__*/_checkBEM(React, ExpandableContent, {\n      key: attribute_code,\n      heading: attribute_label,\n      subHeading: getSubHeading(option),\n      mix: {\n        block: 'ProductConfigurableAttributes',\n        elem: 'Expandable'\n      },\n      isContentExpanded: isContentExpanded,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 13\n      }\n    }, isSwatch ? this.renderSwatch(option) : this.renderDropdown(option));\n  }\n\n  renderConfigurableAttributeValue(attribute) {\n    const {\n      getIsConfigurableAttributeAvailable,\n      handleOptionClick,\n      getLink,\n      isSelected,\n      show_product_count\n    } = this.props;\n    const {\n      attribute_value\n    } = attribute;\n    return /*#__PURE__*/_checkBEM(React, ProductAttributeValue, {\n      key: attribute_value,\n      attribute: attribute,\n      isSelected: isSelected(attribute),\n      isAvailable: getIsConfigurableAttributeAvailable(attribute),\n      onClick: handleOptionClick,\n      getLink: getLink,\n      isProductCountVisible: show_product_count,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 13\n      }\n    });\n  }\n\n  renderConfigurableAttributes() {\n    const {\n      configurable_options\n    } = this.props;\n    return sortBySortOrder(Object.values(configurable_options), 'attribute_position').map(this.renderConfigurableOption);\n  }\n\n  renderDropdown(option) {\n    var _this3 = this;\n\n    const {\n      attribute_values\n    } = option;\n    return /*#__PURE__*/_checkBEM(React, \"div\", {\n      block: \"ProductConfigurableAttributes\",\n      elem: \"DropDownList\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/_checkBEM(React, ExpandableContentShowMore, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 17\n      }\n    }, attribute_values.map(function (attribute_value) {\n      return _this3.renderConfigurableAttributeValue({ ...option,\n        attribute_value\n      });\n    })));\n  }\n\n}, _class.propTypes = { ...ProductConfigurableAttributes.propTypes,\n  currency_code: PropTypes.string.isRequired,\n  show_product_count: PropTypes.bool.isRequired,\n  childrenCategories: PropTypes.arrayOf(PropTypes.shape(CategoryFragment)).isRequired,\n  getSubCategories: PropTypes.func.isRequired\n}, _temp), \"Component/CategoryConfigurableAttributes/Component\");\nexport default CategoryConfigurableAttributes;","map":{"version":3,"sources":["/home/arturs/scandiweb/extension/node_modules/@scandipwa/scandipwa/src/component/CategoryConfigurableAttributes/CategoryConfigurableAttributes.component.js"],"names":["PropTypes","ExpandableContent","ExpandableContentShowMore","ProductAttributeValue","ProductConfigurableAttributes","CategoryFragment","formatPrice","sortBySortOrder","renderConfigurableOption","option","attribute_code","renderPriceSwatch","renderSubCategories","renderDropdownOrSwatch","getSubCategories","props","optionWithSubcategories","attribute_values","length","getPriceLabel","currency_code","label","from","to","split","priceFrom","priceTo","__","attribute_options","priceOption","Object","entries","reduce","acc","key","isContentExpanded","getSubHeading","attribute_label","swatch_data","values","isSwatch","block","elem","renderSwatch","renderDropdown","renderConfigurableAttributeValue","attribute","getIsConfigurableAttributeAvailable","handleOptionClick","getLink","isSelected","show_product_count","attribute_value","renderConfigurableAttributes","configurable_options","map","propTypes","string","isRequired","bool","childrenCategories","arrayOf","shape","func","CategoryConfigurableAttributes"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\n\nimport ExpandableContent from 'Component/ExpandableContent';\nimport ExpandableContentShowMore from 'Component/ExpandableContentShowMore';\nimport ProductAttributeValue from 'Component/ProductAttributeValue/ProductAttributeValue.component';\n// eslint-disable-next-line max-len\nimport ProductConfigurableAttributes from 'Component/ProductConfigurableAttributes/ProductConfigurableAttributes.component';\nimport { CategoryFragment } from 'Type/Category';\nimport { formatPrice } from 'Util/Price';\nimport { sortBySortOrder } from 'Util/Product';\n\n/** @namespace Component/CategoryConfigurableAttributes/Component */\nexport class CategoryConfigurableAttributes extends ProductConfigurableAttributes {\n    static propTypes = {\n        ...ProductConfigurableAttributes.propTypes,\n        currency_code: PropTypes.string.isRequired,\n        show_product_count: PropTypes.bool.isRequired,\n        childrenCategories: PropTypes.arrayOf(PropTypes.shape(CategoryFragment)).isRequired,\n        getSubCategories: PropTypes.func.isRequired\n    };\n\n    renderSubCategories(option) {\n        const { getSubCategories } = this.props;\n\n        const optionWithSubcategories = getSubCategories(option);\n        const { attribute_values = [] } = optionWithSubcategories;\n\n        if (!attribute_values.length) {\n            return null;\n        }\n\n        return this.renderDropdownOrSwatch(optionWithSubcategories);\n    }\n\n    getPriceLabel(option) {\n        const { currency_code } = this.props;\n        const { label } = option;\n        const [from, to] = label.split('~');\n        const priceFrom = formatPrice(from, currency_code);\n        const priceTo = formatPrice(to, currency_code);\n\n        if (from === '*') {\n            return __('Up to %s', priceTo);\n        }\n\n        if (to === '*') {\n            return __('From %s', priceFrom);\n        }\n\n        return __('From %s, to %s', priceFrom, priceTo);\n    }\n\n    renderPriceSwatch(option) {\n        const { attribute_options, ...priceOption } = option;\n\n        if (attribute_options) {\n            // do not render price filter if it includes \"*_*\" aggregation\n            if (attribute_options['*_*']) {\n                return null;\n            }\n\n            priceOption.attribute_options = Object.entries(attribute_options).reduce((acc, [key, option]) => {\n                acc[key] = {\n                    ...option,\n                    label: this.getPriceLabel(option)\n                };\n\n                return acc;\n            }, {});\n        }\n\n        return this.renderDropdownOrSwatch(priceOption);\n    }\n\n    renderDropdownOrSwatch(option) {\n        const {\n            isContentExpanded,\n            getSubHeading\n        } = this.props;\n\n        const {\n            attribute_label,\n            attribute_code,\n            attribute_options\n        } = option;\n\n        const [{ swatch_data }] = attribute_options ? Object.values(attribute_options) : [{}];\n        const isSwatch = !!swatch_data;\n\n        return (\n            <ExpandableContent\n              key={ attribute_code }\n              heading={ attribute_label }\n              subHeading={ getSubHeading(option) }\n              mix={ {\n                  block: 'ProductConfigurableAttributes',\n                  elem: 'Expandable'\n              } }\n              isContentExpanded={ isContentExpanded }\n            >\n                { isSwatch ? this.renderSwatch(option) : this.renderDropdown(option) }\n            </ExpandableContent>\n        );\n    }\n\n    renderConfigurableAttributeValue(attribute) {\n        const {\n            getIsConfigurableAttributeAvailable,\n            handleOptionClick,\n            getLink,\n            isSelected,\n            show_product_count\n        } = this.props;\n\n        const { attribute_value } = attribute;\n\n        return (\n            <ProductAttributeValue\n              key={ attribute_value }\n              attribute={ attribute }\n              isSelected={ isSelected(attribute) }\n              isAvailable={ getIsConfigurableAttributeAvailable(attribute) }\n              onClick={ handleOptionClick }\n              getLink={ getLink }\n              isProductCountVisible={ show_product_count }\n            />\n        );\n    }\n\n    renderConfigurableOption = (option) => {\n        const { attribute_code } = option;\n\n        switch (attribute_code) {\n        case 'price':\n            return this.renderPriceSwatch(option);\n        case 'category_id':\n            return this.renderSubCategories(option);\n        default:\n            return this.renderDropdownOrSwatch(option);\n        }\n    };\n\n    renderConfigurableAttributes() {\n        const { configurable_options } = this.props;\n\n        return sortBySortOrder(Object.values(configurable_options), 'attribute_position')\n            .map(this.renderConfigurableOption);\n    }\n\n    renderDropdown(option) {\n        const { attribute_values } = option;\n\n        return (\n            <div\n              block=\"ProductConfigurableAttributes\"\n              elem=\"DropDownList\"\n            >\n                <ExpandableContentShowMore>\n                    { attribute_values.map((attribute_value) => (\n                        this.renderConfigurableAttributeValue({ ...option, attribute_value })\n                    )) }\n                </ExpandableContentShowMore>\n            </div>\n        );\n    }\n}\n\nexport default CategoryConfigurableAttributes;\n"]},"metadata":{},"sourceType":"module"}