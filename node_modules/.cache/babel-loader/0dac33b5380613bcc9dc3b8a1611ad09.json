{"ast":null,"code":"var _class,\n    _temp,\n    _jsxFileName = \"/home/arturs/scandiweb/extension/node_modules/@scandipwa/scandipwa/src/route/CartPage/CartPage.container.js\";\n\n/* eslint-disable react/prop-types */\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { CART, CART_EDITING } from \"/home/arturs/scandiweb/extension/src/component/Header/Header.config\";\nimport { CUSTOMER_ACCOUNT_OVERLAY_KEY } from \"/home/arturs/scandiweb/extension/src/component/MyAccountOverlay/MyAccountOverlay.config\";\nimport { CHECKOUT_URL } from \"/home/arturs/scandiweb/extension/src/route/Checkout/Checkout.config\";\nimport { updateMeta } from \"/home/arturs/scandiweb/extension/src/store/Meta/Meta.action\";\nimport { changeNavigationState } from \"/home/arturs/scandiweb/extension/src/store/Navigation/Navigation.action\";\nimport { TOP_NAVIGATION_TYPE } from \"/home/arturs/scandiweb/extension/src/store/Navigation/Navigation.reducer\";\nimport { showNotification } from \"/home/arturs/scandiweb/extension/src/store/Notification/Notification.action\";\nimport { toggleOverlayByKey } from \"/home/arturs/scandiweb/extension/src/store/Overlay/Overlay.action\";\nimport { HistoryType } from \"/home/arturs/scandiweb/extension/src/type/Common\";\nimport { DeviceType } from \"/home/arturs/scandiweb/extension/src/type/Device\";\nimport { TotalsType } from \"/home/arturs/scandiweb/extension/src/type/MiniCart\";\nimport { isSignedIn } from \"/home/arturs/scandiweb/extension/src/util/Auth\";\nimport { getCartShippingPrice, getCartShippingSubPrice, getCartSubtotal, getCartSubtotalSubPrice, getCartTotalSubPrice, hasOutOfStockProductsInCartItems } from \"/home/arturs/scandiweb/extension/src/util/Cart\";\nimport history from \"/home/arturs/scandiweb/extension/src/util/History\";\nimport { appendWithStoreCode } from \"/home/arturs/scandiweb/extension/src/util/Url\";\nimport CartPage from \"./CartPage.component\";\nexport const BreadcrumbsDispatcher = import(\n/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n\"/home/arturs/scandiweb/extension/src/store/Breadcrumbs/Breadcrumbs.dispatcher\");\nexport const CartDispatcher = import(\n/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n\"/home/arturs/scandiweb/extension/src/store/Cart/Cart.dispatcher\");\n/** #namespace Route/CartPage/Container/mapStateToProps */\n\nexport const mapStateToProps = Mosaic.middleware(function (state) {\n  return {\n    totals: state.CartReducer.cartTotals,\n    headerState: state.NavigationReducer[TOP_NAVIGATION_TYPE].navigationState,\n    guest_checkout: state.ConfigReducer.guest_checkout,\n    device: state.ConfigReducer.device,\n    cartDisplayConfig: state.ConfigReducer.cartDisplayConfig,\n    cartSubtotal: getCartSubtotal(state),\n    cartSubtotalSubPrice: getCartSubtotalSubPrice(state),\n    cartTotalSubPrice: getCartTotalSubPrice(state),\n    cartShippingPrice: getCartShippingPrice(state),\n    cartShippingSubPrice: getCartShippingSubPrice(state)\n  };\n}, \"Route/CartPage/Container/mapStateToProps\");\n/** #namespace Route/CartPage/Container/mapDispatchToProps */\n\nexport const mapDispatchToProps = Mosaic.middleware(function (dispatch) {\n  return {\n    changeHeaderState: function (state) {\n      return dispatch(changeNavigationState(TOP_NAVIGATION_TYPE, state));\n    },\n    updateBreadcrumbs: function (breadcrumbs) {\n      return BreadcrumbsDispatcher.then(function ({\n        default: dispatcher\n      }) {\n        return dispatcher.update(breadcrumbs, dispatch);\n      });\n    },\n    showOverlay: function (overlayKey) {\n      return dispatch(toggleOverlayByKey(overlayKey));\n    },\n    showNotification: function (type, message) {\n      return dispatch(showNotification(type, message));\n    },\n    updateMeta: function (meta) {\n      return dispatch(updateMeta(meta));\n    },\n    updateCrossSellProducts: function (items) {\n      return CartDispatcher.then(function ({\n        default: dispatcher\n      }) {\n        return dispatcher.updateCrossSellProducts(items, dispatch);\n      });\n    }\n  };\n}, \"Route/CartPage/Container/mapDispatchToProps\");\n/** #namespace Route/CartPage/Container */\n\nvar _checkBEM = require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;\n\nexport const CartPageContainer = Mosaic.middleware((_temp = _class = class CartPageContainer_ extends Mosaic.Extensible(PureComponent) {\n  constructor(...args) {\n    var _this;\n\n    super(...args);\n    _this = this;\n    this.state = {\n      isEditing: false\n    };\n    this.containerFunctions = {\n      onCheckoutButtonClick: this.onCheckoutButtonClick.bind(this)\n    };\n\n    this.containerProps = function () {\n      const {\n        totals\n      } = _this.props;\n      return {\n        hasOutOfStockProductsInCart: hasOutOfStockProductsInCartItems(totals.items)\n      };\n    };\n  }\n\n  componentDidMount() {\n    const {\n      updateMeta\n    } = this.props;\n    updateMeta({\n      title: __('Cart')\n    });\n\n    this._updateBreadcrumbs();\n\n    this._changeHeaderState();\n\n    this._updateCrossSellProducts();\n  }\n\n  componentDidUpdate(prevProps) {\n    const {\n      changeHeaderState,\n      totals: {\n        items_qty = 0\n      },\n      headerState,\n      headerState: {\n        name\n      }\n    } = this.props;\n    const {\n      totals: {\n        items_qty: prevItemsQty\n      },\n      headerState: {\n        name: prevName\n      }\n    } = prevProps;\n\n    if (name !== prevName) {\n      if (name === CART) {\n        this._changeHeaderState();\n      }\n    }\n\n    if (items_qty !== prevItemsQty && prevItemsQty !== undefined) {\n      const title = __('%s Item(s)', items_qty);\n\n      changeHeaderState({ ...headerState,\n        title\n      });\n    }\n  }\n\n  onCheckoutButtonClick(e) {\n    const {\n      history,\n      guest_checkout,\n      showOverlay,\n      showNotification,\n      device,\n      totals\n    } = this.props; // to prevent outside-click handler trigger\n\n    e.nativeEvent.stopImmediatePropagation();\n\n    if (hasOutOfStockProductsInCartItems(totals.items)) {\n      return;\n    }\n\n    if (guest_checkout) {\n      history.push({\n        pathname: appendWithStoreCode(CHECKOUT_URL)\n      });\n      return;\n    }\n\n    if (isSignedIn()) {\n      history.push({\n        pathname: appendWithStoreCode(CHECKOUT_URL)\n      });\n      return;\n    } // fir notification whatever device that is\n\n\n    showNotification('info', __('Please sign-in to complete checkout!'));\n\n    if (device.isMobile) {\n      // for all mobile devices, simply switch route\n      history.push({\n        pathname: appendWithStoreCode('/my-account')\n      });\n      return;\n    } // for desktop, just open customer overlay\n\n\n    showOverlay(CUSTOMER_ACCOUNT_OVERLAY_KEY);\n  }\n\n  _updateBreadcrumbs() {\n    const {\n      updateBreadcrumbs\n    } = this.props;\n    const breadcrumbs = [{\n      url: '/cart',\n      name: __('Shopping cart')\n    }];\n    updateBreadcrumbs(breadcrumbs);\n  }\n\n  _changeHeaderState() {\n    var _this2 = this;\n\n    const {\n      changeHeaderState,\n      totals: {\n        items_qty\n      }\n    } = this.props;\n\n    const title = __('%s Item(s)', items_qty || 0);\n\n    changeHeaderState({\n      name: CART,\n      title,\n      onEditClick: function () {\n        _this2.setState({\n          isEditing: true\n        });\n\n        changeHeaderState({\n          name: CART_EDITING,\n          title,\n          onOkClick: function () {\n            return _this2.setState({\n              isEditing: false\n            });\n          },\n          onCancelClick: function () {\n            return _this2.setState({\n              isEditing: false\n            });\n          }\n        });\n      },\n      onCloseClick: function () {\n        _this2.setState({\n          isEditing: false\n        });\n\n        history.goBack();\n      }\n    });\n  }\n\n  _updateCrossSellProducts() {\n    const {\n      updateCrossSellProducts,\n      totals: {\n        items = []\n      } = {}\n    } = this.props;\n    updateCrossSellProducts(items);\n  }\n\n  render() {\n    return /*#__PURE__*/_checkBEM(React, CartPage, Object.assign({}, this.props, this.state, this.containerFunctions, this.containerProps(), {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 13\n      }\n    }));\n  }\n\n}, _class.propTypes = {\n  updateBreadcrumbs: PropTypes.func.isRequired,\n  changeHeaderState: PropTypes.func.isRequired,\n  updateCrossSellProducts: PropTypes.func.isRequired,\n  showOverlay: PropTypes.func.isRequired,\n  showNotification: PropTypes.func.isRequired,\n  updateMeta: PropTypes.func.isRequired,\n  guest_checkout: PropTypes.bool.isRequired,\n  history: HistoryType.isRequired,\n  totals: TotalsType.isRequired,\n  device: DeviceType.isRequired\n}, _temp), \"Route/CartPage/Container\");\nexport default connect(mapStateToProps, mapDispatchToProps)(CartPageContainer);","map":{"version":3,"sources":["/home/arturs/scandiweb/extension/node_modules/@scandipwa/scandipwa/src/route/CartPage/CartPage.container.js"],"names":["PropTypes","PureComponent","connect","CART","CART_EDITING","CUSTOMER_ACCOUNT_OVERLAY_KEY","CHECKOUT_URL","updateMeta","changeNavigationState","TOP_NAVIGATION_TYPE","showNotification","toggleOverlayByKey","HistoryType","DeviceType","TotalsType","isSignedIn","getCartShippingPrice","getCartShippingSubPrice","getCartSubtotal","getCartSubtotalSubPrice","getCartTotalSubPrice","hasOutOfStockProductsInCartItems","history","appendWithStoreCode","CartPage","BreadcrumbsDispatcher","CartDispatcher","mapStateToProps","state","totals","CartReducer","cartTotals","headerState","NavigationReducer","navigationState","guest_checkout","ConfigReducer","device","cartDisplayConfig","cartSubtotal","cartSubtotalSubPrice","cartTotalSubPrice","cartShippingPrice","cartShippingSubPrice","mapDispatchToProps","dispatch","changeHeaderState","updateBreadcrumbs","breadcrumbs","then","default","dispatcher","update","showOverlay","overlayKey","type","message","meta","updateCrossSellProducts","items","isEditing","containerFunctions","onCheckoutButtonClick","bind","containerProps","props","hasOutOfStockProductsInCart","componentDidMount","title","__","_updateBreadcrumbs","_changeHeaderState","_updateCrossSellProducts","componentDidUpdate","prevProps","items_qty","name","prevItemsQty","prevName","undefined","e","nativeEvent","stopImmediatePropagation","push","pathname","isMobile","url","onEditClick","setState","onOkClick","onCancelClick","onCloseClick","goBack","render","propTypes","func","isRequired","bool","CartPageContainer"],"mappings":"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","sourcesContent":["/* eslint-disable react/prop-types */\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport { CART, CART_EDITING } from 'Component/Header/Header.config';\nimport { CUSTOMER_ACCOUNT_OVERLAY_KEY } from 'Component/MyAccountOverlay/MyAccountOverlay.config';\nimport { CHECKOUT_URL } from 'Route/Checkout/Checkout.config';\nimport { updateMeta } from 'Store/Meta/Meta.action';\nimport { changeNavigationState } from 'Store/Navigation/Navigation.action';\nimport { TOP_NAVIGATION_TYPE } from 'Store/Navigation/Navigation.reducer';\nimport { showNotification } from 'Store/Notification/Notification.action';\nimport { toggleOverlayByKey } from 'Store/Overlay/Overlay.action';\nimport { HistoryType } from 'Type/Common';\nimport { DeviceType } from 'Type/Device';\nimport { TotalsType } from 'Type/MiniCart';\nimport { isSignedIn } from 'Util/Auth';\nimport {\n    getCartShippingPrice,\n    getCartShippingSubPrice,\n    getCartSubtotal,\n    getCartSubtotalSubPrice,\n    getCartTotalSubPrice,\n    hasOutOfStockProductsInCartItems\n} from 'Util/Cart';\nimport history from 'Util/History';\nimport { appendWithStoreCode } from 'Util/Url';\n\nimport CartPage from './CartPage.component';\n\nexport const BreadcrumbsDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/Breadcrumbs/Breadcrumbs.dispatcher'\n);\n\nexport const CartDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/Cart/Cart.dispatcher'\n);\n\n/** @namespace Route/CartPage/Container/mapStateToProps */\nexport const mapStateToProps = (state) => ({\n    totals: state.CartReducer.cartTotals,\n    headerState: state.NavigationReducer[TOP_NAVIGATION_TYPE].navigationState,\n    guest_checkout: state.ConfigReducer.guest_checkout,\n    device: state.ConfigReducer.device,\n    cartDisplayConfig: state.ConfigReducer.cartDisplayConfig,\n    cartSubtotal: getCartSubtotal(state),\n    cartSubtotalSubPrice: getCartSubtotalSubPrice(state),\n    cartTotalSubPrice: getCartTotalSubPrice(state),\n    cartShippingPrice: getCartShippingPrice(state),\n    cartShippingSubPrice: getCartShippingSubPrice(state)\n});\n\n/** @namespace Route/CartPage/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    changeHeaderState: (state) => dispatch(changeNavigationState(TOP_NAVIGATION_TYPE, state)),\n    updateBreadcrumbs: (breadcrumbs) => BreadcrumbsDispatcher.then(\n        ({ default: dispatcher }) => dispatcher.update(breadcrumbs, dispatch)\n    ),\n    showOverlay: (overlayKey) => dispatch(toggleOverlayByKey(overlayKey)),\n    showNotification: (type, message) => dispatch(showNotification(type, message)),\n    updateMeta: (meta) => dispatch(updateMeta(meta)),\n    updateCrossSellProducts: (items) => CartDispatcher.then(\n        ({ default: dispatcher }) => dispatcher.updateCrossSellProducts(items, dispatch)\n    )\n});\n\n/** @namespace Route/CartPage/Container */\nexport class CartPageContainer extends PureComponent {\n    static propTypes = {\n        updateBreadcrumbs: PropTypes.func.isRequired,\n        changeHeaderState: PropTypes.func.isRequired,\n        updateCrossSellProducts: PropTypes.func.isRequired,\n        showOverlay: PropTypes.func.isRequired,\n        showNotification: PropTypes.func.isRequired,\n        updateMeta: PropTypes.func.isRequired,\n        guest_checkout: PropTypes.bool.isRequired,\n        history: HistoryType.isRequired,\n        totals: TotalsType.isRequired,\n        device: DeviceType.isRequired\n    };\n\n    state = { isEditing: false };\n\n    containerFunctions = {\n        onCheckoutButtonClick: this.onCheckoutButtonClick.bind(this)\n    };\n\n    componentDidMount() {\n        const { updateMeta } = this.props;\n\n        updateMeta({ title: __('Cart') });\n\n        this._updateBreadcrumbs();\n        this._changeHeaderState();\n        this._updateCrossSellProducts();\n    }\n\n    componentDidUpdate(prevProps) {\n        const {\n            changeHeaderState,\n            totals: { items_qty = 0 },\n            headerState,\n            headerState: { name }\n        } = this.props;\n\n        const {\n            totals: { items_qty: prevItemsQty },\n            headerState: { name: prevName }\n        } = prevProps;\n\n        if (name !== prevName) {\n            if (name === CART) {\n                this._changeHeaderState();\n            }\n        }\n\n        if (items_qty !== prevItemsQty && prevItemsQty !== undefined) {\n            const title = __('%s Item(s)', items_qty);\n            changeHeaderState({\n                ...headerState,\n                title\n            });\n        }\n    }\n\n    containerProps = () => {\n        const { totals } = this.props;\n\n        return {\n            hasOutOfStockProductsInCart: hasOutOfStockProductsInCartItems(totals.items)\n        };\n    };\n\n    onCheckoutButtonClick(e) {\n        const {\n            history,\n            guest_checkout,\n            showOverlay,\n            showNotification,\n            device,\n            totals\n        } = this.props;\n\n        // to prevent outside-click handler trigger\n        e.nativeEvent.stopImmediatePropagation();\n\n        if (hasOutOfStockProductsInCartItems(totals.items)) {\n            return;\n        }\n\n        if (guest_checkout) {\n            history.push({\n                pathname: appendWithStoreCode(CHECKOUT_URL)\n            });\n\n            return;\n        }\n\n        if (isSignedIn()) {\n            history.push({\n                pathname: appendWithStoreCode(CHECKOUT_URL)\n            });\n\n            return;\n        }\n\n        // fir notification whatever device that is\n        showNotification('info', __('Please sign-in to complete checkout!'));\n\n        if (device.isMobile) { // for all mobile devices, simply switch route\n            history.push({ pathname: appendWithStoreCode('/my-account') });\n            return;\n        }\n\n        // for desktop, just open customer overlay\n        showOverlay(CUSTOMER_ACCOUNT_OVERLAY_KEY);\n    }\n\n    _updateBreadcrumbs() {\n        const { updateBreadcrumbs } = this.props;\n        const breadcrumbs = [\n            { url: '/cart', name: __('Shopping cart') }\n        ];\n\n        updateBreadcrumbs(breadcrumbs);\n    }\n\n    _changeHeaderState() {\n        const { changeHeaderState, totals: { items_qty } } = this.props;\n        const title = __('%s Item(s)', items_qty || 0);\n\n        changeHeaderState({\n            name: CART,\n            title,\n            onEditClick: () => {\n                this.setState({ isEditing: true });\n                changeHeaderState({\n                    name: CART_EDITING,\n                    title,\n                    onOkClick: () => this.setState({ isEditing: false }),\n                    onCancelClick: () => this.setState({ isEditing: false })\n                });\n            },\n            onCloseClick: () => {\n                this.setState({ isEditing: false });\n                history.goBack();\n            }\n        });\n    }\n\n    _updateCrossSellProducts() {\n        const {\n            updateCrossSellProducts,\n            totals: {\n                items = []\n            } = {}\n        } = this.props;\n\n        updateCrossSellProducts(items);\n    }\n\n    render() {\n        return (\n            <CartPage\n              { ...this.props }\n              { ...this.state }\n              { ...this.containerFunctions }\n              { ...this.containerProps() }\n            />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CartPageContainer);\n"]},"metadata":{},"sourceType":"module"}