{"ast":null,"code":"import _asyncToGenerator from \"/home/arturs/scandiweb/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _class,\n    _temp,\n    _jsxFileName = \"/home/arturs/scandiweb/scandipwa/node_modules/@scandipwa/scandipwa/src/component/MyAccountCreateAccount/MyAccountCreateAccount.container.js\";\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { STATE_CONFIRM_EMAIL } from \"/home/arturs/scandiweb/scandipwa/src/component/MyAccountOverlay/MyAccountOverlay.config\";\nimport { showNotification } from \"/home/arturs/scandiweb/scandipwa/src/store/Notification/Notification.action\";\nimport { DeviceType } from \"/home/arturs/scandiweb/scandipwa/src/type/Device\";\nimport MyAccountCreateAccount from \"./MyAccountCreateAccount.component\";\nimport { SHOW_VAT_NUMBER_REQUIRED } from \"./MyAccountCreateAccount.config\";\nexport const MyAccountDispatcher = import(\n/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n\"/home/arturs/scandiweb/scandipwa/src/store/MyAccount/MyAccount.dispatcher\");\n/** #namespace Component/MyAccountCreateAccount/Container/mapStateToProps */\n// eslint-disable-next-line no-unused-vars\n\nexport const mapStateToProps = Mosaic.middleware(function (state) {\n  return {\n    isLoading: state.MyAccountReducer.isLoading,\n    showTaxVatNumber: !!state.ConfigReducer.show_tax_vat_number,\n    newsletterActive: state.ConfigReducer.newsletter_general_active,\n    device: state.ConfigReducer.device\n  };\n}, \"Component/MyAccountCreateAccount/Container/mapStateToProps\");\n/** #namespace Component/MyAccountCreateAccount/Container/mapDispatchToProps */\n\nexport const mapDispatchToProps = Mosaic.middleware(function (dispatch) {\n  return {\n    createAccount: function (options) {\n      return MyAccountDispatcher.then(function ({\n        default: dispatcher\n      }) {\n        return dispatcher.createAccount(options, dispatch);\n      });\n    },\n    showNotification: function (type, message) {\n      return dispatch(showNotification(type, message));\n    }\n  };\n}, \"Component/MyAccountCreateAccount/Container/mapDispatchToProps\");\n/** #namespace Component/MyAccountCreateAccount/Container */\n\nvar _checkBEM = require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;\n\nexport const MyAccountCreateAccountContainer = Mosaic.middleware((_temp = _class = class MyAccountCreateAccountContainer_ extends Mosaic.Extensible(PureComponent) {\n  constructor(...args) {\n    super(...args);\n    this.containerProps = {\n      vatNumberValidation: this.getVatNumberValidation()\n    };\n    this.containerFunctions = {\n      onCreateAccountSuccess: this.onCreateAccountSuccess.bind(this),\n      onCreateAccountAttempt: this.onCreateAccountAttempt.bind(this)\n    };\n  }\n\n  getVatNumberValidation() {\n    const {\n      showTaxVatNumber\n    } = this.props;\n\n    if (showTaxVatNumber === SHOW_VAT_NUMBER_REQUIRED) {\n      return ['notEmpty'];\n    }\n\n    return [];\n  }\n\n  onCreateAccountAttempt(_, invalidFields) {\n    const {\n      showNotification,\n      setLoadingState\n    } = this.props;\n\n    if (invalidFields) {\n      showNotification('info', __('Incorrect data! Please resolve all field validation errors.'));\n    }\n\n    setLoadingState(!invalidFields);\n  }\n\n  onCreateAccountSuccess(fields) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const {\n        createAccount,\n        onSignIn,\n        setSignInState,\n        setLoadingState,\n        isLoading,\n        isLandingPage,\n        showNotification,\n        device\n      } = _this.props;\n      const {\n        password,\n        email,\n        firstname,\n        lastname,\n        is_subscribed,\n        taxvat\n      } = fields;\n      const customerData = {\n        customer: {\n          firstname,\n          lastname,\n          email,\n          is_subscribed,\n          taxvat\n        },\n        password\n      };\n\n      if (isLoading) {\n        return;\n      }\n\n      try {\n        const code = yield createAccount(customerData); // if user needs confirmation\n\n        if (code === 2) {\n          setSignInState(STATE_CONFIRM_EMAIL);\n\n          if (isLandingPage || device.isMobile) {\n            showNotification('success', // eslint-disable-next-line max-len\n            __('The email confirmation link has been sent to your email. Please confirm your account to proceed.'));\n          }\n        } else {\n          onSignIn();\n        }\n      } finally {\n        setLoadingState(false);\n      }\n    })();\n  }\n\n  render() {\n    return /*#__PURE__*/_checkBEM(React, MyAccountCreateAccount, Object.assign({}, this.props, this.containerProps, this.containerFunctions, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 13\n      }\n    }));\n  }\n\n}, _class.propTypes = {\n  createAccount: PropTypes.func.isRequired,\n  onSignIn: PropTypes.func.isRequired,\n  setSignInState: PropTypes.func.isRequired,\n  setLoadingState: PropTypes.func.isRequired,\n  showNotification: PropTypes.func.isRequired,\n  isLoading: PropTypes.bool.isRequired,\n  showTaxVatNumber: PropTypes.string.isRequired,\n  isLandingPage: PropTypes.bool,\n  device: DeviceType.isRequired\n}, _class.defaultProps = {\n  isLandingPage: false\n}, _temp), \"Component/MyAccountCreateAccount/Container\");\nexport default connect(mapStateToProps, mapDispatchToProps)(MyAccountCreateAccountContainer);","map":{"version":3,"sources":["/home/arturs/scandiweb/scandipwa/node_modules/@scandipwa/scandipwa/src/component/MyAccountCreateAccount/MyAccountCreateAccount.container.js"],"names":["PropTypes","PureComponent","connect","STATE_CONFIRM_EMAIL","showNotification","DeviceType","MyAccountCreateAccount","SHOW_VAT_NUMBER_REQUIRED","MyAccountDispatcher","mapStateToProps","state","isLoading","MyAccountReducer","showTaxVatNumber","ConfigReducer","show_tax_vat_number","newsletterActive","newsletter_general_active","device","mapDispatchToProps","dispatch","createAccount","options","then","default","dispatcher","type","message","containerProps","vatNumberValidation","getVatNumberValidation","containerFunctions","onCreateAccountSuccess","bind","onCreateAccountAttempt","props","_","invalidFields","setLoadingState","__","fields","onSignIn","setSignInState","isLandingPage","password","email","firstname","lastname","is_subscribed","taxvat","customerData","customer","code","isMobile","render","propTypes","func","isRequired","bool","string","defaultProps","MyAccountCreateAccountContainer"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport { STATE_CONFIRM_EMAIL } from 'Component/MyAccountOverlay/MyAccountOverlay.config';\nimport { showNotification } from 'Store/Notification/Notification.action';\nimport { DeviceType } from 'Type/Device';\n\nimport MyAccountCreateAccount from './MyAccountCreateAccount.component';\nimport { SHOW_VAT_NUMBER_REQUIRED } from './MyAccountCreateAccount.config';\n\nexport const MyAccountDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/MyAccount/MyAccount.dispatcher'\n);\n\n/** @namespace Component/MyAccountCreateAccount/Container/mapStateToProps */\n// eslint-disable-next-line no-unused-vars\nexport const mapStateToProps = (state) => ({\n    isLoading: state.MyAccountReducer.isLoading,\n    showTaxVatNumber: !!state.ConfigReducer.show_tax_vat_number,\n    newsletterActive: state.ConfigReducer.newsletter_general_active,\n    device: state.ConfigReducer.device\n});\n\n/** @namespace Component/MyAccountCreateAccount/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    createAccount: (options) => MyAccountDispatcher.then(\n        ({ default: dispatcher }) => dispatcher.createAccount(options, dispatch)\n    ),\n    showNotification: (type, message) => dispatch(showNotification(type, message))\n});\n\n/** @namespace Component/MyAccountCreateAccount/Container */\nexport class MyAccountCreateAccountContainer extends PureComponent {\n    static propTypes = {\n        createAccount: PropTypes.func.isRequired,\n        onSignIn: PropTypes.func.isRequired,\n        setSignInState: PropTypes.func.isRequired,\n        setLoadingState: PropTypes.func.isRequired,\n        showNotification: PropTypes.func.isRequired,\n        isLoading: PropTypes.bool.isRequired,\n        showTaxVatNumber: PropTypes.string.isRequired,\n        isLandingPage: PropTypes.bool,\n        device: DeviceType.isRequired\n    };\n\n    static defaultProps = {\n        isLandingPage: false\n    };\n\n    containerProps = {\n        vatNumberValidation: this.getVatNumberValidation()\n    };\n\n    containerFunctions = {\n        onCreateAccountSuccess: this.onCreateAccountSuccess.bind(this),\n        onCreateAccountAttempt: this.onCreateAccountAttempt.bind(this)\n    };\n\n    getVatNumberValidation() {\n        const { showTaxVatNumber } = this.props;\n\n        if (showTaxVatNumber === SHOW_VAT_NUMBER_REQUIRED) {\n            return ['notEmpty'];\n        }\n\n        return [];\n    }\n\n    onCreateAccountAttempt(_, invalidFields) {\n        const { showNotification, setLoadingState } = this.props;\n\n        if (invalidFields) {\n            showNotification('info', __('Incorrect data! Please resolve all field validation errors.'));\n        }\n\n        setLoadingState(!invalidFields);\n    }\n\n    async onCreateAccountSuccess(fields) {\n        const {\n            createAccount,\n            onSignIn,\n            setSignInState,\n            setLoadingState,\n            isLoading,\n            isLandingPage,\n            showNotification,\n            device\n        } = this.props;\n\n        const {\n            password,\n            email,\n            firstname,\n            lastname,\n            is_subscribed,\n            taxvat\n        } = fields;\n\n        const customerData = {\n            customer: {\n                firstname,\n                lastname,\n                email,\n                is_subscribed,\n                taxvat\n            },\n            password\n        };\n\n        if (isLoading) {\n            return;\n        }\n\n        try {\n            const code = await createAccount(customerData);\n\n            // if user needs confirmation\n            if (code === 2) {\n                setSignInState(STATE_CONFIRM_EMAIL);\n\n                if (isLandingPage || device.isMobile) {\n                    showNotification(\n                        'success',\n                        // eslint-disable-next-line max-len\n                        __('The email confirmation link has been sent to your email. Please confirm your account to proceed.')\n                    );\n                }\n            } else {\n                onSignIn();\n            }\n        } finally {\n            setLoadingState(false);\n        }\n    }\n\n    render() {\n        return (\n            <MyAccountCreateAccount\n              { ...this.props }\n              { ...this.containerProps }\n              { ...this.containerFunctions }\n            />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MyAccountCreateAccountContainer);\n"]},"metadata":{},"sourceType":"module"}