{"ast":null,"code":"var _class,\n    _temp,\n    _jsxFileName = \"/home/arturs/scandiweb/scandipwa/node_modules/@scandipwa/scandipwa/src/component/ProductAttributeValue/ProductAttributeValue.component.js\";\n\n/* eslint-disable no-magic-numbers */\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport Field from \"/home/arturs/scandiweb/scandipwa/src/component/Field\";\nimport Html from \"/home/arturs/scandiweb/scandipwa/src/component/Html\";\nimport { MixType } from \"/home/arturs/scandiweb/scandipwa/src/type/Common\";\nimport { AttributeType } from \"/home/arturs/scandiweb/scandipwa/src/type/ProductList\";\nimport { getBooleanLabel } from \"/home/arturs/scandiweb/scandipwa/src/util/Product\";\nimport { STRING_ONLY_ATTRIBUTE_CODES } from \"./ProductAttributeValue.config\";\nimport \"./ProductAttributeValue.style\";\n/** #namespace Component/ProductAttributeValue/Component */\n\nvar _checkBEM = require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;\n\nexport const ProductAttributeValue = Mosaic.middleware((_temp = _class = class ProductAttributeValue_ extends Mosaic.Extensible(PureComponent) {\n  constructor(...args) {\n    super(...args);\n    this.clickHandler = this.clickHandler.bind(this);\n    this.getOptionLabel = this.getOptionLabel.bind(this);\n  }\n\n  getIsColorLight(hex) {\n    const color = hex.charAt(0) === '#' ? hex.substring(1, 7) : hex;\n    const r = parseInt(color.substring(0, 2), 16); // hexToR\n\n    const g = parseInt(color.substring(2, 4), 16); // hexToG\n\n    const b = parseInt(color.substring(4, 6), 16); // hexToB\n\n    return r * 0.299 + g * 0.587 + b * 0.114 > 186;\n  }\n\n  getOptionLabel(value) {\n    const {\n      attribute: {\n        attribute_options,\n        is_boolean\n      },\n      isProductCountVisible\n    } = this.props;\n\n    if (attribute_options) {\n      const optionValues = attribute_options[value];\n\n      if (optionValues) {\n        if (!isProductCountVisible) {\n          return optionValues;\n        }\n\n        const {\n          label,\n          count = 0\n        } = optionValues;\n        return { ...optionValues,\n          label: `${getBooleanLabel(label, is_boolean)} (${count})`\n        };\n      }\n    }\n\n    return {};\n  }\n\n  clickHandler(e) {\n    const {\n      onClick,\n      attribute\n    } = this.props;\n    e.preventDefault();\n    onClick(attribute);\n  }\n\n  renderTextAttribute() {\n    const {\n      attribute: {\n        attribute_value\n      }\n    } = this.props;\n    return this.renderStringValue(attribute_value);\n  }\n\n  renderBooleanAttribute() {\n    const {\n      attribute: {\n        attribute_value\n      }\n    } = this.props;\n    return this.renderStringValue(+attribute_value ? __('Yes') : __('No'));\n  }\n\n  renderMultiSelectAttribute() {\n    var _this = this;\n\n    const {\n      attribute: {\n        attribute_value\n      }\n    } = this.props;\n    const labelsArray = attribute_value.split(',').reduce(function (labels, value) {\n      const {\n        label\n      } = _this.getOptionLabel(value);\n\n      if (label) {\n        labels.push(label);\n      }\n\n      return labels;\n    }, []);\n    return this.renderStringValue(labelsArray.length ? labelsArray.join(', ') : __('N/A'));\n  }\n\n  renderSelectAttribute() {\n    const {\n      attribute: {\n        attribute_value,\n        attribute_code\n      }\n    } = this.props;\n    const attributeOption = this.getOptionLabel(attribute_value);\n    const {\n      label,\n      swatch_data\n    } = attributeOption;\n\n    if (!swatch_data || STRING_ONLY_ATTRIBUTE_CODES.includes(attribute_code)) {\n      return this.renderStringValue(label || __('N/A'));\n    }\n\n    const {\n      value,\n      type\n    } = swatch_data;\n\n    switch (type) {\n      case '0':\n        return this.renderStringValue(value, label);\n\n      case '1':\n        return this.renderColorValue(value, label);\n\n      case '2':\n        return this.renderImageValue(value, label);\n\n      default:\n        return this.renderStringValue(label || __('N/A'));\n    }\n  }\n\n  renderImageAttribute() {\n    const {\n      attribute: {\n        attribute_label,\n        attribute_value\n      }\n    } = this.props;\n\n    if (!attribute_value || attribute_value === 'no_selection') {\n      return this.renderPlaceholder();\n    }\n\n    return /*#__PURE__*/_checkBEM(React, \"img\", {\n      block: \"ProductAttributeValue\",\n      elem: \"MediaImage\",\n      src: `/media/catalog/product${attribute_value}`,\n      alt: attribute_label,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 13\n      }\n    });\n  }\n\n  renderTextAreaAttribute() {\n    const {\n      attribute: {\n        attribute_value\n      }\n    } = this.props;\n    return /*#__PURE__*/_checkBEM(React, \"div\", {\n      block: \"ProductAttributeValue\",\n      elem: \"TextArea\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/_checkBEM(React, Html, {\n      content: attribute_value,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 17\n      }\n    }));\n  }\n\n  renderPlaceholder() {\n    return /*#__PURE__*/_checkBEM(React, \"div\", {\n      block: \"ProductAttributeValue\",\n      elem: \"Placeholder\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 13\n      }\n    });\n  }\n\n  renderColorValue(color, label) {\n    const {\n      isFormattedAsText,\n      isSelected\n    } = this.props;\n    const isLight = this.getIsColorLight(color);\n\n    if (isFormattedAsText) {\n      return label || __('N/A');\n    }\n\n    const style = {\n      '--option-background-color': color,\n      '--option-border-color': isLight ? '#000' : color,\n      '--option-check-mark-background': isLight ? '#000' : '#fff',\n      // stylelint-disable-next-line value-keyword-case\n      '--option-is-selected': isSelected ? 1 : 0\n    };\n    return /*#__PURE__*/_checkBEM(React, \"data\", {\n      block: \"ProductAttributeValue\",\n      elem: \"Color\",\n      value: label,\n      title: label,\n      style: style,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 13\n      }\n    });\n  }\n\n  renderImageValue(img, label) {\n    const {\n      isFormattedAsText,\n      isSelected\n    } = this.props;\n\n    if (isFormattedAsText) {\n      return label || __('N/A');\n    }\n\n    const style = {\n      // stylelint-disable-next-line value-keyword-case\n      '--option-is-selected': isSelected ? 1 : 0\n    };\n    return /*#__PURE__*/_checkBEM(React, React.Fragment, null, /*#__PURE__*/_checkBEM(React, \"img\", {\n      block: \"ProductAttributeValue\",\n      elem: \"Image\",\n      src: `/media/attribute/swatch${img}`,\n      alt: label,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/_checkBEM(React, \"data\", {\n      block: \"ProductAttributeValue\",\n      elem: \"Image-Overlay\",\n      value: label,\n      title: label,\n      style: style,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 17\n      }\n    }));\n  }\n\n  renderDropdown(value) {\n    const {\n      isSelected\n    } = this.props;\n    return /*#__PURE__*/_checkBEM(React, Field, {\n      id: value,\n      name: value,\n      type: \"checkbox\",\n      label: value,\n      value: value,\n      mix: {\n        block: 'ProductAttributeValue',\n        elem: 'Text',\n        mods: {\n          isSelected\n        }\n      },\n      checked: isSelected,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 13\n      }\n    });\n  }\n\n  renderStringValue(value, label) {\n    const {\n      isFormattedAsText,\n      isSelected\n    } = this.props;\n    const isSwatch = label;\n\n    if (isFormattedAsText) {\n      return label || value || __('N/A');\n    }\n\n    if (!isSwatch) {\n      return this.renderDropdown(value);\n    }\n\n    return /*#__PURE__*/_checkBEM(React, \"span\", {\n      block: \"ProductAttributeValue\",\n      elem: \"String\",\n      mods: {\n        isSelected\n      },\n      title: label,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 13\n      }\n    }, value);\n  }\n\n  renderNumericAttribute() {\n    const {\n      attribute: {\n        attribute_value\n      }\n    } = this.props;\n    return this.renderStringValue(parseFloat(attribute_value).toFixed(2));\n  }\n\n  renderAttributeByType() {\n    const {\n      attribute: {\n        attribute_type\n      }\n    } = this.props;\n\n    switch (attribute_type) {\n      case 'select':\n        return this.renderSelectAttribute();\n\n      case 'boolean':\n        return this.renderBooleanAttribute();\n\n      case 'text':\n        return this.renderTextAttribute();\n\n      case 'multiselect':\n        return this.renderMultiSelectAttribute();\n\n      case 'media_image':\n        return this.renderImageAttribute();\n\n      case 'textarea':\n        return this.renderTextAreaAttribute();\n\n      case 'weight':\n        return this.renderNumericAttribute();\n\n      default:\n        return this.renderPlaceholder();\n    }\n  }\n\n  render() {\n    const {\n      getLink,\n      attribute,\n      isAvailable,\n      attribute: {\n        attribute_code,\n        attribute_value\n      },\n      mix,\n      isFormattedAsText\n    } = this.props;\n\n    if (attribute_code && !attribute_value) {\n      return null;\n    }\n\n    const href = getLink(attribute); // Invert to apply css rule without using not()\n\n    const isNotAvailable = !isAvailable;\n\n    if (isFormattedAsText) {\n      return /*#__PURE__*/_checkBEM(React, \"div\", {\n        block: \"ProductAttributeValue\",\n        mix: mix,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 341,\n          columnNumber: 17\n        }\n      }, this.renderAttributeByType());\n    }\n\n    return /*#__PURE__*/_checkBEM(React, \"a\", {\n      href: href,\n      block: \"ProductAttributeValue\",\n      mods: {\n        isNotAvailable\n      },\n      onClick: this.clickHandler,\n      \"aria-hidden\": isNotAvailable,\n      mix: mix,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 13\n      }\n    }, this.renderAttributeByType());\n  }\n\n}, _class.propTypes = {\n  getLink: PropTypes.func,\n  onClick: PropTypes.func,\n  attribute: AttributeType.isRequired,\n  isSelected: PropTypes.bool,\n  isAvailable: PropTypes.bool,\n  mix: MixType,\n  isFormattedAsText: PropTypes.bool,\n  isProductCountVisible: PropTypes.bool\n}, _class.defaultProps = {\n  isSelected: false,\n  onClick: function () {},\n  getLink: function () {},\n  mix: {},\n  isAvailable: true,\n  isFormattedAsText: false,\n  isProductCountVisible: false\n}, _temp), \"Component/ProductAttributeValue/Component\");\nexport default ProductAttributeValue;","map":{"version":3,"sources":["/home/arturs/scandiweb/scandipwa/node_modules/@scandipwa/scandipwa/src/component/ProductAttributeValue/ProductAttributeValue.component.js"],"names":["PropTypes","PureComponent","Field","Html","MixType","AttributeType","getBooleanLabel","STRING_ONLY_ATTRIBUTE_CODES","clickHandler","bind","getOptionLabel","getIsColorLight","hex","color","charAt","substring","r","parseInt","g","b","value","attribute","attribute_options","is_boolean","isProductCountVisible","props","optionValues","label","count","e","onClick","preventDefault","renderTextAttribute","attribute_value","renderStringValue","renderBooleanAttribute","__","renderMultiSelectAttribute","labelsArray","split","reduce","labels","push","length","join","renderSelectAttribute","attribute_code","attributeOption","swatch_data","includes","type","renderColorValue","renderImageValue","renderImageAttribute","attribute_label","renderPlaceholder","renderTextAreaAttribute","isFormattedAsText","isSelected","isLight","style","img","renderDropdown","block","elem","mods","isSwatch","renderNumericAttribute","parseFloat","toFixed","renderAttributeByType","attribute_type","render","getLink","isAvailable","mix","href","isNotAvailable","propTypes","func","isRequired","bool","defaultProps","ProductAttributeValue"],"mappings":"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","sourcesContent":["/* eslint-disable no-magic-numbers */\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\n\nimport Field from 'Component/Field';\nimport Html from 'Component/Html';\nimport { MixType } from 'Type/Common';\nimport { AttributeType } from 'Type/ProductList';\nimport { getBooleanLabel } from 'Util/Product';\n\nimport { STRING_ONLY_ATTRIBUTE_CODES } from './ProductAttributeValue.config';\n\nimport './ProductAttributeValue.style';\n\n/** @namespace Component/ProductAttributeValue/Component */\nexport class ProductAttributeValue extends PureComponent {\n    static propTypes = {\n        getLink: PropTypes.func,\n        onClick: PropTypes.func,\n        attribute: AttributeType.isRequired,\n        isSelected: PropTypes.bool,\n        isAvailable: PropTypes.bool,\n        mix: MixType,\n        isFormattedAsText: PropTypes.bool,\n        isProductCountVisible: PropTypes.bool\n    };\n\n    static defaultProps = {\n        isSelected: false,\n        onClick: () => {},\n        getLink: () => {},\n        mix: {},\n        isAvailable: true,\n        isFormattedAsText: false,\n        isProductCountVisible: false\n    };\n\n    clickHandler = this.clickHandler.bind(this);\n\n    getOptionLabel = this.getOptionLabel.bind(this);\n\n    getIsColorLight(hex) {\n        const color = (hex.charAt(0) === '#') ? hex.substring(1, 7) : hex;\n        const r = parseInt(color.substring(0, 2), 16); // hexToR\n        const g = parseInt(color.substring(2, 4), 16); // hexToG\n        const b = parseInt(color.substring(4, 6), 16); // hexToB\n        return ((r * 0.299) + (g * 0.587) + (b * 0.114)) > 186;\n    }\n\n    getOptionLabel(value) {\n        const {\n            attribute: {\n                attribute_options,\n                is_boolean\n            },\n            isProductCountVisible\n        } = this.props;\n\n        if (attribute_options) {\n            const optionValues = attribute_options[value];\n            if (optionValues) {\n                if (!isProductCountVisible) {\n                    return optionValues;\n                }\n\n                const { label, count = 0 } = optionValues;\n\n                return {\n                    ...optionValues,\n                    label: `${getBooleanLabel(label, is_boolean)} (${count})`\n                };\n            }\n        }\n\n        return {};\n    }\n\n    clickHandler(e) {\n        const { onClick, attribute } = this.props;\n\n        e.preventDefault();\n        onClick(attribute);\n    }\n\n    renderTextAttribute() {\n        const { attribute: { attribute_value } } = this.props;\n        return this.renderStringValue(attribute_value);\n    }\n\n    renderBooleanAttribute() {\n        const { attribute: { attribute_value } } = this.props;\n        return this.renderStringValue(+attribute_value ? __('Yes') : __('No'));\n    }\n\n    renderMultiSelectAttribute() {\n        const { attribute: { attribute_value } } = this.props;\n\n        const labelsArray = attribute_value.split(',').reduce((labels, value) => {\n            const { label } = this.getOptionLabel(value);\n            if (label) {\n                labels.push(label);\n            }\n\n            return labels;\n        }, []);\n\n        return this.renderStringValue(labelsArray.length ? labelsArray.join(', ') : __('N/A'));\n    }\n\n    renderSelectAttribute() {\n        const { attribute: { attribute_value, attribute_code } } = this.props;\n        const attributeOption = this.getOptionLabel(attribute_value);\n        const { label, swatch_data } = attributeOption;\n\n        if (!swatch_data || STRING_ONLY_ATTRIBUTE_CODES.includes(attribute_code)) {\n            return this.renderStringValue(label || __('N/A'));\n        }\n\n        const { value, type } = swatch_data;\n\n        switch (type) {\n        case '0':\n            return this.renderStringValue(value, label);\n        case '1':\n            return this.renderColorValue(value, label);\n        case '2':\n            return this.renderImageValue(value, label);\n        default:\n            return this.renderStringValue(label || __('N/A'));\n        }\n    }\n\n    renderImageAttribute() {\n        const {\n            attribute: {\n                attribute_label,\n                attribute_value\n            }\n        } = this.props;\n\n        if (!attribute_value || attribute_value === 'no_selection') {\n            return this.renderPlaceholder();\n        }\n\n        return (\n            <img\n              block=\"ProductAttributeValue\"\n              elem=\"MediaImage\"\n              src={ `/media/catalog/product${attribute_value}` }\n              alt={ attribute_label }\n            />\n        );\n    }\n\n    renderTextAreaAttribute() {\n        const {\n            attribute: { attribute_value }\n        } = this.props;\n\n        return (\n            <div\n              block=\"ProductAttributeValue\"\n              elem=\"TextArea\"\n            >\n                <Html content={ attribute_value } />\n            </div>\n        );\n    }\n\n    renderPlaceholder() {\n        return (\n            <div\n              block=\"ProductAttributeValue\"\n              elem=\"Placeholder\"\n            />\n        );\n    }\n\n    renderColorValue(color, label) {\n        const { isFormattedAsText, isSelected } = this.props;\n        const isLight = this.getIsColorLight(color);\n\n        if (isFormattedAsText) {\n            return label || __('N/A');\n        }\n\n        const style = {\n            '--option-background-color': color,\n            '--option-border-color': isLight ? '#000' : color,\n            '--option-check-mark-background': isLight ? '#000' : '#fff',\n            // stylelint-disable-next-line value-keyword-case\n            '--option-is-selected': isSelected ? 1 : 0\n        };\n\n        return (\n            <data\n              block=\"ProductAttributeValue\"\n              elem=\"Color\"\n              value={ label }\n              title={ label }\n              style={ style }\n            />\n        );\n    }\n\n    renderImageValue(img, label) {\n        const { isFormattedAsText, isSelected } = this.props;\n\n        if (isFormattedAsText) {\n            return label || __('N/A');\n        }\n\n        const style = {\n            // stylelint-disable-next-line value-keyword-case\n            '--option-is-selected': isSelected ? 1 : 0\n        };\n\n        return (\n            <>\n                <img\n                  block=\"ProductAttributeValue\"\n                  elem=\"Image\"\n                  src={ `/media/attribute/swatch${img}` }\n                  alt={ label }\n                />\n                <data\n                  block=\"ProductAttributeValue\"\n                  elem=\"Image-Overlay\"\n                  value={ label }\n                  title={ label }\n                  style={ style }\n                />\n            </>\n        );\n    }\n\n    renderDropdown(value) {\n        const { isSelected } = this.props;\n\n        return (\n            <Field\n              id={ value }\n              name={ value }\n              type=\"checkbox\"\n              label={ value }\n              value={ value }\n              mix={ {\n                  block: 'ProductAttributeValue',\n                  elem: 'Text',\n                  mods: { isSelected }\n              } }\n              checked={ isSelected }\n            />\n        );\n    }\n\n    renderStringValue(value, label) {\n        const { isFormattedAsText, isSelected } = this.props;\n        const isSwatch = label;\n\n        if (isFormattedAsText) {\n            return label || value || __('N/A');\n        }\n\n        if (!isSwatch) {\n            return this.renderDropdown(value);\n        }\n\n        return (\n            <span\n              block=\"ProductAttributeValue\"\n              elem=\"String\"\n              mods={ { isSelected } }\n              title={ label }\n            >\n                { value }\n            </span>\n        );\n    }\n\n    renderNumericAttribute() {\n        const { attribute: { attribute_value } } = this.props;\n        return this.renderStringValue(parseFloat(attribute_value).toFixed(2));\n    }\n\n    renderAttributeByType() {\n        const { attribute: { attribute_type } } = this.props;\n\n        switch (attribute_type) {\n        case 'select':\n            return this.renderSelectAttribute();\n        case 'boolean':\n            return this.renderBooleanAttribute();\n        case 'text':\n            return this.renderTextAttribute();\n        case 'multiselect':\n            return this.renderMultiSelectAttribute();\n        case 'media_image':\n            return this.renderImageAttribute();\n        case 'textarea':\n            return this.renderTextAreaAttribute();\n        case 'weight':\n            return this.renderNumericAttribute();\n        default:\n            return this.renderPlaceholder();\n        }\n    }\n\n    render() {\n        const {\n            getLink,\n            attribute,\n            isAvailable,\n            attribute: { attribute_code, attribute_value },\n            mix,\n            isFormattedAsText\n        } = this.props;\n\n        if (attribute_code && !attribute_value) {\n            return null;\n        }\n\n        const href = getLink(attribute);\n        // Invert to apply css rule without using not()\n        const isNotAvailable = !isAvailable;\n\n        if (isFormattedAsText) {\n            return (\n                <div\n                  block=\"ProductAttributeValue\"\n                  mix={ mix }\n                >\n                    { this.renderAttributeByType() }\n                </div>\n            );\n        }\n\n        return (\n            <a\n              href={ href }\n              block=\"ProductAttributeValue\"\n              mods={ { isNotAvailable } }\n              onClick={ this.clickHandler }\n              aria-hidden={ isNotAvailable }\n              mix={ mix }\n            >\n                { this.renderAttributeByType() }\n            </a>\n        );\n    }\n}\n\nexport default ProductAttributeValue;\n"]},"metadata":{},"sourceType":"module"}