{"ast":null,"code":"var _class,\n    _temp,\n    _jsxFileName = \"/home/arturs/scandiweb/extension/node_modules/@scandipwa/scandipwa/src/component/ProductActions/ProductActions.container.js\";\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { IN_STOCK, OUT_OF_STOCK } from \"/home/arturs/scandiweb/extension/src/component/ProductCard/ProductCard.config\";\nimport { ProductType } from \"/home/arturs/scandiweb/extension/src/type/ProductList\";\nimport { BUNDLE, CONFIGURABLE, DOWNLOADABLE, GROUPED, SIMPLE, VIRTUAL } from \"/home/arturs/scandiweb/extension/src/util/Product\";\nimport ProductActions from \"./ProductActions.component\";\nimport { DEFAULT_MAX_PRODUCTS, ONE_HUNDRED_PERCENT } from \"./ProductActions.config\";\n/** #namespace Component/ProductActions/Container/mapStateToProps */\n\nexport const mapStateToProps = Mosaic.middleware(function (state) {\n  return {\n    groupedProductQuantity: state.ProductReducer.groupedProductQuantity,\n    device: state.ConfigReducer.device,\n    displayProductStockStatus: state.ConfigReducer.display_product_stock_status,\n    isWishlistEnabled: state.ConfigReducer.wishlist_general_active\n  };\n}, \"Component/ProductActions/Container/mapStateToProps\");\n/** #namespace Component/ProductActions/Container */\n\nvar _checkBEM = require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;\n\nexport const ProductActionsContainer = Mosaic.middleware((_temp = _class = class ProductActionsContainer_ extends Mosaic.Extensible(PureComponent) {\n  constructor(...args) {\n    var _this;\n\n    super(...args);\n    _this = this;\n    this.state = {\n      quantity: 1,\n      groupedProductQuantity: {}\n    };\n    this.containerFunctions = {\n      showOnlyIfLoaded: this.showOnlyIfLoaded.bind(this),\n      onProductValidationError: this.onProductValidationError.bind(this),\n      getIsOptionInCurrentVariant: this.getIsOptionInCurrentVariant.bind(this),\n      setQuantity: this.setQuantity.bind(this),\n      setGroupedProductQuantity: this._setGroupedProductQuantity.bind(this),\n      clearGroupedProductQuantity: this._clearGroupedProductQuantity.bind(this),\n      getIsConfigurableAttributeAvailable: this.getIsConfigurableAttributeAvailable.bind(this)\n    };\n    this.onConfigurableProductError = this.onProductError.bind(this, this.configurableOptionsRef);\n    this.onGroupedProductError = this.onProductError.bind(this, this.groupedProductsRef);\n\n    this.containerProps = function () {\n      return {\n        minQuantity: ProductActionsContainer.getMinQuantity(_this.props),\n        maxQuantity: ProductActionsContainer.getMaxQuantity(_this.props),\n        groupedProductQuantity: _this._getGroupedProductQuantity(),\n        productPrice: _this.getProductPrice(),\n        productName: _this.getProductName(),\n        offerCount: _this.getOfferCount(),\n        offerType: _this.getOfferType(),\n        stockMeta: _this.getStockMeta(),\n        metaLink: _this.getMetaLink()\n      };\n    };\n  }\n\n  static getMinQuantity(props) {\n    const {\n      product: {\n        stock_item: {\n          min_sale_qty\n        } = {},\n        variants\n      } = {},\n      configurableVariantIndex\n    } = props;\n\n    if (!min_sale_qty) {\n      return 1;\n    }\n\n    if (!configurableVariantIndex && !variants) {\n      return min_sale_qty;\n    }\n\n    const {\n      stock_item: {\n        min_sale_qty: minVariantQty\n      } = {}\n    } = variants[configurableVariantIndex] || {};\n    return minVariantQty || min_sale_qty;\n  }\n\n  static getMaxQuantity(props) {\n    const {\n      product: {\n        stock_item: {\n          max_sale_qty\n        } = {},\n        variants\n      } = {},\n      configurableVariantIndex\n    } = props;\n\n    if (!max_sale_qty) {\n      return DEFAULT_MAX_PRODUCTS;\n    }\n\n    if (configurableVariantIndex === -1 || !Object.keys(variants).length) {\n      return max_sale_qty;\n    }\n\n    const {\n      stock_item: {\n        max_sale_qty: maxVariantQty\n      } = {}\n    } = variants[configurableVariantIndex] || {};\n    return maxVariantQty || max_sale_qty;\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    const {\n      quantity\n    } = state;\n    const minQty = ProductActionsContainer.getMinQuantity(props);\n    const maxQty = ProductActionsContainer.getMaxQuantity(props);\n\n    if (quantity < minQty) {\n      return {\n        quantity: minQty\n      };\n    }\n\n    if (quantity > maxQty) {\n      return {\n        quantity: maxQty\n      };\n    }\n\n    return null;\n  }\n\n  onProductError(ref) {\n    if (!ref) {\n      return;\n    }\n\n    const {\n      current\n    } = ref;\n    current.scrollIntoView({\n      behavior: 'smooth',\n      block: 'center'\n    });\n    current.classList.remove('animate'); // eslint-disable-next-line no-unused-expressions\n\n    current.offsetWidth; // trigger a DOM reflow\n\n    current.classList.add('animate');\n  }\n\n  onProductValidationError(type) {\n    switch (type) {\n      case CONFIGURABLE:\n        this.onConfigurableProductError();\n        break;\n\n      case GROUPED:\n        this.onGroupedProductError();\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  setQuantity(value) {\n    this.setState({\n      quantity: +value\n    });\n  } // TODO: make key=>value based\n\n\n  getIsOptionInCurrentVariant(attribute, value) {\n    const {\n      configurableVariantIndex,\n      product: {\n        variants\n      }\n    } = this.props;\n\n    if (!variants) {\n      return false;\n    }\n\n    return variants[configurableVariantIndex].product[attribute] === value;\n  }\n\n  getIsConfigurableAttributeAvailable({\n    attribute_code,\n    attribute_value\n  }) {\n    const {\n      parameters,\n      product: {\n        variants\n      }\n    } = this.props;\n    const isAttributeSelected = Object.hasOwnProperty.call(parameters, attribute_code); // If value matches current attribute_value, option should be enabled\n\n    if (isAttributeSelected && parameters[attribute_code] === attribute_value) {\n      return true;\n    }\n\n    const parameterPairs = Object.entries(parameters);\n    const selectedAttributes = isAttributeSelected // Need to exclude itself, otherwise different attribute_values of the same attribute_code will always be disabled\n    ? parameterPairs.filter(function ([key]) {\n      return key !== attribute_code;\n    }) : parameterPairs;\n    return variants.some(function ({\n      stock_status,\n      attributes\n    }) {\n      const {\n        attribute_value: foundValue\n      } = attributes[attribute_code] || {};\n      return stock_status === IN_STOCK // Variant must have currently checked attribute_code and attribute_value\n      && foundValue === attribute_value // Variant must have all currently selected attributes\n      && selectedAttributes.every(function ([key, value]) {\n        return attributes[key].attribute_value === value;\n      });\n    });\n  }\n\n  getProductName() {\n    const {\n      product,\n      product: {\n        variants = []\n      },\n      configurableVariantIndex\n    } = this.props;\n    const {\n      name\n    } = variants[configurableVariantIndex] || product;\n    return name;\n  }\n\n  getMetaLink() {\n    const {\n      getLink\n    } = this.props;\n    return window.location.origin + getLink().replace(/\\?.*/, '');\n  }\n\n  getStockMeta() {\n    const {\n      product,\n      product: {\n        variants = []\n      },\n      configurableVariantIndex\n    } = this.props;\n    const {\n      stock_status\n    } = variants[configurableVariantIndex] || product;\n\n    if (stock_status === OUT_OF_STOCK) {\n      return 'https://schema.org/OutOfStock';\n    }\n\n    return 'https://schema.org/InStock';\n  }\n\n  getOfferType() {\n    const {\n      product: {\n        variants\n      }\n    } = this.props;\n\n    if (variants && variants.length >= 1) {\n      return 'https://schema.org/AggregateOffer';\n    }\n\n    return 'https://schema.org/Offer';\n  }\n\n  getOfferCount() {\n    const {\n      product: {\n        variants\n      }\n    } = this.props;\n\n    if (variants && variants.length) {\n      return variants.length;\n    }\n\n    return 0;\n  }\n\n  getSelectedOptions() {\n    const {\n      productOptionsData: {\n        productOptionsMulti = [],\n        productOptions = []\n      } = {}\n    } = this.props;\n    return [...productOptionsMulti, ...productOptions].map(function (productOption) {\n      const {\n        option_value\n      } = productOption;\n      return parseInt(option_value, 10);\n    });\n  }\n\n  getSelectedOptionsMulti() {\n    const {\n      productOptionsData: {\n        productOptionsMulti = [],\n        productOptions = []\n      } = {}\n    } = this.props;\n    return [...productOptionsMulti, ...productOptions].map(function (productOption) {\n      const {\n        option_id\n      } = productOption;\n      return parseInt(option_id, 10);\n    });\n  }\n\n  getOptionPricesTotal(options) {\n    const selectedOptions = this.getSelectedOptions();\n    const selectedOptionsMulti = this.getSelectedOptionsMulti();\n    return options.reduce(function ([priceInclTaxTotal, priceExclTaxTotal], {\n      data = [],\n      option_id,\n      type\n    }) {\n      /*\n      * Such types contain a single item within data\n      * as those are looked up on the option_id\n      */\n      if (['area', 'field', 'file'].includes(type)) {\n        if (selectedOptionsMulti.includes(option_id)) {\n          const [{\n            priceInclTax,\n            priceExclTax\n          }] = data;\n          return [priceInclTaxTotal + priceInclTax, priceExclTaxTotal + priceExclTax];\n        }\n\n        return [priceInclTaxTotal, priceExclTaxTotal];\n      }\n\n      const [selectionPriceInclTax, selectionPriceExclTax] = data.reduce(function ([optionPriceInclTax, optionPriceExclTax], {\n        option_type_id,\n        priceInclTax,\n        priceExclTax\n      }) {\n        if (selectedOptions.includes(option_type_id)) {\n          return [optionPriceInclTax + priceInclTax, optionPriceExclTax + priceExclTax];\n        }\n\n        return [optionPriceInclTax, optionPriceExclTax];\n      }, [0, 0]);\n      return [priceInclTaxTotal + selectionPriceInclTax, priceExclTaxTotal + selectionPriceExclTax];\n    }, [0, 0]);\n  }\n\n  getSimpleBasePrice() {\n    const {\n      product: {\n        price_range: {\n          minimum_price: {\n            regular_price_excl_tax: {\n              currency\n            } = {},\n            default_final_price_excl_tax: {\n              value: defaultFinalPriceExclTax = 0\n            } = {},\n            default_final_price: {\n              value: defaultFinalPrice = 0\n            } = {},\n            default_price: {\n              value: defaultPrice = 0\n            } = {},\n            discount: {\n              percent_off = 0\n            } = {}\n          } = {}\n        } = {}\n      } = {}\n    } = this.props;\n    return {\n      minimum_price: {\n        final_price: {\n          currency,\n          value: defaultFinalPrice\n        },\n        discount: {\n          percent_off\n        },\n        regular_price: {\n          value: defaultPrice\n        },\n        final_price_excl_tax: {\n          value: defaultFinalPriceExclTax\n        }\n      }\n    };\n  }\n\n  getCustomizablePrice({\n    minimum_price: {\n      final_price: {\n        currency,\n        value: finalPrice\n      },\n      discount: {\n        percent_off\n      },\n      regular_price: {\n        value: regularPrice\n      },\n      final_price_excl_tax: {\n        value: finalPriceExclTax\n      }\n    }\n  }) {\n    const {\n      product: {\n        options = []\n      } = {}\n    } = this.props;\n    const [priceInclTax, priceExclTax] = this.getOptionPricesTotal(options);\n    return {\n      minimum_price: {\n        final_price: {\n          currency,\n          value: priceInclTax + finalPrice\n        },\n        discount: {\n          percent_off\n        },\n        regular_price: {\n          value: priceInclTax + regularPrice\n        },\n        final_price_excl_tax: {\n          value: priceExclTax + finalPriceExclTax\n        }\n      }\n    };\n  }\n\n  getProductPrice() {\n    const {\n      product: {\n        options = {}\n      }\n    } = this.props;\n    const priceWithVariants = this.getProductPriceWithVariants();\n\n    if (Object.keys(options).length === 0) {\n      return priceWithVariants;\n    }\n\n    return this.getCustomizablePrice(priceWithVariants);\n  }\n\n  getProductPriceWithVariants() {\n    const {\n      product,\n      product: {\n        variants = [],\n        type_id,\n        links_purchased_separately\n      },\n      configurableVariantIndex,\n      selectedLinkPrice\n    } = this.props;\n    const {\n      options = []\n    } = product;\n    const {\n      price_range\n    } = variants[configurableVariantIndex] || product;\n\n    if (type_id === BUNDLE) {\n      const {\n        selectedBundlePrice,\n        selectedBundlePriceExclTax,\n        selectedInitialBundlePrice,\n        product: {\n          dynamic_price\n        }\n      } = this.props;\n      return this._getBundleCustomPrice(selectedBundlePrice, selectedBundlePriceExclTax, selectedInitialBundlePrice, dynamic_price);\n    }\n\n    if (type_id === DOWNLOADABLE && links_purchased_separately) {\n      return this._getCustomPrice(selectedLinkPrice, selectedLinkPrice, true);\n    }\n\n    if ((type_id === SIMPLE || type_id === VIRTUAL) && options.length !== 0) {\n      // price of a product before selecting any options\n      return this.getSimpleBasePrice();\n    }\n\n    return price_range;\n  }\n\n  _getCustomPrice(price, withoutTax, addBase = false) {\n    const {\n      product: {\n        price_range: {\n          minimum_price: {\n            regular_price: {\n              currency = '',\n              value = 0\n            } = {},\n            regular_price_excl_tax: {\n              value: value_excl_tax = 0\n            } = {},\n            discount: {\n              percent_off = 0\n            } = {}\n          } = {}\n        } = {}\n      } = {}\n    } = this.props;\n    const discount = 1 - percent_off / ONE_HUNDRED_PERCENT;\n    const basePrice = addBase ? value : 0;\n    const basePriceExclTax = addBase ? value_excl_tax : 0;\n    const finalPrice = (basePrice + price) * discount;\n    const finalPriceExclTax = (basePriceExclTax + withoutTax) * discount;\n    const priceValue = {\n      value: finalPrice,\n      currency\n    };\n    const priceValueExclTax = {\n      value: finalPriceExclTax,\n      currency\n    };\n    return {\n      minimum_price: {\n        final_price: priceValue,\n        regular_price: priceValue,\n        final_price_excl_tax: priceValueExclTax,\n        regular_price_excl_tax: priceValueExclTax\n      }\n    };\n  }\n\n  _getBundleCustomPrice(price, withoutTax, initial, isDynamicPrice) {\n    const {\n      product: {\n        price_range: {\n          minimum_price: {\n            default_price: {\n              currency,\n              value: defaultPrice\n            },\n            default_final_price: {\n              value: defaultFinalPrice\n            },\n            default_final_price_excl_tax: {\n              value: defaultFinalPriceExclTax\n            },\n            discount: discountData,\n            discount: {\n              percent_off\n            }\n          }\n        }\n      }\n    } = this.props; // If bundle product has dynamic price, it's own base price is always 0. For fix priced bundles price it's configurable\n\n    const addBase = !isDynamicPrice; // Adjusting `discount` for bundle products for discount to be displayed on PDP\n\n    const priceBeforeDiscount = addBase ? defaultPrice : initial;\n    const priceAfterDiscount = addBase ? defaultFinalPrice : price;\n    const finalDiscount = !percent_off && defaultPrice !== defaultFinalPrice ? {\n      percent_off: ONE_HUNDRED_PERCENT * (priceBeforeDiscount - priceAfterDiscount) / priceBeforeDiscount,\n      amount_off: priceBeforeDiscount - priceAfterDiscount\n    } : discountData; // Set initial price different from 0 for specific product types, i.e. downloadable, bundles with fixed price\n\n    const baseInitialPrice = addBase ? defaultPrice : 0;\n    const baseFinalPrice = addBase ? defaultFinalPrice : 0;\n    const basePriceExclTax = addBase ? defaultFinalPriceExclTax : 0;\n    const initialPrice = baseInitialPrice + initial;\n    const finalPrice = baseFinalPrice + price;\n    const finalPriceExclTax = basePriceExclTax + withoutTax;\n    const initialPriceValue = {\n      value: initialPrice,\n      currency\n    };\n    const priceValue = {\n      value: finalPrice,\n      currency\n    };\n    const priceValueExclTax = {\n      value: finalPriceExclTax,\n      currency\n    };\n    return {\n      minimum_price: {\n        final_price: priceValue,\n        regular_price: initialPriceValue,\n        final_price_excl_tax: priceValueExclTax,\n        regular_price_excl_tax: initialPriceValue,\n        discount: finalDiscount\n      }\n    };\n  }\n\n  _getGroupedProductQuantity() {\n    const {\n      groupedProductQuantity\n    } = this.state;\n    return groupedProductQuantity;\n  }\n\n  _setGroupedProductQuantity(id, value) {\n    this.setState(function ({\n      groupedProductQuantity\n    }) {\n      return {\n        groupedProductQuantity: { ...groupedProductQuantity,\n          [id]: value\n        }\n      };\n    });\n  }\n\n  _clearGroupedProductQuantity() {\n    this.setState({\n      groupedProductQuantity: {}\n    });\n  }\n\n  showOnlyIfLoaded(expression, content, placeholder = content) {\n    const {\n      areDetailsLoaded\n    } = this.props;\n\n    if (!areDetailsLoaded) {\n      return placeholder;\n    }\n\n    if (areDetailsLoaded && !expression) {\n      return null;\n    }\n\n    return content;\n  }\n\n  render() {\n    return /*#__PURE__*/_checkBEM(React, ProductActions, Object.assign({}, this.props, this.state, this.containerProps(), this.containerFunctions, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 589,\n        columnNumber: 13\n      }\n    }));\n  }\n\n}, _class.propTypes = {\n  product: ProductType.isRequired,\n  productOrVariant: PropTypes.object.isRequired,\n  configurableVariantIndex: PropTypes.number.isRequired,\n  areDetailsLoaded: PropTypes.bool.isRequired,\n  productOptionsData: PropTypes.objectOf(PropTypes.array).isRequired,\n  parameters: PropTypes.objectOf(PropTypes.string).isRequired,\n  selectedInitialBundlePrice: PropTypes.number.isRequired,\n  selectedBundlePrice: PropTypes.number.isRequired,\n  selectedBundlePriceExclTax: PropTypes.number.isRequired,\n  selectedLinkPrice: PropTypes.number.isRequired,\n  getLink: PropTypes.func.isRequired,\n  isWishlistEnabled: PropTypes.bool.isRequired\n}, _temp), \"Component/ProductActions/Container\");\n/** #namespace Component/ProductActions/Container/mapDispatchToProps */\n// eslint-disable-next-line no-unused-vars\n\nexport const mapDispatchToProps = Mosaic.middleware(function (dispatch) {\n  return {};\n}, \"Component/ProductActions/Container/mapDispatchToProps\");\nexport default connect(mapStateToProps, mapDispatchToProps)(ProductActionsContainer);","map":{"version":3,"sources":["/home/arturs/scandiweb/extension/node_modules/@scandipwa/scandipwa/src/component/ProductActions/ProductActions.container.js"],"names":["PropTypes","PureComponent","connect","IN_STOCK","OUT_OF_STOCK","ProductType","BUNDLE","CONFIGURABLE","DOWNLOADABLE","GROUPED","SIMPLE","VIRTUAL","ProductActions","DEFAULT_MAX_PRODUCTS","ONE_HUNDRED_PERCENT","mapStateToProps","state","groupedProductQuantity","ProductReducer","device","ConfigReducer","displayProductStockStatus","display_product_stock_status","isWishlistEnabled","wishlist_general_active","quantity","containerFunctions","showOnlyIfLoaded","bind","onProductValidationError","getIsOptionInCurrentVariant","setQuantity","setGroupedProductQuantity","_setGroupedProductQuantity","clearGroupedProductQuantity","_clearGroupedProductQuantity","getIsConfigurableAttributeAvailable","onConfigurableProductError","onProductError","configurableOptionsRef","onGroupedProductError","groupedProductsRef","containerProps","minQuantity","ProductActionsContainer","getMinQuantity","props","maxQuantity","getMaxQuantity","_getGroupedProductQuantity","productPrice","getProductPrice","productName","getProductName","offerCount","getOfferCount","offerType","getOfferType","stockMeta","getStockMeta","metaLink","getMetaLink","product","stock_item","min_sale_qty","variants","configurableVariantIndex","minVariantQty","max_sale_qty","Object","keys","length","maxVariantQty","getDerivedStateFromProps","minQty","maxQty","ref","current","scrollIntoView","behavior","block","classList","remove","offsetWidth","add","type","value","setState","attribute","attribute_code","attribute_value","parameters","isAttributeSelected","hasOwnProperty","call","parameterPairs","entries","selectedAttributes","filter","key","some","stock_status","attributes","foundValue","every","name","getLink","window","location","origin","replace","getSelectedOptions","productOptionsData","productOptionsMulti","productOptions","map","productOption","option_value","parseInt","getSelectedOptionsMulti","option_id","getOptionPricesTotal","options","selectedOptions","selectedOptionsMulti","reduce","priceInclTaxTotal","priceExclTaxTotal","data","includes","priceInclTax","priceExclTax","selectionPriceInclTax","selectionPriceExclTax","optionPriceInclTax","optionPriceExclTax","option_type_id","getSimpleBasePrice","price_range","minimum_price","regular_price_excl_tax","currency","default_final_price_excl_tax","defaultFinalPriceExclTax","default_final_price","defaultFinalPrice","default_price","defaultPrice","discount","percent_off","final_price","regular_price","final_price_excl_tax","getCustomizablePrice","finalPrice","regularPrice","finalPriceExclTax","priceWithVariants","getProductPriceWithVariants","type_id","links_purchased_separately","selectedLinkPrice","selectedBundlePrice","selectedBundlePriceExclTax","selectedInitialBundlePrice","dynamic_price","_getBundleCustomPrice","_getCustomPrice","price","withoutTax","addBase","value_excl_tax","basePrice","basePriceExclTax","priceValue","priceValueExclTax","initial","isDynamicPrice","discountData","priceBeforeDiscount","priceAfterDiscount","finalDiscount","amount_off","baseInitialPrice","baseFinalPrice","initialPrice","initialPriceValue","id","expression","content","placeholder","areDetailsLoaded","render","propTypes","isRequired","productOrVariant","object","number","bool","objectOf","array","string","func","mapDispatchToProps","dispatch"],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,OAAOA,SAAP,MAAsB,YAAtB;AACA,SAASC,aAAT,QAA8B,OAA9B;AACA,SAASC,OAAT,QAAwB,aAAxB;AAEA,SAASC,QAAT,EAAmBC,YAAnB;AACA,SAASC,WAAT;AACA,SACIC,MADJ,EAEIC,YAFJ,EAGIC,YAHJ,EAIIC,OAJJ,EAKIC,MALJ,EAMIC,OANJ;AASA,OAAOC,cAAP;AACA,SAASC,oBAAT,EAA+BC,mBAA/B;AAEA;;AACA,OAAO,MAAMC,eAAe,qBAAG,UAACC,KAAD;AAAA,SAAY;AACvCC,IAAAA,sBAAsB,EAAED,KAAK,CAACE,cAAN,CAAqBD,sBADN;AAEvCE,IAAAA,MAAM,EAAEH,KAAK,CAACI,aAAN,CAAoBD,MAFW;AAGvCE,IAAAA,yBAAyB,EAAEL,KAAK,CAACI,aAAN,CAAoBE,4BAHR;AAIvCC,IAAAA,iBAAiB,EAAEP,KAAK,CAACI,aAAN,CAAoBI;AAJA,GAAZ;AAAA,CAAH,uDAArB;AAOP;;;;AACA,oIAA6CvB,aAA7C,EAA2D;AAAA;AAAA;;AAAA;AAAA;AAAA,SA8DvDe,KA9DuD,GA8D/C;AACJS,MAAAA,QAAQ,EAAE,CADN;AAEJR,MAAAA,sBAAsB,EAAE;AAFpB,KA9D+C;AAAA,SAmEvDS,kBAnEuD,GAmElC;AACjBC,MAAAA,gBAAgB,EAAE,KAAKA,gBAAL,CAAsBC,IAAtB,CAA2B,IAA3B,CADD;AAEjBC,MAAAA,wBAAwB,EAAE,KAAKA,wBAAL,CAA8BD,IAA9B,CAAmC,IAAnC,CAFT;AAGjBE,MAAAA,2BAA2B,EAAE,KAAKA,2BAAL,CAAiCF,IAAjC,CAAsC,IAAtC,CAHZ;AAIjBG,MAAAA,WAAW,EAAE,KAAKA,WAAL,CAAiBH,IAAjB,CAAsB,IAAtB,CAJI;AAKjBI,MAAAA,yBAAyB,EAAE,KAAKC,0BAAL,CAAgCL,IAAhC,CAAqC,IAArC,CALV;AAMjBM,MAAAA,2BAA2B,EAAE,KAAKC,4BAAL,CAAkCP,IAAlC,CAAuC,IAAvC,CANZ;AAOjBQ,MAAAA,mCAAmC,EAAE,KAAKA,mCAAL,CAAyCR,IAAzC,CAA8C,IAA9C;AAPpB,KAnEkC;AAAA,SA4FvDS,0BA5FuD,GA4F1B,KAAKC,cAAL,CAAoBV,IAApB,CAAyB,IAAzB,EAA+B,KAAKW,sBAApC,CA5F0B;AAAA,SA8FvDC,qBA9FuD,GA8F/B,KAAKF,cAAL,CAAoBV,IAApB,CAAyB,IAAzB,EAA+B,KAAKa,kBAApC,CA9F+B;;AAAA,SA2KvDC,cA3KuD,GA2KtC;AAAA,aAAO;AACpBC,QAAAA,WAAW,EAAEC,uBAAuB,CAACC,cAAxB,CAAuC,KAAI,CAACC,KAA5C,CADO;AAEpBC,QAAAA,WAAW,EAAEH,uBAAuB,CAACI,cAAxB,CAAuC,KAAI,CAACF,KAA5C,CAFO;AAGpB7B,QAAAA,sBAAsB,EAAE,KAAI,CAACgC,0BAAL,EAHJ;AAIpBC,QAAAA,YAAY,EAAE,KAAI,CAACC,eAAL,EAJM;AAKpBC,QAAAA,WAAW,EAAE,KAAI,CAACC,cAAL,EALO;AAMpBC,QAAAA,UAAU,EAAE,KAAI,CAACC,aAAL,EANQ;AAOpBC,QAAAA,SAAS,EAAE,KAAI,CAACC,YAAL,EAPS;AAQpBC,QAAAA,SAAS,EAAE,KAAI,CAACC,YAAL,EARS;AASpBC,QAAAA,QAAQ,EAAE,KAAI,CAACC,WAAL;AATU,OAAP;AAAA,KA3KsC;AAAA;;AAgBlC,SAAdhB,cAAc,CAACC,KAAD,EAAQ;AACzB,UAAM;AACFgB,MAAAA,OAAO,EAAE;AAAEC,QAAAA,UAAU,EAAE;AAAEC,UAAAA;AAAF,YAAmB,EAAjC;AAAqCC,QAAAA;AAArC,UAAkD,EADzD;AAEFC,MAAAA;AAFE,QAGFpB,KAHJ;;AAKA,QAAI,CAACkB,YAAL,EAAmB;AACf,aAAO,CAAP;AACH;;AACD,QAAI,CAACE,wBAAD,IAA6B,CAACD,QAAlC,EAA4C;AACxC,aAAOD,YAAP;AACH;;AAED,UAAM;AAAED,MAAAA,UAAU,EAAE;AAAEC,QAAAA,YAAY,EAAEG;AAAhB,UAAkC;AAAhD,QAAuDF,QAAQ,CAACC,wBAAD,CAAR,IAAsC,EAAnG;AAEA,WAAOC,aAAa,IAAIH,YAAxB;AACH;;AAEoB,SAAdhB,cAAc,CAACF,KAAD,EAAQ;AACzB,UAAM;AACFgB,MAAAA,OAAO,EAAE;AACLC,QAAAA,UAAU,EAAE;AACRK,UAAAA;AADQ,YAER,EAHC;AAILH,QAAAA;AAJK,UAKL,EANF;AAOFC,MAAAA;AAPE,QAQFpB,KARJ;;AAUA,QAAI,CAACsB,YAAL,EAAmB;AACf,aAAOvD,oBAAP;AACH;;AAED,QAAIqD,wBAAwB,KAAK,CAAC,CAA9B,IAAmC,CAACG,MAAM,CAACC,IAAP,CAAYL,QAAZ,EAAsBM,MAA9D,EAAsE;AAClE,aAAOH,YAAP;AACH;;AAED,UAAM;AACFL,MAAAA,UAAU,EAAE;AACRK,QAAAA,YAAY,EAAEI;AADN,UAER;AAHF,QAIFP,QAAQ,CAACC,wBAAD,CAAR,IAAsC,EAJ1C;AAMA,WAAOM,aAAa,IAAIJ,YAAxB;AACH;;AAiB8B,SAAxBK,wBAAwB,CAAC3B,KAAD,EAAQ9B,KAAR,EAAe;AAC1C,UAAM;AAAES,MAAAA;AAAF,QAAeT,KAArB;AACA,UAAM0D,MAAM,GAAG9B,uBAAuB,CAACC,cAAxB,CAAuCC,KAAvC,CAAf;AACA,UAAM6B,MAAM,GAAG/B,uBAAuB,CAACI,cAAxB,CAAuCF,KAAvC,CAAf;;AAEA,QAAIrB,QAAQ,GAAGiD,MAAf,EAAuB;AACnB,aAAO;AAAEjD,QAAAA,QAAQ,EAAEiD;AAAZ,OAAP;AACH;;AACD,QAAIjD,QAAQ,GAAGkD,MAAf,EAAuB;AACnB,aAAO;AAAElD,QAAAA,QAAQ,EAAEkD;AAAZ,OAAP;AACH;;AAED,WAAO,IAAP;AACH;;AAMDrC,EAAAA,cAAc,CAACsC,GAAD,EAAM;AAChB,QAAI,CAACA,GAAL,EAAU;AACN;AACH;;AACD,UAAM;AAAEC,MAAAA;AAAF,QAAcD,GAApB;AAEAC,IAAAA,OAAO,CAACC,cAAR,CAAuB;AACnBC,MAAAA,QAAQ,EAAE,QADS;AAEnBC,MAAAA,KAAK,EAAE;AAFY,KAAvB;AAKAH,IAAAA,OAAO,CAACI,SAAR,CAAkBC,MAAlB,CAAyB,SAAzB,EAXgB,CAYhB;;AACAL,IAAAA,OAAO,CAACM,WAAR,CAbgB,CAaK;;AACrBN,IAAAA,OAAO,CAACI,SAAR,CAAkBG,GAAlB,CAAsB,SAAtB;AACH;;AAEDvD,EAAAA,wBAAwB,CAACwD,IAAD,EAAO;AAC3B,YAAQA,IAAR;AACA,WAAK9E,YAAL;AACI,aAAK8B,0BAAL;AACA;;AACJ,WAAK5B,OAAL;AACI,aAAK+B,qBAAL;AACA;;AACJ;AACI;AARJ;AAUH;;AAEDT,EAAAA,WAAW,CAACuD,KAAD,EAAQ;AACf,SAAKC,QAAL,CAAc;AAAE9D,MAAAA,QAAQ,EAAE,CAAC6D;AAAb,KAAd;AACH,GAhIsD,CAkIvD;;;AACAxD,EAAAA,2BAA2B,CAAC0D,SAAD,EAAYF,KAAZ,EAAmB;AAC1C,UAAM;AAAEpB,MAAAA,wBAAF;AAA4BJ,MAAAA,OAAO,EAAE;AAAEG,QAAAA;AAAF;AAArC,QAAsD,KAAKnB,KAAjE;;AACA,QAAI,CAACmB,QAAL,EAAe;AACX,aAAO,KAAP;AACH;;AAED,WAAOA,QAAQ,CAACC,wBAAD,CAAR,CAAmCJ,OAAnC,CAA2C0B,SAA3C,MAA0DF,KAAjE;AACH;;AAEDlD,EAAAA,mCAAmC,CAAC;AAAEqD,IAAAA,cAAF;AAAkBC,IAAAA;AAAlB,GAAD,EAAsC;AACrE,UAAM;AAAEC,MAAAA,UAAF;AAAc7B,MAAAA,OAAO,EAAE;AAAEG,QAAAA;AAAF;AAAvB,QAAwC,KAAKnB,KAAnD;AAEA,UAAM8C,mBAAmB,GAAGvB,MAAM,CAACwB,cAAP,CAAsBC,IAAtB,CAA2BH,UAA3B,EAAuCF,cAAvC,CAA5B,CAHqE,CAKrE;;AACA,QAAIG,mBAAmB,IAAID,UAAU,CAACF,cAAD,CAAV,KAA+BC,eAA1D,EAA2E;AACvE,aAAO,IAAP;AACH;;AAED,UAAMK,cAAc,GAAG1B,MAAM,CAAC2B,OAAP,CAAeL,UAAf,CAAvB;AAEA,UAAMM,kBAAkB,GAAGL,mBAAmB,CAC1C;AAD0C,MAExCG,cAAc,CAACG,MAAf,CAAsB,UAAC,CAACC,GAAD,CAAD;AAAA,aAAWA,GAAG,KAAKV,cAAnB;AAAA,KAAtB,CAFwC,GAGxCM,cAHN;AAKA,WAAO9B,QAAQ,CACVmC,IADE,CACG,UAAC;AAAEC,MAAAA,YAAF;AAAgBC,MAAAA;AAAhB,KAAD,EAAkC;AACpC,YAAM;AAAEZ,QAAAA,eAAe,EAAEa;AAAnB,UAAkCD,UAAU,CAACb,cAAD,CAAV,IAA8B,EAAtE;AAEA,aACIY,YAAY,KAAKlG,QAAjB,CACA;AADA,SAEGoG,UAAU,KAAKb,eAFlB,CAGA;AAHA,SAIGO,kBAAkB,CAACO,KAAnB,CAAyB,UAAC,CAACL,GAAD,EAAMb,KAAN,CAAD;AAAA,eAAkBgB,UAAU,CAACH,GAAD,CAAV,CAAgBT,eAAhB,KAAoCJ,KAAtD;AAAA,OAAzB,CALP;AAOH,KAXE,CAAP;AAYH;;AAcDjC,EAAAA,cAAc,GAAG;AACb,UAAM;AACFS,MAAAA,OADE;AAEFA,MAAAA,OAAO,EAAE;AAAEG,QAAAA,QAAQ,GAAG;AAAb,OAFP;AAGFC,MAAAA;AAHE,QAIF,KAAKpB,KAJT;AAMA,UAAM;AACF2D,MAAAA;AADE,QAEFxC,QAAQ,CAACC,wBAAD,CAAR,IAAsCJ,OAF1C;AAIA,WAAO2C,IAAP;AACH;;AAED5C,EAAAA,WAAW,GAAG;AACV,UAAM;AAAE6C,MAAAA;AAAF,QAAc,KAAK5D,KAAzB;AACA,WAAO6D,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GAAyBH,OAAO,GAAGI,OAAV,CAAkB,MAAlB,EAA0B,EAA1B,CAAhC;AACH;;AAEDnD,EAAAA,YAAY,GAAG;AACX,UAAM;AACFG,MAAAA,OADE;AAEFA,MAAAA,OAAO,EAAE;AAAEG,QAAAA,QAAQ,GAAG;AAAb,OAFP;AAGFC,MAAAA;AAHE,QAIF,KAAKpB,KAJT;AAMA,UAAM;AACFuD,MAAAA;AADE,QAEFpC,QAAQ,CAACC,wBAAD,CAAR,IAAsCJ,OAF1C;;AAIA,QAAIuC,YAAY,KAAKjG,YAArB,EAAmC;AAC/B,aAAO,+BAAP;AACH;;AAED,WAAO,4BAAP;AACH;;AAEDqD,EAAAA,YAAY,GAAG;AACX,UAAM;AAAEK,MAAAA,OAAO,EAAE;AAAEG,QAAAA;AAAF;AAAX,QAA4B,KAAKnB,KAAvC;;AAEA,QAAImB,QAAQ,IAAIA,QAAQ,CAACM,MAAT,IAAmB,CAAnC,EAAsC;AAClC,aAAO,mCAAP;AACH;;AAED,WAAO,0BAAP;AACH;;AAEDhB,EAAAA,aAAa,GAAG;AACZ,UAAM;AAAEO,MAAAA,OAAO,EAAE;AAAEG,QAAAA;AAAF;AAAX,QAA4B,KAAKnB,KAAvC;;AAEA,QAAImB,QAAQ,IAAIA,QAAQ,CAACM,MAAzB,EAAiC;AAC7B,aAAON,QAAQ,CAACM,MAAhB;AACH;;AAED,WAAO,CAAP;AACH;;AAEDwC,EAAAA,kBAAkB,GAAG;AACjB,UAAM;AACFC,MAAAA,kBAAkB,EAAE;AAChBC,QAAAA,mBAAmB,GAAG,EADN;AAEhBC,QAAAA,cAAc,GAAG;AAFD,UAGhB;AAJF,QAKF,KAAKpE,KALT;AAOA,WAAO,CAAC,GAAGmE,mBAAJ,EAAyB,GAAGC,cAA5B,EAA4CC,GAA5C,CAAgD,UAACC,aAAD,EAAmB;AACtE,YAAM;AAAEC,QAAAA;AAAF,UAAmBD,aAAzB;AAEA,aAAOE,QAAQ,CAACD,YAAD,EAAe,EAAf,CAAf;AACH,KAJM,CAAP;AAKH;;AAEDE,EAAAA,uBAAuB,GAAG;AACtB,UAAM;AACFP,MAAAA,kBAAkB,EAAE;AAChBC,QAAAA,mBAAmB,GAAG,EADN;AAEhBC,QAAAA,cAAc,GAAG;AAFD,UAGhB;AAJF,QAKF,KAAKpE,KALT;AAOA,WAAO,CAAC,GAAGmE,mBAAJ,EAAyB,GAAGC,cAA5B,EAA4CC,GAA5C,CAAgD,UAACC,aAAD,EAAmB;AACtE,YAAM;AAAEI,QAAAA;AAAF,UAAgBJ,aAAtB;AAEA,aAAOE,QAAQ,CAACE,SAAD,EAAY,EAAZ,CAAf;AACH,KAJM,CAAP;AAKH;;AAEDC,EAAAA,oBAAoB,CAACC,OAAD,EAAU;AAC1B,UAAMC,eAAe,GAAG,KAAKZ,kBAAL,EAAxB;AACA,UAAMa,oBAAoB,GAAG,KAAKL,uBAAL,EAA7B;AAEA,WAAOG,OAAO,CAACG,MAAR,CAAe,UAAC,CAACC,iBAAD,EAAoBC,iBAApB,CAAD,EAAyC;AAAEC,MAAAA,IAAI,GAAG,EAAT;AAAaR,MAAAA,SAAb;AAAwBnC,MAAAA;AAAxB,KAAzC,EAA4E;AAC9F;AACZ;AACA;AACA;AACY,UAAI,CAAC,MAAD,EAAS,OAAT,EAAkB,MAAlB,EAA0B4C,QAA1B,CAAmC5C,IAAnC,CAAJ,EAA8C;AAC1C,YAAIuC,oBAAoB,CAACK,QAArB,CAA8BT,SAA9B,CAAJ,EAA8C;AAC1C,gBAAM,CAAC;AAAEU,YAAAA,YAAF;AAAgBC,YAAAA;AAAhB,WAAD,IAAmCH,IAAzC;AACA,iBAAO,CAACF,iBAAiB,GAAGI,YAArB,EAAmCH,iBAAiB,GAAGI,YAAvD,CAAP;AACH;;AAED,eAAO,CAACL,iBAAD,EAAoBC,iBAApB,CAAP;AACH;;AAED,YAAM,CACFK,qBADE,EAEFC,qBAFE,IAGFL,IAAI,CAACH,MAAL,CAAY,UACZ,CAACS,kBAAD,EAAqBC,kBAArB,CADY,EAC8B;AAAEC,QAAAA,cAAF;AAAkBN,QAAAA,YAAlB;AAAgCC,QAAAA;AAAhC,OAD9B,EAEX;AACD,YAAIR,eAAe,CAACM,QAAhB,CAAyBO,cAAzB,CAAJ,EAA8C;AAC1C,iBAAO,CACHF,kBAAkB,GAAGJ,YADlB,EAEHK,kBAAkB,GAAGJ,YAFlB,CAAP;AAIH;;AAED,eAAO,CAACG,kBAAD,EAAqBC,kBAArB,CAAP;AACH,OAXG,EAWD,CAAC,CAAD,EAAI,CAAJ,CAXC,CAHJ;AAgBA,aAAO,CACHT,iBAAiB,GAAGM,qBADjB,EAEHL,iBAAiB,GAAGM,qBAFjB,CAAP;AAIH,KAlCM,EAkCJ,CAAC,CAAD,EAAI,CAAJ,CAlCI,CAAP;AAmCH;;AAEDI,EAAAA,kBAAkB,GAAG;AACjB,UAAM;AACF3E,MAAAA,OAAO,EAAE;AACL4E,QAAAA,WAAW,EAAE;AACTC,UAAAA,aAAa,EAAE;AACXC,YAAAA,sBAAsB,EAAE;AACpBC,cAAAA;AADoB,gBAEpB,EAHO;AAIXC,YAAAA,4BAA4B,EAAE;AAC1BxD,cAAAA,KAAK,EAAEyD,wBAAwB,GAAG;AADR,gBAE1B,EANO;AAOXC,YAAAA,mBAAmB,EAAE;AACjB1D,cAAAA,KAAK,EAAE2D,iBAAiB,GAAG;AADV,gBAEjB,EATO;AAUXC,YAAAA,aAAa,EAAE;AACX5D,cAAAA,KAAK,EAAE6D,YAAY,GAAG;AADX,gBAEX,EAZO;AAaXC,YAAAA,QAAQ,EAAE;AACNC,cAAAA,WAAW,GAAG;AADR,gBAEN;AAfO,cAgBX;AAjBK,YAkBT;AAnBC,UAoBL;AArBF,QAsBF,KAAKvG,KAtBT;AAwBA,WAAO;AACH6F,MAAAA,aAAa,EAAE;AACXW,QAAAA,WAAW,EAAE;AACTT,UAAAA,QADS;AAETvD,UAAAA,KAAK,EAAE2D;AAFE,SADF;AAKXG,QAAAA,QAAQ,EAAE;AAAEC,UAAAA;AAAF,SALC;AAMXE,QAAAA,aAAa,EAAE;AAAEjE,UAAAA,KAAK,EAAE6D;AAAT,SANJ;AAOXK,QAAAA,oBAAoB,EAAE;AAAElE,UAAAA,KAAK,EAAEyD;AAAT;AAPX;AADZ,KAAP;AAWH;;AAEDU,EAAAA,oBAAoB,CAAC;AACjBd,IAAAA,aAAa,EAAE;AACXW,MAAAA,WAAW,EAAE;AACTT,QAAAA,QADS;AAETvD,QAAAA,KAAK,EAAEoE;AAFE,OADF;AAKXN,MAAAA,QAAQ,EAAE;AAAEC,QAAAA;AAAF,OALC;AAMXE,MAAAA,aAAa,EAAE;AAAEjE,QAAAA,KAAK,EAAEqE;AAAT,OANJ;AAOXH,MAAAA,oBAAoB,EAAE;AAAElE,QAAAA,KAAK,EAAEsE;AAAT;AAPX;AADE,GAAD,EAUjB;AACC,UAAM;AAAE9F,MAAAA,OAAO,EAAE;AAAE4D,QAAAA,OAAO,GAAG;AAAZ,UAAmB;AAA9B,QAAqC,KAAK5E,KAAhD;AAEA,UAAM,CAACoF,YAAD,EAAeC,YAAf,IAA+B,KAAKV,oBAAL,CAA0BC,OAA1B,CAArC;AAEA,WAAO;AACHiB,MAAAA,aAAa,EAAE;AACXW,QAAAA,WAAW,EAAE;AACTT,UAAAA,QADS;AAETvD,UAAAA,KAAK,EAAE4C,YAAY,GAAGwB;AAFb,SADF;AAKXN,QAAAA,QAAQ,EAAE;AAAEC,UAAAA;AAAF,SALC;AAMXE,QAAAA,aAAa,EAAE;AAAEjE,UAAAA,KAAK,EAAE4C,YAAY,GAAGyB;AAAxB,SANJ;AAOXH,QAAAA,oBAAoB,EAAE;AAAElE,UAAAA,KAAK,EAAE6C,YAAY,GAAGyB;AAAxB;AAPX;AADZ,KAAP;AAWH;;AAEDzG,EAAAA,eAAe,GAAG;AACd,UAAM;AAAEW,MAAAA,OAAO,EAAE;AAAE4D,QAAAA,OAAO,GAAG;AAAZ;AAAX,QAAgC,KAAK5E,KAA3C;AAEA,UAAM+G,iBAAiB,GAAG,KAAKC,2BAAL,EAA1B;;AAEA,QAAIzF,MAAM,CAACC,IAAP,CAAYoD,OAAZ,EAAqBnD,MAArB,KAAgC,CAApC,EAAuC;AACnC,aAAOsF,iBAAP;AACH;;AAED,WAAO,KAAKJ,oBAAL,CAA0BI,iBAA1B,CAAP;AACH;;AAEDC,EAAAA,2BAA2B,GAAG;AAC1B,UAAM;AACFhG,MAAAA,OADE;AAEFA,MAAAA,OAAO,EAAE;AAAEG,QAAAA,QAAQ,GAAG,EAAb;AAAiB8F,QAAAA,OAAjB;AAA0BC,QAAAA;AAA1B,OAFP;AAGF9F,MAAAA,wBAHE;AAIF+F,MAAAA;AAJE,QAKF,KAAKnH,KALT;AAOA,UAAM;AAAE4E,MAAAA,OAAO,GAAG;AAAZ,QAAmB5D,OAAzB;AAEA,UAAM;AACF4E,MAAAA;AADE,QAEFzE,QAAQ,CAACC,wBAAD,CAAR,IAAsCJ,OAF1C;;AAIA,QAAIiG,OAAO,KAAKzJ,MAAhB,EAAwB;AACpB,YAAM;AACF4J,QAAAA,mBADE;AAEFC,QAAAA,0BAFE;AAGFC,QAAAA,0BAHE;AAIFtG,QAAAA,OAAO,EAAE;AAAEuG,UAAAA;AAAF;AAJP,UAKF,KAAKvH,KALT;AAOA,aAAO,KAAKwH,qBAAL,CACHJ,mBADG,EAEHC,0BAFG,EAGHC,0BAHG,EAIHC,aAJG,CAAP;AAMH;;AAED,QAAIN,OAAO,KAAKvJ,YAAZ,IAA4BwJ,0BAAhC,EAA4D;AACxD,aAAO,KAAKO,eAAL,CAAqBN,iBAArB,EAAwCA,iBAAxC,EAA2D,IAA3D,CAAP;AACH;;AAED,QAAI,CAACF,OAAO,KAAKrJ,MAAZ,IAAsBqJ,OAAO,KAAKpJ,OAAnC,KAA+C+G,OAAO,CAACnD,MAAR,KAAmB,CAAtE,EAAyE;AACrE;AACA,aAAO,KAAKkE,kBAAL,EAAP;AACH;;AAED,WAAOC,WAAP;AACH;;AAED6B,EAAAA,eAAe,CAACC,KAAD,EAAQC,UAAR,EAAoBC,OAAO,GAAG,KAA9B,EAAqC;AAChD,UAAM;AACF5G,MAAAA,OAAO,EAAE;AACL4E,QAAAA,WAAW,EAAE;AACTC,UAAAA,aAAa,EAAE;AACXY,YAAAA,aAAa,EAAE;AAAEV,cAAAA,QAAQ,GAAG,EAAb;AAAiBvD,cAAAA,KAAK,GAAG;AAAzB,gBAA+B,EADnC;AAEXsD,YAAAA,sBAAsB,EAAE;AAAEtD,cAAAA,KAAK,EAAEqF,cAAc,GAAG;AAA1B,gBAAgC,EAF7C;AAGXvB,YAAAA,QAAQ,EAAE;AAAEC,cAAAA,WAAW,GAAG;AAAhB,gBAAsB;AAHrB,cAIX;AALK,YAMT;AAPC,UAQL;AATF,QAUF,KAAKvG,KAVT;AAYA,UAAMsG,QAAQ,GAAI,IAAIC,WAAW,GAAGvI,mBAApC;AAEA,UAAM8J,SAAS,GAAGF,OAAO,GAAGpF,KAAH,GAAW,CAApC;AACA,UAAMuF,gBAAgB,GAAGH,OAAO,GAAGC,cAAH,GAAoB,CAApD;AAEA,UAAMjB,UAAU,GAAG,CAACkB,SAAS,GAAGJ,KAAb,IAAsBpB,QAAzC;AACA,UAAMQ,iBAAiB,GAAG,CAACiB,gBAAgB,GAAGJ,UAApB,IAAkCrB,QAA5D;AAEA,UAAM0B,UAAU,GAAG;AAAExF,MAAAA,KAAK,EAAEoE,UAAT;AAAqBb,MAAAA;AAArB,KAAnB;AACA,UAAMkC,iBAAiB,GAAG;AAAEzF,MAAAA,KAAK,EAAEsE,iBAAT;AAA4Bf,MAAAA;AAA5B,KAA1B;AAEA,WAAO;AACHF,MAAAA,aAAa,EAAE;AACXW,QAAAA,WAAW,EAAEwB,UADF;AAEXvB,QAAAA,aAAa,EAAEuB,UAFJ;AAGXtB,QAAAA,oBAAoB,EAAEuB,iBAHX;AAIXnC,QAAAA,sBAAsB,EAAEmC;AAJb;AADZ,KAAP;AAQH;;AAEDT,EAAAA,qBAAqB,CAACE,KAAD,EAAQC,UAAR,EAAoBO,OAApB,EAA6BC,cAA7B,EAA6C;AAC9D,UAAM;AACFnH,MAAAA,OAAO,EAAE;AACL4E,QAAAA,WAAW,EAAE;AACTC,UAAAA,aAAa,EAAE;AACXO,YAAAA,aAAa,EAAE;AAAEL,cAAAA,QAAF;AAAYvD,cAAAA,KAAK,EAAE6D;AAAnB,aADJ;AAEXH,YAAAA,mBAAmB,EAAE;AAAE1D,cAAAA,KAAK,EAAE2D;AAAT,aAFV;AAGXH,YAAAA,4BAA4B,EAAE;AAAExD,cAAAA,KAAK,EAAEyD;AAAT,aAHnB;AAIXK,YAAAA,QAAQ,EAAE8B,YAJC;AAKX9B,YAAAA,QAAQ,EAAE;AAAEC,cAAAA;AAAF;AALC;AADN;AADR;AADP,QAYF,KAAKvG,KAZT,CAD8D,CAe9D;;AACA,UAAM4H,OAAO,GAAG,CAACO,cAAjB,CAhB8D,CAkB9D;;AACA,UAAME,mBAAmB,GAAGT,OAAO,GAAGvB,YAAH,GAAkB6B,OAArD;AACA,UAAMI,kBAAkB,GAAGV,OAAO,GAAGzB,iBAAH,GAAuBuB,KAAzD;AACA,UAAMa,aAAa,GAAG,CAAChC,WAAD,IAAgBF,YAAY,KAAKF,iBAAjC,GAChB;AACEI,MAAAA,WAAW,EAAGvI,mBAAmB,IAAIqK,mBAAmB,GAAGC,kBAA1B,CAApB,GAAqED,mBADpF;AAEEG,MAAAA,UAAU,EAAEH,mBAAmB,GAAGC;AAFpC,KADgB,GAKhBF,YALN,CArB8D,CA4B9D;;AACA,UAAMK,gBAAgB,GAAGb,OAAO,GAAGvB,YAAH,GAAkB,CAAlD;AACA,UAAMqC,cAAc,GAAGd,OAAO,GAAGzB,iBAAH,GAAuB,CAArD;AACA,UAAM4B,gBAAgB,GAAGH,OAAO,GAAG3B,wBAAH,GAA8B,CAA9D;AAEA,UAAM0C,YAAY,GAAGF,gBAAgB,GAAGP,OAAxC;AACA,UAAMtB,UAAU,GAAG8B,cAAc,GAAGhB,KAApC;AACA,UAAMZ,iBAAiB,GAAGiB,gBAAgB,GAAGJ,UAA7C;AAEA,UAAMiB,iBAAiB,GAAG;AAAEpG,MAAAA,KAAK,EAAEmG,YAAT;AAAuB5C,MAAAA;AAAvB,KAA1B;AACA,UAAMiC,UAAU,GAAG;AAAExF,MAAAA,KAAK,EAAEoE,UAAT;AAAqBb,MAAAA;AAArB,KAAnB;AACA,UAAMkC,iBAAiB,GAAG;AAAEzF,MAAAA,KAAK,EAAEsE,iBAAT;AAA4Bf,MAAAA;AAA5B,KAA1B;AAEA,WAAO;AACHF,MAAAA,aAAa,EAAE;AACXW,QAAAA,WAAW,EAAEwB,UADF;AAEXvB,QAAAA,aAAa,EAAEmC,iBAFJ;AAGXlC,QAAAA,oBAAoB,EAAEuB,iBAHX;AAIXnC,QAAAA,sBAAsB,EAAE8C,iBAJb;AAKXtC,QAAAA,QAAQ,EAAEiC;AALC;AADZ,KAAP;AASH;;AAEDpI,EAAAA,0BAA0B,GAAG;AACzB,UAAM;AAAEhC,MAAAA;AAAF,QAA6B,KAAKD,KAAxC;AACA,WAAOC,sBAAP;AACH;;AAEDgB,EAAAA,0BAA0B,CAAC0J,EAAD,EAAKrG,KAAL,EAAY;AAClC,SAAKC,QAAL,CAAc,UAAC;AAAEtE,MAAAA;AAAF,KAAD;AAAA,aAAiC;AAC3CA,QAAAA,sBAAsB,EAAE,EACpB,GAAGA,sBADiB;AAEpB,WAAC0K,EAAD,GAAMrG;AAFc;AADmB,OAAjC;AAAA,KAAd;AAMH;;AAEDnD,EAAAA,4BAA4B,GAAG;AAC3B,SAAKoD,QAAL,CAAc;AAAEtE,MAAAA,sBAAsB,EAAE;AAA1B,KAAd;AACH;;AAEDU,EAAAA,gBAAgB,CAACiK,UAAD,EAAaC,OAAb,EAAsBC,WAAW,GAAGD,OAApC,EAA6C;AACzD,UAAM;AAAEE,MAAAA;AAAF,QAAuB,KAAKjJ,KAAlC;;AAEA,QAAI,CAACiJ,gBAAL,EAAuB;AACnB,aAAOD,WAAP;AACH;;AACD,QAAIC,gBAAgB,IAAI,CAACH,UAAzB,EAAqC;AACjC,aAAO,IAAP;AACH;;AAED,WAAOC,OAAP;AACH;;AAEDG,EAAAA,MAAM,GAAG;AACL,yCACK,cADL,oBAEW,KAAKlJ,KAFhB,EAGW,KAAK9B,KAHhB,EAIW,KAAK0B,cAAL,EAJX,EAKW,KAAKhB,kBALhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQH;;AA7iBsD,CAA3D,SACWuK,SADX,GACuB;AACfnI,EAAAA,OAAO,EAAEzD,WAAW,CAAC6L,UADN;AAEfC,EAAAA,gBAAgB,EAAEnM,SAAS,CAACoM,MAAV,CAAiBF,UAFpB;AAGfhI,EAAAA,wBAAwB,EAAElE,SAAS,CAACqM,MAAV,CAAiBH,UAH5B;AAIfH,EAAAA,gBAAgB,EAAE/L,SAAS,CAACsM,IAAV,CAAeJ,UAJlB;AAKflF,EAAAA,kBAAkB,EAAEhH,SAAS,CAACuM,QAAV,CAAmBvM,SAAS,CAACwM,KAA7B,EAAoCN,UALzC;AAMfvG,EAAAA,UAAU,EAAE3F,SAAS,CAACuM,QAAV,CAAmBvM,SAAS,CAACyM,MAA7B,EAAqCP,UANlC;AAOf9B,EAAAA,0BAA0B,EAAEpK,SAAS,CAACqM,MAAV,CAAiBH,UAP9B;AAQfhC,EAAAA,mBAAmB,EAAElK,SAAS,CAACqM,MAAV,CAAiBH,UARvB;AASf/B,EAAAA,0BAA0B,EAAEnK,SAAS,CAACqM,MAAV,CAAiBH,UAT9B;AAUfjC,EAAAA,iBAAiB,EAAEjK,SAAS,CAACqM,MAAV,CAAiBH,UAVrB;AAWfxF,EAAAA,OAAO,EAAE1G,SAAS,CAAC0M,IAAV,CAAeR,UAXT;AAYf3K,EAAAA,iBAAiB,EAAEvB,SAAS,CAACsM,IAAV,CAAeJ;AAZnB,CADvB;AAgjBA;AACA;;AACA,OAAO,MAAMS,kBAAkB,qBAAG,UAACC,QAAD;AAAA,SAAe,EAAf;AAAA,CAAH,0DAAxB;AAEP,eAAe1M,OAAO,CAACa,eAAD,EAAkB4L,kBAAlB,CAAP,CAA6C/J,uBAA7C,CAAf","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport { IN_STOCK, OUT_OF_STOCK } from 'Component/ProductCard/ProductCard.config';\nimport { ProductType } from 'Type/ProductList';\nimport {\n    BUNDLE,\n    CONFIGURABLE,\n    DOWNLOADABLE,\n    GROUPED,\n    SIMPLE,\n    VIRTUAL\n} from 'Util/Product';\n\nimport ProductActions from './ProductActions.component';\nimport { DEFAULT_MAX_PRODUCTS, ONE_HUNDRED_PERCENT } from './ProductActions.config';\n\n/** @namespace Component/ProductActions/Container/mapStateToProps */\nexport const mapStateToProps = (state) => ({\n    groupedProductQuantity: state.ProductReducer.groupedProductQuantity,\n    device: state.ConfigReducer.device,\n    displayProductStockStatus: state.ConfigReducer.display_product_stock_status,\n    isWishlistEnabled: state.ConfigReducer.wishlist_general_active\n});\n\n/** @namespace Component/ProductActions/Container */\nexport class ProductActionsContainer extends PureComponent {\n    static propTypes = {\n        product: ProductType.isRequired,\n        productOrVariant: PropTypes.object.isRequired,\n        configurableVariantIndex: PropTypes.number.isRequired,\n        areDetailsLoaded: PropTypes.bool.isRequired,\n        productOptionsData: PropTypes.objectOf(PropTypes.array).isRequired,\n        parameters: PropTypes.objectOf(PropTypes.string).isRequired,\n        selectedInitialBundlePrice: PropTypes.number.isRequired,\n        selectedBundlePrice: PropTypes.number.isRequired,\n        selectedBundlePriceExclTax: PropTypes.number.isRequired,\n        selectedLinkPrice: PropTypes.number.isRequired,\n        getLink: PropTypes.func.isRequired,\n        isWishlistEnabled: PropTypes.bool.isRequired\n    };\n\n    static getMinQuantity(props) {\n        const {\n            product: { stock_item: { min_sale_qty } = {}, variants } = {},\n            configurableVariantIndex\n        } = props;\n\n        if (!min_sale_qty) {\n            return 1;\n        }\n        if (!configurableVariantIndex && !variants) {\n            return min_sale_qty;\n        }\n\n        const { stock_item: { min_sale_qty: minVariantQty } = {} } = variants[configurableVariantIndex] || {};\n\n        return minVariantQty || min_sale_qty;\n    }\n\n    static getMaxQuantity(props) {\n        const {\n            product: {\n                stock_item: {\n                    max_sale_qty\n                } = {},\n                variants\n            } = {},\n            configurableVariantIndex\n        } = props;\n\n        if (!max_sale_qty) {\n            return DEFAULT_MAX_PRODUCTS;\n        }\n\n        if (configurableVariantIndex === -1 || !Object.keys(variants).length) {\n            return max_sale_qty;\n        }\n\n        const {\n            stock_item: {\n                max_sale_qty: maxVariantQty\n            } = {}\n        } = variants[configurableVariantIndex] || {};\n\n        return maxVariantQty || max_sale_qty;\n    }\n\n    state = {\n        quantity: 1,\n        groupedProductQuantity: {}\n    };\n\n    containerFunctions = {\n        showOnlyIfLoaded: this.showOnlyIfLoaded.bind(this),\n        onProductValidationError: this.onProductValidationError.bind(this),\n        getIsOptionInCurrentVariant: this.getIsOptionInCurrentVariant.bind(this),\n        setQuantity: this.setQuantity.bind(this),\n        setGroupedProductQuantity: this._setGroupedProductQuantity.bind(this),\n        clearGroupedProductQuantity: this._clearGroupedProductQuantity.bind(this),\n        getIsConfigurableAttributeAvailable: this.getIsConfigurableAttributeAvailable.bind(this)\n    };\n\n    static getDerivedStateFromProps(props, state) {\n        const { quantity } = state;\n        const minQty = ProductActionsContainer.getMinQuantity(props);\n        const maxQty = ProductActionsContainer.getMaxQuantity(props);\n\n        if (quantity < minQty) {\n            return { quantity: minQty };\n        }\n        if (quantity > maxQty) {\n            return { quantity: maxQty };\n        }\n\n        return null;\n    }\n\n    onConfigurableProductError = this.onProductError.bind(this, this.configurableOptionsRef);\n\n    onGroupedProductError = this.onProductError.bind(this, this.groupedProductsRef);\n\n    onProductError(ref) {\n        if (!ref) {\n            return;\n        }\n        const { current } = ref;\n\n        current.scrollIntoView({\n            behavior: 'smooth',\n            block: 'center'\n        });\n\n        current.classList.remove('animate');\n        // eslint-disable-next-line no-unused-expressions\n        current.offsetWidth; // trigger a DOM reflow\n        current.classList.add('animate');\n    }\n\n    onProductValidationError(type) {\n        switch (type) {\n        case CONFIGURABLE:\n            this.onConfigurableProductError();\n            break;\n        case GROUPED:\n            this.onGroupedProductError();\n            break;\n        default:\n            break;\n        }\n    }\n\n    setQuantity(value) {\n        this.setState({ quantity: +value });\n    }\n\n    // TODO: make key=>value based\n    getIsOptionInCurrentVariant(attribute, value) {\n        const { configurableVariantIndex, product: { variants } } = this.props;\n        if (!variants) {\n            return false;\n        }\n\n        return variants[configurableVariantIndex].product[attribute] === value;\n    }\n\n    getIsConfigurableAttributeAvailable({ attribute_code, attribute_value }) {\n        const { parameters, product: { variants } } = this.props;\n\n        const isAttributeSelected = Object.hasOwnProperty.call(parameters, attribute_code);\n\n        // If value matches current attribute_value, option should be enabled\n        if (isAttributeSelected && parameters[attribute_code] === attribute_value) {\n            return true;\n        }\n\n        const parameterPairs = Object.entries(parameters);\n\n        const selectedAttributes = isAttributeSelected\n            // Need to exclude itself, otherwise different attribute_values of the same attribute_code will always be disabled\n            ? parameterPairs.filter(([key]) => key !== attribute_code)\n            : parameterPairs;\n\n        return variants\n            .some(({ stock_status, attributes }) => {\n                const { attribute_value: foundValue } = attributes[attribute_code] || {};\n\n                return (\n                    stock_status === IN_STOCK\n                    // Variant must have currently checked attribute_code and attribute_value\n                    && foundValue === attribute_value\n                    // Variant must have all currently selected attributes\n                    && selectedAttributes.every(([key, value]) => attributes[key].attribute_value === value)\n                );\n            });\n    }\n\n    containerProps = () => ({\n        minQuantity: ProductActionsContainer.getMinQuantity(this.props),\n        maxQuantity: ProductActionsContainer.getMaxQuantity(this.props),\n        groupedProductQuantity: this._getGroupedProductQuantity(),\n        productPrice: this.getProductPrice(),\n        productName: this.getProductName(),\n        offerCount: this.getOfferCount(),\n        offerType: this.getOfferType(),\n        stockMeta: this.getStockMeta(),\n        metaLink: this.getMetaLink()\n    });\n\n    getProductName() {\n        const {\n            product,\n            product: { variants = [] },\n            configurableVariantIndex\n        } = this.props;\n\n        const {\n            name\n        } = variants[configurableVariantIndex] || product;\n\n        return name;\n    }\n\n    getMetaLink() {\n        const { getLink } = this.props;\n        return window.location.origin + getLink().replace(/\\?.*/, '');\n    }\n\n    getStockMeta() {\n        const {\n            product,\n            product: { variants = [] },\n            configurableVariantIndex\n        } = this.props;\n\n        const {\n            stock_status\n        } = variants[configurableVariantIndex] || product;\n\n        if (stock_status === OUT_OF_STOCK) {\n            return 'https://schema.org/OutOfStock';\n        }\n\n        return 'https://schema.org/InStock';\n    }\n\n    getOfferType() {\n        const { product: { variants } } = this.props;\n\n        if (variants && variants.length >= 1) {\n            return 'https://schema.org/AggregateOffer';\n        }\n\n        return 'https://schema.org/Offer';\n    }\n\n    getOfferCount() {\n        const { product: { variants } } = this.props;\n\n        if (variants && variants.length) {\n            return variants.length;\n        }\n\n        return 0;\n    }\n\n    getSelectedOptions() {\n        const {\n            productOptionsData: {\n                productOptionsMulti = [],\n                productOptions = []\n            } = {}\n        } = this.props;\n\n        return [...productOptionsMulti, ...productOptions].map((productOption) => {\n            const { option_value } = productOption;\n\n            return parseInt(option_value, 10);\n        });\n    }\n\n    getSelectedOptionsMulti() {\n        const {\n            productOptionsData: {\n                productOptionsMulti = [],\n                productOptions = []\n            } = {}\n        } = this.props;\n\n        return [...productOptionsMulti, ...productOptions].map((productOption) => {\n            const { option_id } = productOption;\n\n            return parseInt(option_id, 10);\n        });\n    }\n\n    getOptionPricesTotal(options) {\n        const selectedOptions = this.getSelectedOptions();\n        const selectedOptionsMulti = this.getSelectedOptionsMulti();\n\n        return options.reduce(([priceInclTaxTotal, priceExclTaxTotal], { data = [], option_id, type }) => {\n            /*\n            * Such types contain a single item within data\n            * as those are looked up on the option_id\n            */\n            if (['area', 'field', 'file'].includes(type)) {\n                if (selectedOptionsMulti.includes(option_id)) {\n                    const [{ priceInclTax, priceExclTax }] = data;\n                    return [priceInclTaxTotal + priceInclTax, priceExclTaxTotal + priceExclTax];\n                }\n\n                return [priceInclTaxTotal, priceExclTaxTotal];\n            }\n\n            const [\n                selectionPriceInclTax,\n                selectionPriceExclTax\n            ] = data.reduce((\n                [optionPriceInclTax, optionPriceExclTax], { option_type_id, priceInclTax, priceExclTax }\n            ) => {\n                if (selectedOptions.includes(option_type_id)) {\n                    return [\n                        optionPriceInclTax + priceInclTax,\n                        optionPriceExclTax + priceExclTax\n                    ];\n                }\n\n                return [optionPriceInclTax, optionPriceExclTax];\n            }, [0, 0]);\n\n            return [\n                priceInclTaxTotal + selectionPriceInclTax,\n                priceExclTaxTotal + selectionPriceExclTax\n            ];\n        }, [0, 0]);\n    }\n\n    getSimpleBasePrice() {\n        const {\n            product: {\n                price_range: {\n                    minimum_price: {\n                        regular_price_excl_tax: {\n                            currency\n                        } = {},\n                        default_final_price_excl_tax: {\n                            value: defaultFinalPriceExclTax = 0\n                        } = {},\n                        default_final_price: {\n                            value: defaultFinalPrice = 0\n                        } = {},\n                        default_price: {\n                            value: defaultPrice = 0\n                        } = {},\n                        discount: {\n                            percent_off = 0\n                        } = {}\n                    } = {}\n                } = {}\n            } = {}\n        } = this.props;\n\n        return {\n            minimum_price: {\n                final_price: {\n                    currency,\n                    value: defaultFinalPrice\n                },\n                discount: { percent_off },\n                regular_price: { value: defaultPrice },\n                final_price_excl_tax: { value: defaultFinalPriceExclTax }\n            }\n        };\n    }\n\n    getCustomizablePrice({\n        minimum_price: {\n            final_price: {\n                currency,\n                value: finalPrice\n            },\n            discount: { percent_off },\n            regular_price: { value: regularPrice },\n            final_price_excl_tax: { value: finalPriceExclTax }\n        }\n    }) {\n        const { product: { options = [] } = {} } = this.props;\n\n        const [priceInclTax, priceExclTax] = this.getOptionPricesTotal(options);\n\n        return {\n            minimum_price: {\n                final_price: {\n                    currency,\n                    value: priceInclTax + finalPrice\n                },\n                discount: { percent_off },\n                regular_price: { value: priceInclTax + regularPrice },\n                final_price_excl_tax: { value: priceExclTax + finalPriceExclTax }\n            }\n        };\n    }\n\n    getProductPrice() {\n        const { product: { options = {} } } = this.props;\n\n        const priceWithVariants = this.getProductPriceWithVariants();\n\n        if (Object.keys(options).length === 0) {\n            return priceWithVariants;\n        }\n\n        return this.getCustomizablePrice(priceWithVariants);\n    }\n\n    getProductPriceWithVariants() {\n        const {\n            product,\n            product: { variants = [], type_id, links_purchased_separately },\n            configurableVariantIndex,\n            selectedLinkPrice\n        } = this.props;\n\n        const { options = [] } = product;\n\n        const {\n            price_range\n        } = variants[configurableVariantIndex] || product;\n\n        if (type_id === BUNDLE) {\n            const {\n                selectedBundlePrice,\n                selectedBundlePriceExclTax,\n                selectedInitialBundlePrice,\n                product: { dynamic_price }\n            } = this.props;\n\n            return this._getBundleCustomPrice(\n                selectedBundlePrice,\n                selectedBundlePriceExclTax,\n                selectedInitialBundlePrice,\n                dynamic_price\n            );\n        }\n\n        if (type_id === DOWNLOADABLE && links_purchased_separately) {\n            return this._getCustomPrice(selectedLinkPrice, selectedLinkPrice, true);\n        }\n\n        if ((type_id === SIMPLE || type_id === VIRTUAL) && options.length !== 0) {\n            // price of a product before selecting any options\n            return this.getSimpleBasePrice();\n        }\n\n        return price_range;\n    }\n\n    _getCustomPrice(price, withoutTax, addBase = false) {\n        const {\n            product: {\n                price_range: {\n                    minimum_price: {\n                        regular_price: { currency = '', value = 0 } = {},\n                        regular_price_excl_tax: { value: value_excl_tax = 0 } = {},\n                        discount: { percent_off = 0 } = {}\n                    } = {}\n                } = {}\n            } = {}\n        } = this.props;\n\n        const discount = (1 - percent_off / ONE_HUNDRED_PERCENT);\n\n        const basePrice = addBase ? value : 0;\n        const basePriceExclTax = addBase ? value_excl_tax : 0;\n\n        const finalPrice = (basePrice + price) * discount;\n        const finalPriceExclTax = (basePriceExclTax + withoutTax) * discount;\n\n        const priceValue = { value: finalPrice, currency };\n        const priceValueExclTax = { value: finalPriceExclTax, currency };\n\n        return {\n            minimum_price: {\n                final_price: priceValue,\n                regular_price: priceValue,\n                final_price_excl_tax: priceValueExclTax,\n                regular_price_excl_tax: priceValueExclTax\n            }\n        };\n    }\n\n    _getBundleCustomPrice(price, withoutTax, initial, isDynamicPrice) {\n        const {\n            product: {\n                price_range: {\n                    minimum_price: {\n                        default_price: { currency, value: defaultPrice },\n                        default_final_price: { value: defaultFinalPrice },\n                        default_final_price_excl_tax: { value: defaultFinalPriceExclTax },\n                        discount: discountData,\n                        discount: { percent_off }\n                    }\n                }\n            }\n        } = this.props;\n\n        // If bundle product has dynamic price, it's own base price is always 0. For fix priced bundles price it's configurable\n        const addBase = !isDynamicPrice;\n\n        // Adjusting `discount` for bundle products for discount to be displayed on PDP\n        const priceBeforeDiscount = addBase ? defaultPrice : initial;\n        const priceAfterDiscount = addBase ? defaultFinalPrice : price;\n        const finalDiscount = !percent_off && defaultPrice !== defaultFinalPrice\n            ? {\n                percent_off: (ONE_HUNDRED_PERCENT * (priceBeforeDiscount - priceAfterDiscount)) / priceBeforeDiscount,\n                amount_off: priceBeforeDiscount - priceAfterDiscount\n            }\n            : discountData;\n\n        // Set initial price different from 0 for specific product types, i.e. downloadable, bundles with fixed price\n        const baseInitialPrice = addBase ? defaultPrice : 0;\n        const baseFinalPrice = addBase ? defaultFinalPrice : 0;\n        const basePriceExclTax = addBase ? defaultFinalPriceExclTax : 0;\n\n        const initialPrice = baseInitialPrice + initial;\n        const finalPrice = baseFinalPrice + price;\n        const finalPriceExclTax = basePriceExclTax + withoutTax;\n\n        const initialPriceValue = { value: initialPrice, currency };\n        const priceValue = { value: finalPrice, currency };\n        const priceValueExclTax = { value: finalPriceExclTax, currency };\n\n        return {\n            minimum_price: {\n                final_price: priceValue,\n                regular_price: initialPriceValue,\n                final_price_excl_tax: priceValueExclTax,\n                regular_price_excl_tax: initialPriceValue,\n                discount: finalDiscount\n            }\n        };\n    }\n\n    _getGroupedProductQuantity() {\n        const { groupedProductQuantity } = this.state;\n        return groupedProductQuantity;\n    }\n\n    _setGroupedProductQuantity(id, value) {\n        this.setState(({ groupedProductQuantity }) => ({\n            groupedProductQuantity: {\n                ...groupedProductQuantity,\n                [id]: value\n            }\n        }));\n    }\n\n    _clearGroupedProductQuantity() {\n        this.setState({ groupedProductQuantity: {} });\n    }\n\n    showOnlyIfLoaded(expression, content, placeholder = content) {\n        const { areDetailsLoaded } = this.props;\n\n        if (!areDetailsLoaded) {\n            return placeholder;\n        }\n        if (areDetailsLoaded && !expression) {\n            return null;\n        }\n\n        return content;\n    }\n\n    render() {\n        return (\n            <ProductActions\n              { ...this.props }\n              { ...this.state }\n              { ...this.containerProps() }\n              { ...this.containerFunctions }\n            />\n        );\n    }\n}\n\n/** @namespace Component/ProductActions/Container/mapDispatchToProps */\n// eslint-disable-next-line no-unused-vars\nexport const mapDispatchToProps = (dispatch) => ({});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ProductActionsContainer);\n"]},"metadata":{},"sourceType":"module"}